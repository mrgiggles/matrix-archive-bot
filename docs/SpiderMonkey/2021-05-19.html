<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2021-05-19</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2021-05-19<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2021-05-18" class="nav-link"><span>prev</span></a>
<a href="2021-05-20" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search SpiderMonkey">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed May 19 2021 02:14:08 GMT-0700 (Pacific Daylight Time)">09:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">the ~ are short hand, the grammar expands into several similar productions depending on how the short hand is used</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed May 19 2021 02:15:02 GMT-0700 (Pacific Daylight Time)">09:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">mgaudet</span>: it's described in detail here: <a href="https://tc39.es/ecma262/#sec-grammar-notation">https://tc39.es/ecma262/#sec-grammar-notation</a></td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed May 19 2021 02:16:28 GMT-0700 (Pacific Daylight Time)">09:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">so, yes -- here they are treated as identifiers. (how i usually read it) ~ means "not with" </td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed May 19 2021 04:15:56 GMT-0700 (Pacific Daylight Time)">11:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@miles:mozilla.org">miles</span>&gt;</div></td><td class="msg-cell">Hi. Yesterday people here helped me track down a problem I was having with 89 with private data and the suggestion was that I should get mozjs-90.0a1.0 and try that instead as the bug was fixed in that. I've downloaded it and trieed to compile/test and I'm having a few problems and hoping people can help me again.</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed May 19 2021 04:17:52 GMT-0700 (Pacific Daylight Time)">11:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@miles:mozilla.org">miles</span>&gt;</div></td><td class="msg-cell">Firstly if I compile on windows or a RedHat 7 machine it all compiles but if I try to run the tests to check everything is OK I get the following error.

[dyna19@vdglin33 src]$ ./tests/<a href="http://jstests.py">jstests.py</a> ./releaseobj/dist/bin/js
Traceback (most recent call last):
  File "./tests/<a href="http://jstests.py">jstests.py</a>", line 875, in &lt;module&gt;
    sys.exit(main())
  File "./tests/<a href="http://jstests.py">jstests.py</a>", line 757, in main
    test_count, test_gen = load_tests(options, requested_paths, excluded_paths)
  File "./tests/<a href="http://jstests.py">jstests.py</a>", line 672, in load_tests
    wpt_tests = load_wpt_tests(xul_tester, requested_paths, excluded_paths)
  File "./tests/<a href="http://jstests.py">jstests.py</a>", line 541, in load_wpt_tests
    import manifestupdate
  File "/home/spidermonkey/mozjs-90.0a1.0/testing/web-platform/<a href="http://manifestupdate.py">manifestupdate.py</a>", line 15, in &lt;module&gt;
    from mozboot.util import get_state_dir
  File "/home/spidermonkey/mozjs-90.0a1.0/python/mozboot/mozboot/<a href="http://util.py">util.py</a>", line 13, in &lt;module&gt;
    from mozbuild.virtualenv import VirtualenvHelper
ImportError: No module named mozbuild.virtualenv

Does anybody know what I'm missing? Incidentally ruuning

./jit-test/jit_test.py ./releaseobj/dist/bin/js

works fine</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed May 19 2021 04:21:00 GMT-0700 (Pacific Daylight Time)">11:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@miles:mozilla.org">miles</span>&gt;</div></td><td class="msg-cell">Secondly I've also tried to compile on a CentOS 6 machine and the compile fails. I get lots of errors like

/spidermonkey/mozjs-90.0a1.0/js/src/frontend/Parser.cpp:452:35: error: expected â€˜)â€™ before â€˜PRIu32â€™
  452 |   SprintfLiteral(columnNumber, "%" PRIu32, column);
      |                 ~                 ^~~~~~~
      |                                   )

/spidermonkey/mozjs-90.0a1.0/js/src/frontend/Parser.cpp:452:35: error: expected â€˜)â€™ before â€˜PRIu32â€™
  452 |   SprintfLiteral(columnNumber, "%" PRIu32, column);
      |                 ~                 ^~~~~~~
      |                                   )

Has something just changed as I didn't get this error when I compiled 89 last week. I know RedHat6/CentOS 6 is ancient but I'm hoping that I can still compile on it as we have some CentOS 6 machines I still need to support.</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed May 19 2021 04:21:40 GMT-0700 (Pacific Daylight Time)">11:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@miles:mozilla.org">miles</span>&gt;</div></td><td class="msg-cell">Can anybody help with either of these problems?</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed May 19 2021 04:21:58 GMT-0700 (Pacific Daylight Time)">11:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">jstests (at least sometimes) requires virtualenv created by mach</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed May 19 2021 04:22:38 GMT-0700 (Pacific Daylight Time)">11:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">I tried to remove the dependency, but apparently the dependency again happens</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed May 19 2021 04:23:43 GMT-0700 (Pacific Daylight Time)">11:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@miles:mozilla.org">miles</span>&gt;</div></td><td class="msg-cell">OK. I've not had to use mach before. I've just run a configure script to build up until now. Can I download it from somewhere and is it obvious what I need to do?</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed May 19 2021 04:24:09 GMT-0700 (Pacific Daylight Time)">11:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><code>mach</code> script is stored inside source tree</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed May 19 2021 04:24:22 GMT-0700 (Pacific Daylight Time)">11:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">there's <code>mach</code> file at the top of source tree</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed May 19 2021 04:25:12 GMT-0700 (Pacific Daylight Time)">11:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">if you follow this documentation <a href="https://firefox-source-docs.mozilla.org/js/build.html">https://firefox-source-docs.mozilla.org/js/build.html</a>  both build and test can be done via <code>mach</code></td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed May 19 2021 04:25:55 GMT-0700 (Pacific Daylight Time)">11:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">if you directly run <code><a href="http://jstests.py">jstests.py</a></code>, you would need to run <code>./mach create-mach-environment</code> or something to create the virtualenv manually, and use the python there instead</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed May 19 2021 04:26:46 GMT-0700 (Pacific Daylight Time)">11:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@miles:mozilla.org">miles</span>&gt;</div></td><td class="msg-cell">OK. Great. I can try that. Many thanks.</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Wed May 19 2021 04:27:32 GMT-0700 (Pacific Daylight Time)">11:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">then, about CentOS thing, I wonder if it's caused by unsupported compiler version or something</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Wed May 19 2021 04:28:31 GMT-0700 (Pacific Daylight Time)">11:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@miles:mozilla.org">miles</span>&gt;</div></td><td class="msg-cell">I'm using gcc 9.3.0</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Wed May 19 2021 04:28:32 GMT-0700 (Pacific Daylight Time)">11:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">if you use <code>mach</code> (especially, tools installed by <code>./mach bootstrap</code>), it will use supported compilers</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Wed May 19 2021 04:29:23 GMT-0700 (Pacific Daylight Time)">11:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">hm, then it should be sufficient</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Wed May 19 2021 04:29:39 GMT-0700 (Pacific Daylight Time)">11:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">according to <a href="https://firefox-source-docs.mozilla.org/code-quality/coding-style/using_cxx_in_firefox_code.html">https://firefox-source-docs.mozilla.org/code-quality/coding-style/using_cxx_in_firefox_code.html</a> , the current minimal requirement is 7.1</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Wed May 19 2021 04:31:08 GMT-0700 (Pacific Daylight Time)">11:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">oh, given the error message, it might be that <code>PRIu32</code> isn't properly defined</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Wed May 19 2021 04:31:15 GMT-0700 (Pacific Daylight Time)">11:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@miles:mozilla.org">miles</span>&gt;</div></td><td class="msg-cell">I'm presuming that there must be some sort of preprocessing step and PRIu32 etc are macros? As it compiles on RedHat 7 and windows but not Centos 6 I wondered if something had recently changed in this?</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Wed May 19 2021 04:31:27 GMT-0700 (Pacific Daylight Time)">11:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">yeah</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Wed May 19 2021 04:32:04 GMT-0700 (Pacific Daylight Time)">11:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">hmm, I cannot locate where it's defined...</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Wed May 19 2021 04:32:27 GMT-0700 (Pacific Daylight Time)">11:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@miles:mozilla.org">miles</span>&gt;</div></td><td class="msg-cell">It worked for me on CentOS 6 with 89 but then I had the bug with private data :-(
Something changed between 89 and 90?</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Wed May 19 2021 04:34:34 GMT-0700 (Pacific Daylight Time)">11:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">just noticed that it's defined outside of source tree</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Wed May 19 2021 04:35:36 GMT-0700 (Pacific Daylight Time)">11:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">it's in <code>inttypes.h</code></td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Wed May 19 2021 04:36:28 GMT-0700 (Pacific Daylight Time)">11:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">Can you try adding <code>#include &lt;inttypes.h&gt;</code> in /js/src/frontend/Parser.cpp file, above <code>#include &lt;memory&gt;</code> line?</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Wed May 19 2021 04:36:34 GMT-0700 (Pacific Daylight Time)">11:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">to see if it solves the issue</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Wed May 19 2021 04:37:54 GMT-0700 (Pacific Daylight Time)">11:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@miles:mozilla.org">miles</span>&gt;</div></td><td class="msg-cell">OK. I can try that. It was actually an error in several files but I pasted the same link twice by accident. If it fixes it in one file it will fix it in the others though... :-)</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Wed May 19 2021 04:55:04 GMT-0700 (Pacific Daylight Time)">11:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@miles:mozilla.org">miles</span>&gt;</div></td><td class="msg-cell">I don't think that has worked. I'm getting errors in the 'unified' cpp files.

make[3]: Entering directory `/spidermonkey/mozjs-90.0a1.0/js/src/releaseobj/js/src/debugger'
/spidermonkey/bin/g++ -std=gnu++17 -o Unified_cpp_js_src_debugger0.o -c  -I/spidermonkey/mozjs-90.0a1.0/js/src/releaseobj/dist/system_wrappers -include /spidermonkey/mozjs-90.0a1.0/config/gcc_hidden.h -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -fstack-protector-strong -DNDEBUG=1 -DTRIMMED=1 -DWASM_SUPPORTS_HUGE_MEMORY -DJS_CACHEIR_SPEW -DJS_STRUCTURED_SPEW -DEXPORT_JS_API -DMOZ_HAS_MOZGLUE -I/spidermonkey/mozjs-90.0a1.0/js/src/debugger -I/spidermonkey/mozjs-90.0a1.0/js/src/releaseobj/js/src/debugger -I/spidermonkey/mozjs-90.0a1.0/js/src/releaseobj/js/src -I/spidermonkey/mozjs-90.0a1.0/js/src -I/spidermonkey/mozjs-90.0a1.0/js/src/releaseobj/dist/include -DMOZILLA_CLIENT -include /spidermonkey/mozjs-90.0a1.0/js/src/releaseobj/js/src/js-confdefs.h -Wall -Wempty-body -Wignored-qualifiers -Wpointer-arith -Wsign-compare -Wtype-limits -Wunreachable-code -Wwrite-strings -Wno-invalid-offsetof -Wduplicated-cond -Wimplicit-fallthrough -Wunused-function -Wunused-variable -Wno-error=maybe-uninitialized -Wno-error=deprecated-declarations -Wno-error=array-bounds -Wno-error=coverage-mismatch -Wno-error=free-nonheap-object -Wno-multistatement-macros -Wno-error=class-memaccess -Wno-error=deprecated-copy -Wformat -Wformat-overflow=2 -Wno-psabi -fno-sized-deallocation -fno-aligned-new -fPIC -fno-rtti -fno-exceptions -fno-math-errno -pthread -pipe -freorder-blocks -O3 -fno-omit-frame-pointer -funwind-tables -fno-strict-aliasing -Werror=format -Wno-shadow -Wno-attributes  -MD -MP -MF .deps/Unified_cpp_js_src_debugger0.o.pp   Unified_cpp_js_src_debugger0.cpp
In file included from /spidermonkey/mozjs-90.0a1.0/js/src/jit/x64/BaseAssembler-x64.h:12,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/jit/x86-shared/Assembler-x86-shared.h:17,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/jit/x64/Assembler-x64.h:283,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/jit/x86-shared/MacroAssembler-x86-shared.h:15,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/jit/x64/MacroAssembler-x64.h:11,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/jit/MacroAssembler.h:18,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/wasm/WasmGC.h:24,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/wasm/WasmCode.h:29,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/wasm/WasmModule.h:25,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/wasm/WasmDebug.h:23,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/debugger/Debugger.cpp:105,
                 from Unified_cpp_js_src_debugger0.cpp:11:
/spidermonkey/mozjs-90.0a1.0/js/src/jit/x86-shared/BaseAssembler-x86-shared.h: In member function â€˜void js::jit::X86Encoding::BaseAssembler::jumpTablePointer(uintptr_t)â€™:
/spidermonkey/mozjs-90.0a1.0/js/src/jit/x86-shared/BaseAssembler-x86-shared.h:4308:21: error: expected â€˜)â€™ before â€˜PRIxPTRâ€™
 4308 |     spew(".quad 0x%" PRIxPTR, ptr);
      |         ~           ^~~~~~~~
      |                     )
/spidermonkey/mozjs-90.0a1.0/js/src/jit/x86-shared/BaseAssembler-x86-shared.h:4308:19: error: spurious trailing â€˜%â€™ in format [-Werror=format=]
 4308 |     spew(".quad 0x%" PRIxPTR, ptr);
      |                   ^
/spidermonkey/mozjs-90.0a1.0/js/src/jit/x86-shared/BaseAssembler-x86-shared.h:4308:10: error: too many arguments for format [-Werror=format-extra-args]
 4308 |     spew(".quad 0x%" PRIxPTR, ptr);
      |          ^~~~~~~~~~~
In file included from /spidermonkey/mozjs-90.0a1.0/js/src/jit/x86-shared/Assembler-x86-shared.h:17,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/jit/x64/Assembler-x64.h:283,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/jit/x86-shared/MacroAssembler-x86-shared.h:15,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/jit/x64/MacroAssembler-x64.h:11,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/jit/MacroAssembler.h:18,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/wasm/WasmGC.h:24,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/wasm/WasmCode.h:29,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/wasm/WasmModule.h:25,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/wasm/WasmDebug.h:23,
                 from /spidermonkey/mozjs-90.0a1.0/js/src/debugger/Debugger.cpp:105,
                 from Unified_cpp_js_src_debugger0.cpp:11:
/spidermonkey/mozjs-90.0a1.0/js/src/jit/x64/BaseAssembler-x64.h: In member function â€˜void js::jit::X86Encoding::BaseAssemblerX64::andq_ir(int32_t, js::jit::X86Encoding::RegisterID)â€™:
/spidermonkey/mozjs-90.0a1.0/js/src/jit/x64/BaseAssembler-x64.h:224:27: error: expected â€˜)â€™ before â€˜PRIx64â€™
  224 |     spew("andq       $0x%" PRIx64 ", %s", uint64_t(imm), GPReg64Name(dst));
      |         ~                 ^~~~~~~
      |                           )
/spidermonkey/mozjs-90.0a1.0/js/src/jit/x64/BaseAssembler-x64.h:224:25: error: spurious trailing â€˜%â€™ in format [-Werror=format=]
  224 |     spew("andq       $0x%" PRIx64 ", %s", uint64_t(imm), GPReg64Name(dst));
      |                         ^
/spidermonkey/mozjs-90.0a1.0/js/src/jit/x64/BaseAssembler-x64.h:224:10: error: too many arguments for format [-Werror=format-extra-args]
  224 |     spew("andq       $0x%" PRIx64 ", %s", uint64_t(imm), GPReg64Name(dst));
      |          ^~~~~~~~~~~~~~~~~
</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Wed May 19 2021 04:56:27 GMT-0700 (Pacific Daylight Time)">11:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">now you don't get error for Parser.cpp ?</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Wed May 19 2021 04:57:28 GMT-0700 (Pacific Daylight Time)">11:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">unified file includes several cpp files, in order to improve the build performance, so that multiple cpp files are compiled at once</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Wed May 19 2021 04:57:54 GMT-0700 (Pacific Daylight Time)">11:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">and some complex case like Parser.cpp doesn't use unified file</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Wed May 19 2021 04:58:12 GMT-0700 (Pacific Daylight Time)">11:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">so, for the error in Parser.cpp, you got error directly for the file</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Wed May 19 2021 04:58:28 GMT-0700 (Pacific Daylight Time)">11:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@miles:mozilla.org">miles</span>&gt;</div></td><td class="msg-cell">I don't think it has recompiled it. When I did my initial build I ran make in parallel with 'make -j 8'. I just ran make this time to try to ensure that I could see what was going on and I didn't see Parser.cpp in the output</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Wed May 19 2021 04:58:51 GMT-0700 (Pacific Daylight Time)">11:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">hmm</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Wed May 19 2021 05:00:11 GMT-0700 (Pacific Daylight Time)">12:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@miles:mozilla.org">miles</span>&gt;</div></td><td class="msg-cell">I'll try from scratch in a bit. You have given me something to look into anyway but first I need to go and eat lunch! :-)</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Wed May 19 2021 05:00:54 GMT-0700 (Pacific Daylight Time)">12:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">it sounds like the environment you're using is strict around header file, so adding more include for inttypes.h might solve the issue</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Wed May 19 2021 05:02:10 GMT-0700 (Pacific Daylight Time)">12:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">(we should follow "include-what-you-use" rule more eagerly...</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Wed May 19 2021 05:20:31 GMT-0700 (Pacific Daylight Time)">12:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">In both cases, the macro should come from <a href="https://searchfox.org/mozilla-central/source/mozglue/misc/IntegerPrintfMacros.h#47">https://searchfox.org/mozilla-central/source/mozglue/misc/IntegerPrintfMacros.h#47</a> and its included <a href="https://en.cppreference.com/w/cpp/header/cinttypes">intypes.h header</a></td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Wed May 19 2021 05:22:54 GMT-0700 (Pacific Daylight Time)">12:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">they expand to a text literal which defines the text pattern to follow the "%" symbol. The preprocessor is in charge of expanding these macros and concatenating adjacent strings (<code>"a" "b" =&gt; "ab"</code>)</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Wed May 19 2021 05:26:05 GMT-0700 (Pacific Daylight Time)">12:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell"><code>error: expected â€˜)â€™ before â€˜PRIxPTRâ€™</code> suggests the C++ compiler sees the macro name, thus that it was not expanded by the preprocessor. Adding the missing include <code>#include "mozilla/IntegerPrintfMacros.h"</code> in <code>js/src/frontend/Parser.cpp</code>, <code>js/src/jit/x86-shared/BaseAssembler-x86-shared.h</code> and <code>js/src/jit/x64/BaseAssembler-x64.h</code> should solve this problem.</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Wed May 19 2021 05:33:37 GMT-0700 (Pacific Daylight Time)">12:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell"><span class="nick-9">miles</span>: oops.. <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1708330#c7">https://bugzilla.mozilla.org/show_bug.cgi?id=1708330#c7</a></td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Wed May 19 2021 05:33:50 GMT-0700 (Pacific Daylight Time)">12:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">do you have updates installed on these machines?</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Wed May 19 2021 05:35:01 GMT-0700 (Pacific Daylight Time)">12:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">or do a simple test to see if this bug still applies to your centos machine <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1318877">https://bugzilla.redhat.com/show_bug.cgi?id=1318877</a></td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Wed May 19 2021 05:40:26 GMT-0700 (Pacific Daylight Time)">12:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@miles:mozilla.org">miles</span>&gt;</div></td><td class="msg-cell">Unfortunately the machine I'm using isn't up to date but we have another RHEL 6 machine that should be getting patch updates that I can try.
It looks like I have some things to look into anyway... Thanks</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Wed May 19 2021 05:41:25 GMT-0700 (Pacific Daylight Time)">12:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">might be able to force the <code>__STDC_{FORMAT,LIMIT,CONSTANT}_MACROS</code> define into your build process (for sm and your software)</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Wed May 19 2021 05:54:45 GMT-0700 (Pacific Daylight Time)">12:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@sagu:mozilla.org">sagu</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> so we need to tell mozbuild to include libjsrust in libjsstatic.</blockquote></mx-reply>Discussion: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1490948">https://bugzilla.mozilla.org/show_bug.cgi?id=1490948</a></td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Wed May 19 2021 05:55:04 GMT-0700 (Pacific Daylight Time)">12:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@sagu:mozilla.org">sagu</span>&gt;</div></td><td class="msg-cell">Also relevant bug: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1588340">https://bugzilla.mozilla.org/show_bug.cgi?id=1588340</a></td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Wed May 19 2021 07:47:43 GMT-0700 (Pacific Daylight Time)">14:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">anyone want to do a review of this with me? <a href="https://github.com/tc39/proposal-resizablearraybuffer">https://github.com/tc39/proposal-resizablearraybuffer</a></td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Wed May 19 2021 08:00:03 GMT-0700 (Pacific Daylight Time)">15:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">^ <span class="nick-15">lth</span> &amp; <span class="nick-10">jandem</span></td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Wed May 19 2021 08:00:13 GMT-0700 (Pacific Daylight Time)">15:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@miles:mozilla.org">miles</span>&gt;</div></td><td class="msg-cell"><p>Hi. I thought I would give some feedback on my RHEL 6 compiling issue.<br>I made the following changes in the source</p>
<ol>
<li>
<p>In js-cxxflags.mozbuild add</p>
<p>CXXFLAGS += ['-D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -D__STDC_CONSTANT_MACROS']</p>
</li>
</ol>
<p>at the end of the file giving</p>
<p>if CONFIG['CC_TYPE'] == 'gcc':<br>CXXFLAGS += ['-Wno-attributes']<br>CXXFLAGS += ['-D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -D__STDC_CONSTANT_MACROS']</p>
<ol start="2">
<li>In mozglue/misc/<a href="http://moz.build">moz.build</a> add</li>
</ol>
<p>SOURCES["StackWalk.cpp"].flags += ["-D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -D__STDC_CONSTANT_MACROS"]</p>
<ol start="3">
<li>In mfbt/<a href="http://moz.build">moz.build</a> remove JSONWriter.cpp from UNIFIED_SOURCES and add</li>
</ol>
<p>SOURCES += [<br>"JSONWriter.cpp",<br>]</p>
<p>SOURCES["JSONWriter.cpp"].flags += ["-D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -D__STDC_CONSTANT_MACROS"]</p>
<ol start="4">
<li>In mfbt/tests/<a href="http://moz.build">moz.build</a> add</li>
</ol>
<p>if CONFIG['CC_TYPE'] == 'gcc':<br>CXXFLAGS += ['-D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -D__STDC_CONSTANT_MACROS']</p>
<p>If I do that before running configure it compiles ðŸ˜€</p>
<p>I'm now just looking into how to use mach to run the test suite properly (and also perhaps look to try to use it for building as well...)</p>
<p>Many thanks for the help earlier.</p>
</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Wed May 19 2021 08:01:46 GMT-0700 (Pacific Daylight Time)">15:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-10">yulia</span>: I should probably take a look at that again anyway..</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Wed May 19 2021 08:46:49 GMT-0700 (Pacific Daylight Time)">15:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">sfink</span>: ping</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Wed May 19 2021 09:08:14 GMT-0700 (Pacific Daylight Time)">16:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><a href="https://twitter.com/v8js/status/1394267917013897216">https://twitter.com/v8js/status/1394267917013897216</a></td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Wed May 19 2021 09:14:48 GMT-0700 (Pacific Daylight Time)">16:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">Why didn't they simply reserved some JIT-code area next to where the binary pages are located ?!</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Wed May 19 2021 09:15:17 GMT-0700 (Pacific Daylight Time)">16:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">This would solve their issue without having to duplicate the code which is embedded in the binary.</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Wed May 19 2021 09:20:20 GMT-0700 (Pacific Daylight Time)">16:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">dueling allocators, I'd guess</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Wed May 19 2021 09:20:50 GMT-0700 (Pacific Daylight Time)">16:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">V8 probably expects to have a lot of control over that memory and can't just use a region that the browser hands it</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Wed May 19 2021 09:22:02 GMT-0700 (Pacific Daylight Time)">16:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">my "why don't they just..." thought was that they should map that memory into each 4GB cage, even if it means mapping the same memory multiple times.</td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Wed May 19 2021 09:23:02 GMT-0700 (Pacific Daylight Time)">16:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I posted this because <span class="nick-10">jandem</span> &amp; <span class="nick-4">jonco</span> are talking about using pointer compression to shrink <code>JSAtom*</code> in property maps, and similar things arise for permanent atoms.</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Wed May 19 2021 09:23:45 GMT-0700 (Pacific Daylight Time)">16:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">For atoms it does not matter much as you could compare the indexes (which are the compressed pointers)</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Wed May 19 2021 09:25:03 GMT-0700 (Pacific Daylight Time)">16:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">Also this is a code-pointer restriction (branch prediction hardware tuning), not a data-pointer.</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Wed May 19 2021 09:27:33 GMT-0700 (Pacific Daylight Time)">16:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">Sure. V8 wants smaller pointers for direct calls, we want smaller pointers to pack more properties into the same space. So they're different reasons, but run into similar problems.</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Wed May 19 2021 09:28:44 GMT-0700 (Pacific Daylight Time)">16:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">We currently use indexes for atoms? How big are the indexes?</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Wed May 19 2021 09:34:40 GMT-0700 (Pacific Daylight Time)">16:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">I do not know, but if you want to compress atom to reduce the pointer size, you likely have an indirection table, and the index in this table becomes your compressed-pointer.</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Wed May 19 2021 09:59:54 GMT-0700 (Pacific Daylight Time)">16:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell"><span class="nick-9">ashcode</span>++ for knocking 80 bytes off each <code>js::ScriptSource</code> (Bug 1576885)</td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Wed May 19 2021 09:59:55 GMT-0700 (Pacific Daylight Time)">16:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1576885">https://bugzil.la/1576885</a> â€” NEW (cOde.A4sh) â€” Reduce size of Maybe&lt;SharedImmutableString&gt;</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Wed May 19 2021 11:50:05 GMT-0700 (Pacific Daylight Time)">18:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">yulia: i should probably look also</td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Wed May 19 2021 15:03:44 GMT-0700 (Pacific Daylight Time)">22:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">confession: Class static blocks are nearing reviewability; verifying things work in the debugger, and that source positions roughly make sense is what mostly remains. </td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Wed May 19 2021 15:03:47 GMT-0700 (Pacific Daylight Time)">22:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell">Seen! Your update will eventually appear on <a href="https://robotzilla.github.io/histoire">https://robotzilla.github.io/histoire</a></td></tr>

</tbody></table></div></div></div>
</body></html>