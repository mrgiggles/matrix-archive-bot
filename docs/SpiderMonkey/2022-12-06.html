<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2022-12-06</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2022-12-06<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-12-05" class="nav-link"><span>prev</span></a>
<a href="2022-12-07" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search SpiderMonkey">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Mon Dec 05 2022 16:07:35 GMT-0800 (Pacific Standard Time)">00:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@gijs:mozilla.org">gijs</span>&gt;</div></td><td class="msg-cell"><blockquote>
<p>0:01.26 FAIL test_override_super_multiple - [test_override_super_multiple : 99] "overridden-property" == "overridden-overridden-overridden-overridden-property"</p>
</blockquote>
<p>Oh god this is going to be fun isn't it.</p>
</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Mon Dec 05 2022 16:08:14 GMT-0800 (Pacific Standard Time)">00:08</a></td><td class="nick-cell"><div class="m-ov"><span class="nick nick-3" title="@gijs:mozilla.org">gijs</span></div></td><td class="msg-cell">looks forward to discovering all the subtle ways <code>Object.create</code> + <code>Object.getOwnPropertyDescriptors</code> differs from just assigning to <code>__proto__</code></td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Mon Dec 05 2022 16:53:29 GMT-0800 (Pacific Standard Time)">00:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@gijs:mozilla.org">gijs</span>&gt;</div></td><td class="msg-cell">OK, it's too late for me to dig into this more, but I'm looking at some gnarly code and how it treats prototype chains and I'm getting lost. Specifically, from reading the docs, I thought that using <code>Object.setPrototypeOf(x, superclass)</code> and <code>Object.create(superclass, Object.getOwnPropertyDescriptors(x))</code> would behave more or less the same (apart from, I guess, the second not modifying x, whereas the first <em>does</em>) - the outcome object should be basically x with its proto set to superclass. But I'm seeing confusing differences. See <a href="https://mozilla-spidermonkey.github.io/sm-wasi-demo/?branch=mozilla-central&amp;source=%2F%2F%20Welcome%20to%20the%20SpiderMonkey%20JS%20shell%20compiled%20to%20WebAssembly!%0A%2F%2F%0A%2F%2F%20JS%20code%20on%20this%20side%20is%20evaluated%20in%20a%20Web%20Worker%20as%20you%20type.%0A%2F%2F%20The%20output%20is%20printed%20on%20the%20right-hand%20side.%0A%2F%2F%0A%2F%2F%20The%20JS%20shell%20has%20various%20builtin%20functions%20for%20testing%20purposes.%0A%2F%2F%20help()%20will%20print%20a%20list%20of%20them.%0A%0Aprint(%22Hello%2C%20world!%22)%3B%0Aprint(%22%3D%22.repeat(13))%3B%0A%0Aconst%20TestIntegration%20%3D%20%7B%0A%20%20get%20property()%20%7B%0A%20%20%20%20return%20this._property%3B%0A%20%20%7D%2C%0A%20%20set%20property(value)%20%7B%0A%20%20%20%20this._property%20%3D%20value%3B%0A%20%20%7D%2C%0A%7D%3B%0A%0Alet%20overrideFn%20%3D%20base%20%3D%3E%20(%7B%0A%20%20get%20property()%20%7B%0A%20%20%20%20return%20%22overridden-%22%20%2B%20base.__lookupGetter__(%22property%22).call(this)%3B%0A%20%20%7D%2C%0A%0A%20%20set%20property(value)%20%7B%0A%20%20%20%20base.__lookupSetter__(%22property%22).call(this%2C%20%22overridden-%22%20%2B%20value)%3B%0A%20%20%7D%2C%0A%7D)%3B%0A%0Alet%20superOverrideFn%20%3D%20base%20%3D%3E%20%7B%0A%20%20let%20rv%20%3D%20%7B%0A%20%20%20%20get%20property()%20%7B%0A%20%20%20%20%20%20return%20%22overridden-%22%20%2B%20super.property%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20set%20property(value)%20%7B%0A%20%20%20%20%20%20super.property%20%3D%20%22overridden-%22%20%2B%20value%3B%0A%20%20%20%20%7D%2C%0A%20%20%7D%3B%0A%20%20%2F%2F%20XXX%20this%20branching%20point%20changes%20behaviour%20and%20I%20do%20not%20understand%20why.%0A%20%20if%20(true)%20%7B%0A%20%20%20%20let%20descriptors%20%3D%20Object.getOwnPropertyDescriptors(rv)%3B%0A%20%20%20%20rv%20%3D%20Object.create(base%2C%20descriptors)%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20Object.setPrototypeOf(rv%2C%20base)%3B%0A%20%20%7D%0A%20%20return%20rv%3B%0A%7D%3B%0A%0Alet%20getCombined%20%3D%20function(root)%20%7B%0A%20%20%20%20%2F%2F%20In%20addition%20to%20enumerating%20all%20the%20registered%20integration%20overrides%20in%0A%20%20%20%20%2F%2F%20order%2C%20we%20want%20to%20keep%20any%20state%20that%20was%20previously%20stored%20in%20the%0A%20%20%20%20%2F%2F%20combined%20object%20using%20the%20%22this%22%20reference%20in%20integration%20methods.%0A%20%20%20%20let%20overrideFnArray%20%3D%20%5BoverrideFn%2C%20superOverrideFn%2C%20()%20%3D%3E%20(%7B%7D)%5D%3B%0A%0A%20%20%20%20let%20combined%20%3D%20root%3B%0A%20%20%20%20for%20(let%20overrideFn%20of%20overrideFnArray)%20%7B%0A%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20Obtain%20a%20new%20set%20of%20methods%20from%20the%20next%20override%20function%20in%20the%0A%20%20%20%20%20%20%20%20%2F%2F%20list%2C%20specifying%20the%20current%20combined%20object%20as%20the%20base%20argument.%0A%20%20%20%20%20%20%20%20let%20override%20%3D%20overrideFn(combined)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Retrieve%20a%20list%20of%20property%20descriptors%20from%20the%20returned%20object%2C%20and%0A%20%20%20%20%20%20%20%20%2F%2F%20use%20them%20to%20build%20a%20new%20combined%20object%20whose%20prototype%20points%20to%20the%0A%20%20%20%20%20%20%20%20%2F%2F%20previous%20combined%20object.%0A%20%20%20%20%20%20%20%20let%20descriptors%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20for%20(let%20name%20of%20Object.getOwnPropertyNames(override))%20%7B%0A%20%20%20%20%20%20%20%20%20%20descriptors%5Bname%5D%20%3D%20Object.getOwnPropertyDescriptor(override%2C%20name)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20combined%20%3D%20Object.create(combined%2C%20descriptors)%3B%0A%20%20%20%20%20%20%7D%20catch%20(ex)%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20Any%20error%20will%20result%20in%20the%20current%20override%20being%20skipped.%0A%20%20%20%20%20%20%20%20print(ex)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20combined%3B%0A%20%20%7D%0A%0Alet%20total%20%3D%20getCombined(TestIntegration)%3B%0Atotal.property%20%3D%20%22prop%22%3B%0Aprint(total.property)%3B%0A%0A%0A%0A%0A">this example</a> and specifically the <code>XXX</code> comment.</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Mon Dec 05 2022 16:54:16 GMT-0800 (Pacific Standard Time)">00:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@gijs:mozilla.org">gijs</span>&gt;</div></td><td class="msg-cell">if someone has time to help enlighten me I would appreciate it (after sleep :) )</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Tue Dec 06 2022 02:04:48 GMT-0800 (Pacific Standard Time)">10:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-3">gijs</span>: I think what's happening is that <code><a href="http://super.property">super.property</a></code> in a getter does something like <code>HomeObject(getter).__proto__.property</code>. The "home object" will continue to be the object that the getter was defined on originally (<code>rv</code>), even if we move the getter to a different object</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Tue Dec 06 2022 02:07:27 GMT-0800 (Pacific Standard Time)">10:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">so <code><a href="http://super.property">super.property</a></code> will refer to <code><a href="http://Object.prototype.property">Object.prototype.property</a></code> in this case if you don't mutate the proto of <code>rv</code></td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Tue Dec 06 2022 03:02:19 GMT-0800 (Pacific Standard Time)">11:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@gijs:mozilla.org">gijs</span>&gt;</div></td><td class="msg-cell"><span class="nick-10">jandem</span>: hm, ok. I think what I don't understand is that I thought <code>superclass</code> would end up as the proto of <code>rv</code> in both of these examples...</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Tue Dec 06 2022 03:02:48 GMT-0800 (Pacific Standard Time)">11:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@gijs:mozilla.org">gijs</span>&gt;</div></td><td class="msg-cell">are you saying that's not the case?</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Tue Dec 06 2022 03:02:57 GMT-0800 (Pacific Standard Time)">11:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@gijs:mozilla.org">gijs</span>&gt;</div></td><td class="msg-cell">oh, wait</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Tue Dec 06 2022 03:03:28 GMT-0800 (Pacific Standard Time)">11:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@gijs:mozilla.org">gijs</span>&gt;</div></td><td class="msg-cell">I guess you're saying that because the second option doesn't modify the input object <code>x</code> on which we call <code>getOwnPropertyDescriptors</code></td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Tue Dec 06 2022 03:03:45 GMT-0800 (Pacific Standard Time)">11:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@gijs:mozilla.org">gijs</span>&gt;</div></td><td class="msg-cell">and the getter gets called on the original input object rather than the output object because of the <code>HomeObject</code> thing</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Tue Dec 06 2022 03:03:59 GMT-0800 (Pacific Standard Time)">11:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@gijs:mozilla.org">gijs</span>&gt;</div></td><td class="msg-cell">it gets <code>x</code>'s original proto chain instead of <code>rv</code>'s?</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Tue Dec 06 2022 03:07:27 GMT-0800 (Pacific Standard Time)">11:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@gijs:mozilla.org">gijs</span>&gt;</div></td><td class="msg-cell">Hm, but I'm looking at <a href="https://mozilla-spidermonkey.github.io/sm-wasi-demo/?branch=mozilla-central&amp;source=%2F%2F%20Welcome%20to%20the%20SpiderMonkey%20JS%20shell%20compiled%20to%20WebAssembly!%0A%2F%2F%0A%2F%2F%20JS%20code%20on%20this%20side%20is%20evaluated%20in%20a%20Web%20Worker%20as%20you%20type.%0A%2F%2F%20The%20output%20is%20printed%20on%20the%20right-hand%20side.%0A%2F%2F%0A%2F%2F%20The%20JS%20shell%20has%20various%20builtin%20functions%20for%20testing%20purposes.%0A%2F%2F%20help()%20will%20print%20a%20list%20of%20them.%0A%0Aprint(%22Hello%2C%20world!%22)%3B%0Aprint(%22%3D%22.repeat(13))%3B%0A%0Ax%20%3D%20%7Bget%20b()%20%7B%20return%20this.a%7D%20%7D%3B%0Ay%20%3D%20%7Ba%3A%2042%7D%3B%0Az%20%3D%20Object.create(y%2C%20Object.getOwnPropertyDescriptors(x))%0Aprint(z.b)%3B%0Aprint(x.b)%3B%0A">this</a> and that doesn't seem to be what's happening.</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Tue Dec 06 2022 03:07:36 GMT-0800 (Pacific Standard Time)">11:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@gijs:mozilla.org">gijs</span>&gt;</div></td><td class="msg-cell">I'm probably misunderstanding your explanation!</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Tue Dec 06 2022 03:10:26 GMT-0800 (Pacific Standard Time)">11:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@gijs:mozilla.org">gijs</span>&gt;</div></td><td class="msg-cell">ah, wait, I'm using <code><a href="http://this.foo">this.foo</a></code> and not <code><a href="http://super.foo">super.foo</a></code></td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Tue Dec 06 2022 03:11:06 GMT-0800 (Pacific Standard Time)">11:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@gijs:mozilla.org">gijs</span>&gt;</div></td><td class="msg-cell"><a href="https://mozilla-spidermonkey.github.io/sm-wasi-demo/?branch=mozilla-central&amp;source=%2F%2F%20Welcome%20to%20the%20SpiderMonkey%20JS%20shell%20compiled%20to%20WebAssembly!%0A%2F%2F%0A%2F%2F%20JS%20code%20on%20this%20side%20is%20evaluated%20in%20a%20Web%20Worker%20as%20you%20type.%0A%2F%2F%20The%20output%20is%20printed%20on%20the%20right-hand%20side.%0A%2F%2F%0A%2F%2F%20The%20JS%20shell%20has%20various%20builtin%20functions%20for%20testing%20purposes.%0A%2F%2F%20help()%20will%20print%20a%20list%20of%20them.%0A%0Aprint(%22Hello%2C%20world!%22)%3B%0Aprint(%22%3D%22.repeat(13))%3B%0A%0Ax%20%3D%20%7Bget%20b()%20%7B%20return%20super.a%7D%20%7D%3B%0Ay%20%3D%20%7Ba%3A%2042%7D%3B%0Ax%20%3D%20Object.create(y%2C%20Object.getOwnPropertyDescriptors(x))%3B%0Aprint(x.b)%3B%0A">this shows <code>undefined</code></a> which matches that explanation</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Tue Dec 06 2022 03:11:33 GMT-0800 (Pacific Standard Time)">11:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@gijs:mozilla.org">gijs</span>&gt;</div></td><td class="msg-cell">and <a href="https://mozilla-spidermonkey.github.io/sm-wasi-demo/?branch=mozilla-central&amp;source=%2F%2F%20Welcome%20to%20the%20SpiderMonkey%20JS%20shell%20compiled%20to%20WebAssembly!%0A%2F%2F%0A%2F%2F%20JS%20code%20on%20this%20side%20is%20evaluated%20in%20a%20Web%20Worker%20as%20you%20type.%0A%2F%2F%20The%20output%20is%20printed%20on%20the%20right-hand%20side.%0A%2F%2F%0A%2F%2F%20The%20JS%20shell%20has%20various%20builtin%20functions%20for%20testing%20purposes.%0A%2F%2F%20help()%20will%20print%20a%20list%20of%20them.%0A%0Aprint(%22Hello%2C%20world!%22)%3B%0Aprint(%22%3D%22.repeat(13))%3B%0A%0Ax%20%3D%20%7Bget%20b()%20%7B%20return%20super.a%7D%20%7D%3B%0Ay%20%3D%20%7Ba%3A%2042%7D%3B%0A%2F%2F%20x%20%3D%20Object.create(y%2C%20Object.getOwnPropertyDescriptors(x))%3B%0AObject.setPrototypeOf(x%2C%20y)%3B%0Aprint(x.b)%3B%0A">this</a> works "correctly" (uses <code>super.a</code> and doesn't print undefined)</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Tue Dec 06 2022 03:11:44 GMT-0800 (Pacific Standard Time)">11:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@gijs:mozilla.org">gijs</span>&gt;</div></td><td class="msg-cell">thanks, that really helped! Would have been stuck a long time without that.</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Tue Dec 06 2022 03:14:44 GMT-0800 (Pacific Standard Time)">11:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">no problem!</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Tue Dec 06 2022 07:01:37 GMT-0800 (Pacific Standard Time)">15:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@lgoodacre:matrix.org">liam_g</span>&gt;</div></td><td class="msg-cell">Trying to construct JS::PersistentRootedIdVector, I'm getting a compiler error saying "js::TempAllocPolicy: no appropriate default constructor available". I don't see any option for this in the constructor though.</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Tue Dec 06 2022 07:02:22 GMT-0800 (Pacific Standard Time)">15:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@lgoodacre:matrix.org">liam_g</span>&gt;</div></td><td class="msg-cell">Any suggestions for how to construct it? All I'm doing right now is JS::PersistentRootedIdVector(CX)</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Tue Dec 06 2022 07:14:08 GMT-0800 (Pacific Standard Time)">15:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">liam_g</span>: it looks like that should work.  could you pastebin the source and the error you're getting?</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Tue Dec 06 2022 07:21:22 GMT-0800 (Pacific Standard Time)">15:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@lgoodacre:matrix.org">liam_g</span>&gt;</div></td><td class="msg-cell">I was wrong, it's not the constructor that's the problem, it's the .init() call from the PersistentRooted class.</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Tue Dec 06 2022 07:22:37 GMT-0800 (Pacific Standard Time)">15:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@lgoodacre:matrix.org">liam_g</span>&gt;</div></td><td class="msg-cell">So if i call persistent.init(CX), i get the above error message.</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Tue Dec 06 2022 07:22:58 GMT-0800 (Pacific Standard Time)">15:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@lgoodacre:matrix.org">liam_g</span>&gt;</div></td><td class="msg-cell">I'm assuming if i don't call init at all, I'll get a dynamic assertion.</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Tue Dec 06 2022 07:23:30 GMT-0800 (Pacific Standard Time)">15:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@lgoodacre:matrix.org">liam_g</span>&gt;</div></td><td class="msg-cell">How should I initialise the vector?</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Tue Dec 06 2022 07:32:49 GMT-0800 (Pacific Standard Time)">15:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">I'm seeing everything depreciated in esr68, what should I be using instead of <a href="https://searchfox.org/mozilla-esr68/rev/4b79eedfe95ef427490a16e7c96f3a0930ab0c32/js/public/CharacterEncoding.h#361">JS_EncodeStringToLatin1</a>?</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Tue Dec 06 2022 07:34:41 GMT-0800 (Pacific Standard Time)">15:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@lgoodacre:matrix.org">liam_g</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> How should I initialise the vector?</blockquote></mx-reply>Actually, it seems to work fine without the init call. I guess init is for objects or something. Problem solved.</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Tue Dec 06 2022 07:42:45 GMT-0800 (Pacific Standard Time)">15:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">Because I assume this is how you get the C/C++ value out of a JSString. <a href="https://github.com/mozilla-spidermonkey/spidermonkey-embedding-examples/blob/edfe74b65fba34408ef22fef53aeec243bb26537/examples/cookbook.cpp#L900-L901">https://github.com/mozilla-spidermonkey/spidermonkey-embedding-examples/blob/edfe74b65fba34408ef22fef53aeec243bb26537/examples/cookbook.cpp#L900-L901</a><br>yet it seems to be using depreciated functions</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Tue Dec 06 2022 07:50:25 GMT-0800 (Pacific Standard Time)">15:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">I've had a similar question as well. the answer as far as I can tell is that there isn't yet anything to replace it</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Tue Dec 06 2022 07:51:11 GMT-0800 (Pacific Standard Time)">15:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">I guess that means avoid using it to convert to a C string if you're just converting it back to a JSString, but if you need the C string then you don't really have another choice</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Tue Dec 06 2022 08:00:13 GMT-0800 (Pacific Standard Time)">16:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">I wasn't aware that we deprecated <code>JS_EncodeStringToUTF8</code>. Just <code>Latin1</code></td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Tue Dec 06 2022 08:01:16 GMT-0800 (Pacific Standard Time)">16:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">liam_g</span>: you don't need to call init() if you use the constructor that takes a context</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Tue Dec 06 2022 08:02:48 GMT-0800 (Pacific Standard Time)">16:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">uh we did <a href="https://searchfox.org/mozilla-central/source/js/public/CharacterEncoding.h#366-382">https://searchfox.org/mozilla-central/source/js/public/CharacterEncoding.h#366-382</a></td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Tue Dec 06 2022 08:27:08 GMT-0800 (Pacific Standard Time)">16:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">sfink</span>: do you have more comments about parallel marking?  I'd like to start landing patches</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Tue Dec 06 2022 09:27:10 GMT-0800 (Pacific Standard Time)">17:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">jonco</span>: I'll do a final pass through now. I haven't found any problems so far.</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Tue Dec 06 2022 09:27:39 GMT-0800 (Pacific Standard Time)">17:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">great, cheers!</td></tr>

</tbody></table></div></div></div>
</body></html>