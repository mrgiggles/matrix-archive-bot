<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2023-01-12</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2023-01-12<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2023-01-11" class="nav-link"><span>prev</span></a>
<a href="2023-01-13" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search SpiderMonkey">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Jan 11 2023 16:37:32 GMT-0800 (Pacific Standard Time)">00:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@jrmuizel:mozilla.org">jrmuizel</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">sfink</span>: have you used jorendb recently?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Jan 11 2023 16:37:39 GMT-0800 (Pacific Standard Time)">00:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@jrmuizel:mozilla.org">jrmuizel</span>&gt;</div></td><td class="msg-cell">or anyone else realy</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Jan 11 2023 16:37:46 GMT-0800 (Pacific Standard Time)">00:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@jrmuizel:mozilla.org">jrmuizel</span>&gt;</div></td><td class="msg-cell">it seems sort of broken</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Jan 11 2023 18:29:21 GMT-0800 (Pacific Standard Time)">02:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@jrmuizel:mozilla.org">jrmuizel</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">tcampbell</span>: I got the adding elements part of react-todomvc working in the js shells</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Jan 11 2023 18:29:37 GMT-0800 (Pacific Standard Time)">02:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@jrmuizel:mozilla.org">jrmuizel</span>&gt;</div></td><td class="msg-cell">v8 gets about 150-160ms, spidermonkey is 200-215ms
</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Jan 11 2023 18:29:48 GMT-0800 (Pacific Standard Time)">02:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@jrmuizel:mozilla.org">jrmuizel</span>&gt;</div></td><td class="msg-cell"><a href="https://github.com/jrmuizel/Speedometer/tree/shell-react-todomvc">https://github.com/jrmuizel/Speedometer/tree/shell-react-todomvc</a>
</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Jan 11 2023 23:23:33 GMT-0800 (Pacific Standard Time)">07:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@whimboo:mozilla.org">whimboo</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-2">whimboo</span>: yes, spidermonkey version numbers the Firefox release numbers of mozilla-central. For embedders we generally recommend people follow the Firefox ESR schedule (eg 60, 68, 78, 91, 102)</blockquote></mx-reply>That's great. So from the version we basically cut off the minor and patch part only only take the major version number. Thanks!</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Thu Jan 12 2023 02:43:48 GMT-0800 (Pacific Standard Time)">10:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> That's great. So from the version we basically cut off the minor and patch part only only take the major version number. Thanks!</blockquote></mx-reply>I am not sure if that is a intentional decision, I would rather says the version numbers are identical.</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Thu Jan 12 2023 02:43:50 GMT-0800 (Pacific Standard Time)">10:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">eg. <a href="https://searchfox.org/mozilla-central/source/js/src/jsapi.cpp#431">https://searchfox.org/mozilla-central/source/js/src/jsapi.cpp#431</a></td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Thu Jan 12 2023 02:59:10 GMT-0800 (Pacific Standard Time)">10:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@whimboo:mozilla.org">whimboo</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I am not sure if that is a intentional decision, I would rather says the version numbers are identical.</blockquote></mx-reply>that is interesting! So we should be safe then in using <code>Services.appinfo.version</code> directly?</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Thu Jan 12 2023 03:00:04 GMT-0800 (Pacific Standard Time)">11:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">I don't understand question, safe to use for what? </td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Thu Jan 12 2023 03:02:50 GMT-0800 (Pacific Standard Time)">11:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@whimboo:mozilla.org">whimboo</span>&gt;</div></td><td class="msg-cell">we want to supply the spidermonkey version as part of this CDP API: <a href="https://chromedevtools.github.io/devtools-protocol/tot/Browser/#method-getVersion">https://chromedevtools.github.io/devtools-protocol/tot/Browser/#method-getVersion</a> for <code>jsVersion</code>. At the end it won't matter but having it right would be nice</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Thu Jan 12 2023 03:05:56 GMT-0800 (Pacific Standard Time)">11:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">Ah yeah, I guess v8 has their own version numbers. I would personally just use the same value as firefox</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Thu Jan 12 2023 04:03:25 GMT-0800 (Pacific Standard Time)">12:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@l11d:mozilla.org">l11d</span>&gt;</div></td><td class="msg-cell">I've been building firefox with <code>-fsanitize=cfi-derived-cast</code>, which essentially checks base-to-derived casts. one of the reports that comes up when starting firefox is a cast in <code>js/loader/ScriptLoadRequest.cpp</code>. from within the destructor of a base class, the object being destructed is downcasted to the derived class. the destructor of the derived class already ran, however the object hasn't been deallocated yet. is this kind of sanitizer report worth filing as bug?</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Thu Jan 12 2023 04:36:17 GMT-0800 (Pacific Standard Time)">12:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">l11d</span>: yes please file a bug in DOM: Core</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Thu Jan 12 2023 05:03:53 GMT-0800 (Pacific Standard Time)">13:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">l11d</span>: and thanks for looking into this :)</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Thu Jan 12 2023 05:05:11 GMT-0800 (Pacific Standard Time)">13:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@l11d:mozilla.org">l11d</span>&gt;</div></td><td class="msg-cell">sure thing :)</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Thu Jan 12 2023 09:26:25 GMT-0800 (Pacific Standard Time)">17:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-12">sfink</span>: have you used jorendb recently?</blockquote></mx-reply>Yes. As far as I know, I'm the only user of it. I use it through a separate script where I can preface a JS shell command line with <code>debug --js</code> and it'll start up in an emacs window, massaging the orignal command line as needed.</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Thu Jan 12 2023 09:46:20 GMT-0800 (Pacific Standard Time)">17:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@jrmuizel:mozilla.org">jrmuizel</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">sfink</span>: how do you start and stop it? I tried throwing an exception and then single stepping and that didn't work</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Thu Jan 12 2023 09:47:48 GMT-0800 (Pacific Standard Time)">17:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">Use a <code>debugger</code> statement.</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Thu Jan 12 2023 09:48:04 GMT-0800 (Pacific Standard Time)">17:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">(in a meeting, will say more later)</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Thu Jan 12 2023 11:29:07 GMT-0800 (Pacific Standard Time)">19:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">huh, when I try a dirt-simple example, it runs forever even with <code>debugger</code>. Ok, I'll have to look at how I actually use it. I must have broken it for other usage. :-(</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Thu Jan 12 2023 11:41:54 GMT-0800 (Pacific Standard Time)">19:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><span class="nick-14">jrmuizel</span>: ugh, seems like it's pretty messy to get it to run with the repl. The main thing seems to be to run it with <code>$JS -f jorendb.js ...</code> (note the -f) rather than <code>$JS jorendb.js ...</code></td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Thu Jan 12 2023 11:42:08 GMT-0800 (Pacific Standard Time)">19:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@jrmuizel:mozilla.org">jrmuizel</span>&gt;</div></td><td class="msg-cell">ah</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Thu Jan 12 2023 11:42:40 GMT-0800 (Pacific Standard Time)">19:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@jrmuizel:mozilla.org">jrmuizel</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">sfink</span>: the source code talks about <code>-d jorendb.js</code>. The <code>-d</code> flag doesn't seem to exist.</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Thu Jan 12 2023 11:42:44 GMT-0800 (Pacific Standard Time)">19:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@jrmuizel:mozilla.org">jrmuizel</span>&gt;</div></td><td class="msg-cell">Do you know what that's about?</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Thu Jan 12 2023 11:44:12 GMT-0800 (Pacific Standard Time)">19:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">that must be stale. I think there was a shell flag that made sure to enable debug mode, but then we made that unnecessary and must have removed it.</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Thu Jan 12 2023 11:48:34 GMT-0800 (Pacific Standard Time)">19:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">it would be fun to do a cleanup pass on this. I actually really like it as a debugger. Even if it doesn't support basic things like setting a breakpoint on a filename:lineno</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Thu Jan 12 2023 11:50:12 GMT-0800 (Pacific Standard Time)">19:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">but it's hard to take seriously right now, when <code>$JS -f jorendb.js -e 'debugger; print("hey!")'</code> doesn't do anything useful.</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Thu Jan 12 2023 11:51:13 GMT-0800 (Pacific Standard Time)">19:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I guess <code>$JS -f jorendb.js -- -e 'debugger; print("hey!")'</code> works, at least.</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Thu Jan 12 2023 11:51:22 GMT-0800 (Pacific Standard Time)">19:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">"works"</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Thu Jan 12 2023 11:56:43 GMT-0800 (Pacific Standard Time)">19:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">FWIW, I took jorendb as a starting point for GNOME's JS debugger</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Thu Jan 12 2023 11:58:20 GMT-0800 (Pacific Standard Time)">19:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I'm sorry</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Thu Jan 12 2023 11:58:28 GMT-0800 (Pacific Standard Time)">19:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">also, that's really cool</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Thu Jan 12 2023 12:00:29 GMT-0800 (Pacific Standard Time)">20:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I guess I expected that you would add enough networking stuff to be able to serve the JS Debugger API, and then use it remotely.</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Thu Jan 12 2023 12:04:56 GMT-0800 (Pacific Standard Time)">20:04</a></td><td class="nick-cell"><div class="m-ov"><span class="nick nick-12" title="@sfink:mozilla.org">sfink</span></div></td><td class="msg-cell">is reading <a href="https://wiki.gnome.org/Projects/GnomeShell/DebuggingJavaScript">https://wiki.gnome.org/Projects/GnomeShell/DebuggingJavaScript</a></td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Thu Jan 12 2023 14:48:36 GMT-0800 (Pacific Standard Time)">22:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">"I'm sorry" followed by "that's really cool" describes so much of mozilla</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Thu Jan 12 2023 14:49:41 GMT-0800 (Pacific Standard Time)">22:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">OMG that wiki page! it describes a totally different debugger that was never merged, to my knowledge</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Thu Jan 12 2023 14:50:24 GMT-0800 (Pacific Standard Time)">22:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> FWIW, I took jorendb as a starting point for GNOME's JS debugger</blockquote></mx-reply>and I guess I'll look at GNOME's as a starting point for my own 🙃</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Thu Jan 12 2023 14:50:46 GMT-0800 (Pacific Standard Time)">22:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">Mostly because I'm too scared to look at the devtools one</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Thu Jan 12 2023 15:55:28 GMT-0800 (Pacific Standard Time)">23:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@smaug:mozilla.org">smaug</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">sfink</span>: which of the JS::GCReason values map to minor GC? Is it all the ones with <em>NURSERY</em> in the name?</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Thu Jan 12 2023 15:57:36 GMT-0800 (Pacific Standard Time)">23:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">there are others, eg FULL_WHOLE_CELL_BUFFER</td></tr>

</tbody></table></div></div></div>
</body></html>