<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2023-07-20</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2023-07-20<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2023-07-19" class="nav-link"><span>prev</span></a>
<a href="2023-07-24" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search SpiderMonkey">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Jul 19 2023 17:11:04 GMT-0700 (Pacific Daylight Time)">00:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">iiuc, the "invalid UTF-16" mentioned there means "lone surrogate", and UTF-8 cannot represent it</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Jul 19 2023 17:16:59 GMT-0700 (Pacific Daylight Time)">00:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">err, maybe I misunderstood the reasoning of deprecation</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Jul 19 2023 17:19:55 GMT-0700 (Pacific Daylight Time)">00:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">in term of "allocation from the caller", <a href="https://searchfox.org/mozilla-central/rev/4537bb2abc8eb49506bbad27b89ab364ac3062d3/js/public/CharacterEncoding.h#288">GetDeflatedUTF8StringLength</a> and <a href="https://searchfox.org/mozilla-central/rev/4537bb2abc8eb49506bbad27b89ab364ac3062d3/js/public/CharacterEncoding.h#306">JS::DeflateStringToUTF8Buffer</a> would be alternative</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Jul 19 2023 17:49:30 GMT-0700 (Pacific Daylight Time)">00:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@3v1n0:matrix.org">Treviño</span>&gt;</div></td><td class="msg-cell">arai: yeah thanks those are the ones I was considering in fact</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Jul 19 2023 19:00:45 GMT-0700 (Pacific Daylight Time)">02:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><p>what's the possibility to support global script with non-syntactic scope in warp?  the following comment mentions it's not supported right now.  I'm experimenting improving <code>Debugger.Object.prototype.executeInGlobalWithBindings</code> performance in bug 1842701, and wondering if supporting non-syntactic scope with known bindings is reasonable approach  <a href="https://searchfox.org/mozilla-central/rev/4537bb2abc8eb49506bbad27b89ab364ac3062d3/js/src/jit/Ion.cpp#1767-1770">https://searchfox.org/mozilla-central/rev/4537bb2abc8eb49506bbad27b89ab364ac3062d3/js/src/jit/Ion.cpp#1767-1770</a></p>
<pre><code class="language-cpp">// Support functions with a non-syntactic global scope but not other
// scripts. For global scripts, WarpBuilder currently uses the global
// object as scope chain, this is not valid when the script has a
// non-syntactic global scope.
</code></pre>
</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Jul 19 2023 19:00:48 GMT-0700 (Pacific Daylight Time)">02:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1842701">https://bugzil.la/1842701</a> — ASSIGNED (arai) — Experiment with dedicate compilation/execution mode for Debugger.Object.prototype.executeInGlobalWithBindings</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Thu Jul 20 2023 00:29:06 GMT-0700 (Pacific Daylight Time)">07:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@liam_g:mozilla.org">liam_g</span>&gt;</div></td><td class="msg-cell">Is there any mechanism in Spidermonkey which would help me receive automatic callbacks whenever a particular value changes? Or is the best option just to ping it continuously?</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Thu Jul 20 2023 01:19:00 GMT-0700 (Pacific Daylight Time)">08:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">if it's about changes from JS code you could consider using a proxy</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Thu Jul 20 2023 01:35:29 GMT-0700 (Pacific Daylight Time)">08:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@liam_g:mozilla.org">liam_g</span>&gt;</div></td><td class="msg-cell">It is changes from JS code that I'm looking for, but it's changes to "any given" value, so I can't use a proxy.</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Thu Jul 20 2023 01:36:47 GMT-0700 (Pacific Daylight Time)">08:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@liam_g:mozilla.org">liam_g</span>&gt;</div></td><td class="msg-cell">It's for a UI component that will display some given value, and update if the value changes.</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Thu Jul 20 2023 01:38:04 GMT-0700 (Pacific Daylight Time)">08:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@liam_g:mozilla.org">liam_g</span>&gt;</div></td><td class="msg-cell">My guess is that there is no such feature in Spidermonkey, and I'll have to just ping the value frequently to see if it changes. Which is OK, but I'd like to know if there are any alternatives.</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Thu Jul 20 2023 06:52:59 GMT-0700 (Pacific Daylight Time)">13:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@fbraun:mozilla.org">freddy</span>&gt;</div></td><td class="msg-cell">does spidermonkey have a capability to export / dump code while (or after) it is being executed? wouldn't really matter if this is JavaScript or an intermediate representation</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Thu Jul 20 2023 06:55:24 GMT-0700 (Pacific Daylight Time)">13:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">do you mean the JS source code (such like <code>Function.prototype.toString</code>), or something that also contains the runtime data such as variable and object?</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Thu Jul 20 2023 06:58:23 GMT-0700 (Pacific Daylight Time)">13:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">in other words, what do you want to do with the exported thing?</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Thu Jul 20 2023 07:00:56 GMT-0700 (Pacific Daylight Time)">14:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@fbraun:mozilla.org">freddy</span>&gt;</div></td><td class="msg-cell">The goal is dynamic code analysis. Kind of like a debugger trace for a single run through a program (so, variables that contain values)</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Thu Jul 20 2023 07:08:29 GMT-0700 (Pacific Daylight Time)">14:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">can you provide an example input and output?</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Thu Jul 20 2023 07:12:53 GMT-0700 (Pacific Daylight Time)">14:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">variables could be logged by running the code under debugger, performing step execution and get variables from environments for each time</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Thu Jul 20 2023 07:16:33 GMT-0700 (Pacific Daylight Time)">14:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">if you need code coverage, that's already there. setting <code>JS_CODE_COVERAGE_OUTPUT_DIR</code> environment variable will generate the coverage data in the directory</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Thu Jul 20 2023 07:21:45 GMT-0700 (Pacific Daylight Time)">14:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@fbraun:mozilla.org">freddy</span>&gt;</div></td><td class="msg-cell">In compiler speak, I was wondering if Spidermonkey is converting JS into some sort of Intermediate Representation before it is executed. Maybe that only happens for JITted code and not all executed code?</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Thu Jul 20 2023 07:24:11 GMT-0700 (Pacific Daylight Time)">14:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">the JS source is converted into bytecode for all execution</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Thu Jul 20 2023 07:24:28 GMT-0700 (Pacific Daylight Time)">14:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell">(since you mention tracing, the DevTools debugger does have a trace feature, under <code>devtools.debugger.features.javascript-tracing</code> pref)</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Thu Jul 20 2023 07:25:31 GMT-0700 (Pacific Daylight Time)">14:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@fbraun:mozilla.org">freddy</span>&gt;</div></td><td class="msg-cell"><span class="nick-14">nchevobbe</span>: what would the output look like?</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Thu Jul 20 2023 07:26:25 GMT-0700 (Pacific Daylight Time)">14:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@fbraun:mozilla.org">freddy</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">arai</span>: would that bytecode just be a different language or does the bytecode contain values?</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Thu Jul 20 2023 07:27:34 GMT-0700 (Pacific Daylight Time)">14:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">the bytecode contains the almost same info as the JS code itself</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Thu Jul 20 2023 07:28:35 GMT-0700 (Pacific Daylight Time)">14:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">what do you mean by "values" here?  literals written in the JS code?</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Thu Jul 20 2023 07:29:20 GMT-0700 (Pacific Daylight Time)">14:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell"><p>hovering the menu items on <a href="http://mozilla.org">mozilla.org</a>, I'm getting this kind of thing:</p>
<pre><code>—interpreter⟶λ n.onMouseEnter ui.ef9ab0413ef0.js:1:6199
—interpreter⟶λ n.onMouseEnter/e&lt; ui.ef9ab0413ef0.js:1:6246
——interpreter⟶λ n.close ui.ef9ab0413ef0.js:1:5403
——interpreter⟶λ n.open ui.ef9ab0413ef0.js:1:5180
—interpreter⟶λ n.onMouseLeave ui.ef9ab0413ef0.js:1:6310
—interpreter⟶λ n.onMouseEnter ui.ef9ab0413ef0.js:1:6199
—interpreter⟶λ n.onMouseEnter/e&lt; ui.ef9ab0413ef0.js:1:6246
——interpreter⟶λ n.close ui.ef9ab0413ef0.js:1:5403
——interpreter⟶λ n.open ui.ef9ab0413ef0.js:1:5180
—interpreter⟶λ n.onMouseLeave ui.ef9ab0413ef0.js:1:6310
—interpreter⟶λ n.onMouseLeave/e&lt; ui.ef9ab0413ef0.js:1:6351
——interpreter⟶λ n.close ui.ef9ab0413ef0.js:1:5403
</code></pre>
</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Thu Jul 20 2023 07:30:01 GMT-0700 (Pacific Daylight Time)">14:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@fbraun:mozilla.org">freddy</span>&gt;</div></td><td class="msg-cell">Yeah, literals (strings, numbers). Also, I wonder what function calls would look like (for DOM APIs e.g.)</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Thu Jul 20 2023 07:30:22 GMT-0700 (Pacific Daylight Time)">14:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@fbraun:mozilla.org">freddy</span>&gt;</div></td><td class="msg-cell">thank you!</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Thu Jul 20 2023 07:31:20 GMT-0700 (Pacific Daylight Time)">14:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">perhaps you want an AST of the JS code?</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Thu Jul 20 2023 07:31:41 GMT-0700 (Pacific Daylight Time)">14:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">so that you can traverse the tree and see each literals and also see what function it calls?</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Thu Jul 20 2023 07:33:21 GMT-0700 (Pacific Daylight Time)">14:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@fbraun:mozilla.org">freddy</span>&gt;</div></td><td class="msg-cell">That wouldn't help with obfsucation, e.g., <code>window[something]()</code> This is why I thought of bytecode inspection or some other dynamic analysis..</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Thu Jul 20 2023 07:38:10 GMT-0700 (Pacific Daylight Time)">14:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">what's the goal with the dynamic analysis?    for example, I need similar thing when investigating web-compat issue, to see what the website's code does and how it works and where it goes wrong.  the trace above (and bug 1835089) will help figuring out what API the website calls</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Thu Jul 20 2023 07:38:11 GMT-0700 (Pacific Daylight Time)">14:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1835089">https://bugzil.la/1835089</a> — NEW (nobody) — Trace calls to native functions</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Thu Jul 20 2023 08:00:02 GMT-0700 (Pacific Daylight Time)">15:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@fbraun:mozilla.org">freddy</span>&gt;</div></td><td class="msg-cell">could be used for deobfuscation :)</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Thu Jul 20 2023 08:07:58 GMT-0700 (Pacific Daylight Time)">15:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">so, you're looking into deobfuscating JS code?  or is it just an example application of what you're trying to develop?  I'm still not sure what the goal and requirements are</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Thu Jul 20 2023 08:32:23 GMT-0700 (Pacific Daylight Time)">15:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@fbraun:mozilla.org">freddy</span>&gt;</div></td><td class="msg-cell">I could see someone developing heuristics on top of this to detect undesirable code (trackers? malware? exploits? cryptominers? fingerprinters?)</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Thu Jul 20 2023 08:32:54 GMT-0700 (Pacific Daylight Time)">15:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@fbraun:mozilla.org">freddy</span>&gt;</div></td><td class="msg-cell">could also be useful for addons review process? I'm just thinking out loud here and trying to find out what capabilities exist</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Thu Jul 20 2023 08:41:14 GMT-0700 (Pacific Daylight Time)">15:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><p><span class="nick-14">freddy</span>: When we parse JS, we turn it into bytecode. For example, this is what the bytecode looks like for a simple function:</p>
<pre><code>js&gt; function foo(a,b) { return a + b; }
js&gt; dis(foo)

loc   line  op
----- ----  --
main:
00000:  43  GetArg 0                    # a
00003:  43  GetArg 1                    # a b
00006:  43  Add                         # (a + b)
00007:  43  Return                      # 
</code></pre>
<p>The bytecode expresses the same information as the source code, but in a form that is possible to execute. Once we have bytecode, we have several different ways to run it, depending on how hot it is / how much effort we can afford to put into making it go fast.</p>
</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Thu Jul 20 2023 08:41:36 GMT-0700 (Pacific Daylight Time)">15:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">The bytecode doesn't have any information about the dynamic behaviour of the program.</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Thu Jul 20 2023 08:47:48 GMT-0700 (Pacific Daylight Time)">15:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">If you're interested in dynamic behaviour, we have a variety of hooks in different places. The problem with tracking dynamic behaviour is that we run a <em>lot</em> of code. It's hard to imagine a general "log everything that happens in SpiderMonkey" system, because it would be too much information.</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Thu Jul 20 2023 08:49:18 GMT-0700 (Pacific Daylight Time)">15:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">If you have a sense of what sorts of events during JS execution you would be interested in analyzing, that would help us figure out whether that information is already available, or whether we can easily make it available</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Thu Jul 20 2023 09:16:11 GMT-0700 (Pacific Daylight Time)">16:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">for debugger-related things, <a href="https://searchfox.org/mozilla-central/source/js/src/doc/Debugger">https://searchfox.org/mozilla-central/source/js/src/doc/Debugger</a> contains documents for Debugger API and you could look into it what kind of information can be retrieved during executing code</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Thu Jul 20 2023 09:17:02 GMT-0700 (Pacific Daylight Time)">16:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@kevin_wang_22:matrix.org">kevin_wang_22</span>&gt;</div></td><td class="msg-cell">Hi, 

I have a assertion failure when global data is removed: 

Assertion failure: isInList(),
What is it? How could it happen? How to fix? 

Can anyone help?
Thx</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Thu Jul 20 2023 09:18:11 GMT-0700 (Pacific Daylight Time)">16:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">is it happening in your embedding?  can you run it under debugger and get backtrace of it?</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Thu Jul 20 2023 09:19:47 GMT-0700 (Pacific Daylight Time)">16:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><code>isInList()</code> assertion appears in multiple places, and it's hard to say without knowing which one fails  <a href="https://searchfox.org/mozilla-central/search?q=ASSERT%28isInList%28%29&amp;path=&amp;case=false&amp;regexp=false">https://searchfox.org/mozilla-central/search?q=ASSERT%28isInList%28%29&amp;path=&amp;case=false&amp;regexp=false</a></td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Thu Jul 20 2023 09:41:17 GMT-0700 (Pacific Daylight Time)">16:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">also, can you provide more information about "global data is removed" situation?  what do you mean with "global data" and what operation does "remove" mean?</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Thu Jul 20 2023 09:41:43 GMT-0700 (Pacific Daylight Time)">16:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">if you can provide a small testcase or codelet, that will help investigating what's happening</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Thu Jul 20 2023 10:58:45 GMT-0700 (Pacific Daylight Time)">17:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">how can I run <code>mach jstestbrowser</code> in a way that outputs... well, anything useful. Even whether a test failed or not would be good. Right now, I can see the test output and failures flash up briefly on the screen, but there's nothing in the log (or the return code) that I can look at.</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Thu Jul 20 2023 11:00:15 GMT-0700 (Pacific Daylight Time)">18:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><code>console.log</code> and <code>console.error</code> don't go anywhere. I tried doing <code>printErr</code> via <code><a href="http://SpecialPowers.Cu">SpecialPowers.Cu</a>.getJSTestingFunctions().printErr</code>, but it didn't seem to work, possibly because that isn't right but it's hard to tell with no output.</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Thu Jul 20 2023 11:49:30 GMT-0700 (Pacific Daylight Time)">18:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><p>I see the output from <code>print</code>, as <code>TEST-INFO | ...</code> line in stdout <a href="https://searchfox.org/mozilla-central/rev/d35b3fe3d8230a255b988afb0ebda1176fc2f50b/js/src/tests/non262/global/parseInt-01.js#8">https://searchfox.org/mozilla-central/rev/d35b3fe3d8230a255b988afb0ebda1176fc2f50b/js/src/tests/non262/global/parseInt-01.js#8</a></p>
<pre><code class="language-js">print(BUGNUMBER + ": " + summary);
</code></pre>
</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Thu Jul 20 2023 11:50:45 GMT-0700 (Pacific Daylight Time)">18:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">I have a general question about mozjs.  Almost all of the functions in the API have a bool return value.  If they return false, is that always the result of either an exception or some other error condition like out-of-memory?</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Thu Jul 20 2023 11:58:27 GMT-0700 (Pacific Daylight Time)">18:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">That is generally the convention, yes. I don't know off the top of my head if there are any exceptions. Functions that don't take a JSContext would be one exception: we can't return an error if we don't have the context to store it on. Another exception could be functions whose names end in "Pure", which is a convention that says "try to do this operation if you can do so without triggering GC / having arbitrary side effects", in which case returning false means that we gave up, not that we threw an error. I'm not sure that we expose any of those in the API, though.</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Thu Jul 20 2023 11:59:19 GMT-0700 (Pacific Daylight Time)">18:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> That is generally the convention, yes. I don't know off the top of my head if there are any exceptions. Functions that don't take a JSContext would be one exception: we can't return an error if we don't have the context to store it on. Another exception could be functions whose names end in "Pure", which is a convention that says "try to do this operation if you can do so without triggering GC / having arbitrary side effects", in which case returning false means that we gave up, not that we threw an error. I'm not sure that we expose any of those in the API, though.</blockquote></mx-reply>OK, thanks.  Do you happen to have any pre-defined macros in the library that do something like "try this and return if false"?</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Thu Jul 20 2023 12:00:41 GMT-0700 (Pacific Daylight Time)">19:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">There's MOZ_TRY and MOZ_TRY_VAR for functions that return Result</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Thu Jul 20 2023 12:01:27 GMT-0700 (Pacific Daylight Time)">19:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">But generally we just write <code>if (!foo()) { return false; }</code> or <code>if (!foo()) { return nullptr; }</code>, depending on the return type of the function</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Thu Jul 20 2023 12:01:39 GMT-0700 (Pacific Daylight Time)">19:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">I saw that result stuff before, but I wasn't clear on what it was used for</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Thu Jul 20 2023 13:16:39 GMT-0700 (Pacific Daylight Time)">20:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <p>I see the output from <code>print</code>, as <code>TEST-INFO | ...</code> line in stdout <a href="https://searchfox.org/mozilla-central/rev/d35b3fe3d8230a255b988afb0ebda1176fc2f50b/js/src/tests/non262/global/parseInt-01.js#8">https://searchfox.org/mozilla-central/rev/d35b3fe3d8230a255b988afb0ebda1176fc2f50b/js/src/tests/non262/global/parseInt-01.js#8</a></p>
<pre><code class="language-js">print(BUGNUMBER + ": " + summary);
</code></pre>
</blockquote></mx-reply>Huh. I don't know why I'm not getting that. But I'm definitely not.</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Thu Jul 20 2023 13:16:57 GMT-0700 (Pacific Daylight Time)">20:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">On the other hand, it looks like Pernosco reproduced my run, so I'll just use that instead.</td></tr>

</tbody></table></div></div></div>
</body></html>