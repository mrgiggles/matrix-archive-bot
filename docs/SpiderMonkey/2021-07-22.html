<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2021-07-22</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2021-07-22<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2021-07-21" class="nav-link"><span>prev</span></a>
<a href="2021-07-23" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search SpiderMonkey">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Jul 21 2021 21:24:49 GMT-0700 (Pacific Daylight Time)">04:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@leveryd:mozilla.org">leveryd</span>&gt;</div></td><td class="msg-cell">can spidermonkey be used to deobfuscation javascript code? such as beautify below code.</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Jul 21 2021 21:25:18 GMT-0700 (Pacific Daylight Time)">04:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@leveryd:mozilla.org">leveryd</span>&gt;</div></td><td class="msg-cell">/*
// OPTIMIZE(deobfuscation): 
var d = ["1", "23", "4"]
var c = ["4", "23", "1"]
var s = "4231"
*/
var s="1 23 4"
var d = s.split("")
  , c = d.reverse();
s = c.join("");
</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Jul 21 2021 21:27:47 GMT-0700 (Pacific Daylight Time)">04:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">does the beautify mean formatting the code ?</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Jul 21 2021 21:28:27 GMT-0700 (Pacific Daylight Time)">04:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">oh, I guess I misunderstood</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Jul 21 2021 21:28:30 GMT-0700 (Pacific Daylight Time)">04:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@leveryd:mozilla.org">leveryd</span>&gt;</div></td><td class="msg-cell">no. mean "evaluate some simple expression".</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Jul 21 2021 21:29:27 GMT-0700 (Pacific Daylight Time)">04:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">what's the difference between evaluating it in regular way?</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Jul 21 2021 21:32:06 GMT-0700 (Pacific Daylight Time)">04:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">do you want to pretty print each variable name and value, after evaluating the whole code?</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Jul 21 2021 21:37:47 GMT-0700 (Pacific Daylight Time)">04:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">if so, you can enumerate global object's properties and uneval each value, and format them into JS code manually</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed Jul 21 2021 21:38:32 GMT-0700 (Pacific Daylight Time)">04:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">in which layer are you going to do that? C++?</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed Jul 21 2021 23:50:17 GMT-0700 (Pacific Daylight Time)">06:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@leveryd:mozilla.org">leveryd</span>&gt;</div></td><td class="msg-cell">yes.but my scenario is complex: one function which has more than 20000 lines code, it has been obfuscated and so it is hard to read.for reading easy,i want to beatify some small code of this function.</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed Jul 21 2021 23:50:30 GMT-0700 (Pacific Daylight Time)">06:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@leveryd:mozilla.org">leveryd</span>&gt;</div></td><td class="msg-cell">complete code is here <a href="https://gist.github.com/leveryd/d0562783282c65178303c2bcbcb9f3f2">https://gist.github.com/leveryd/d0562783282c65178303c2bcbcb9f3f2</a></td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed Jul 21 2021 23:55:03 GMT-0700 (Pacific Daylight Time)">06:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">what's expected output?</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed Jul 21 2021 23:57:02 GMT-0700 (Pacific Daylight Time)">06:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">if you want to apply some kind of filter to the code and get another JS function, it's not JS engine's job, but you'll need a dedicate program</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed Jul 21 2021 23:57:17 GMT-0700 (Pacific Daylight Time)">06:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">you could use parser API there tho</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed Jul 21 2021 23:58:29 GMT-0700 (Pacific Daylight Time)">06:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">so, feed the source to parser API, get AST, apply the filter on the AST, pretty print the AST to get filtered source</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Thu Jul 22 2021 00:00:43 GMT-0700 (Pacific Daylight Time)">07:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@leveryd:mozilla.org">leveryd</span>&gt;</div></td><td class="msg-cell"><p>input:</p>
<pre><code>...
case 1:
      return e[0] = 0,
      e[2] = "sucof",
      e[8] = e[2].split(""),
      e[2] = e[8].reverse(),
      e[8] = e[2].join(""),
      e[2] = e[20] == e[8],
      r = e[2] ? 1996 : 2679,
      void 0;
...
</code></pre>
<p>expected output:</p>
<pre><code>...
case 1:
  return e[0] = 0,
  e[2] = "sucof",
  e[8] = ["s", "u", "c", "o" ,"f"]
  e[2] = ["f", "o", "c", "u", "s"]
  e[8] = "focus"
  e[2] = e[20] == "focus"
  r = e[2] ? 1996 : 2679,
...
</code></pre>
<p>or more simplified</p>
<pre><code>...
case 1:
  return e[0] = 0,
  e[8] = "focus"
  e[2] = e[20] == "focus"
  r = e[2] ? 1996 : 2679,
...
</code></pre>
</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Thu Jul 22 2021 00:03:19 GMT-0700 (Pacific Daylight Time)">07:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@nribaudo:igalia.com">Nicol√≤</span>&gt;</div></td><td class="msg-cell">You can try with <a href="https://prepack.io/repl.html">https://prepack.io/repl.html</a>, which partially evaluates your code</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Thu Jul 22 2021 14:50:07 GMT-0700 (Pacific Daylight Time)">21:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">tcampbell</span>: apologies for dragging you in, but g:landium could not reproduce that <code>mozilla::isNaN</code> thing and now neither can I. What were you running when you hit it? <code><a href="http://autospider.py">autospider.py</a></code>? With what args, or at least what variant? And what version is your system <code>gcc</code>, not that I would expect it to be used.</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Thu Jul 22 2021 14:51:22 GMT-0700 (Pacific Daylight Time)">21:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">sfink</span>: <code>./mach build</code> + a mozconfig that said CC=gcc CXX=g++</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Thu Jul 22 2021 14:51:38 GMT-0700 (Pacific Daylight Time)">21:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">my system gcc is 9.3</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Thu Jul 22 2021 14:53:17 GMT-0700 (Pacific Daylight Time)">21:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">cool, thanks</td></tr>

</tbody></table></div></div></div>
</body></html>