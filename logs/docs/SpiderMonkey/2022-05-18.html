<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2022-05-18</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2022-05-18<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-05-17" class="nav-link"><span>prev</span></a>
<a href="2022-05-19" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed May 18 2022 00:33:42 GMT-0700 (Pacific Daylight Time)">07:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">Hello everyone</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed May 18 2022 00:34:16 GMT-0700 (Pacific Daylight Time)">07:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">I was POC-ing using webassembly in 0 A.D. yesterday, and managed to get things working (and compiling AssemblyScript to WASM within spidermonkey as well)</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed May 18 2022 00:34:44 GMT-0700 (Pacific Daylight Time)">07:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">However unless I'm missing something, there are no APIs in SM91 to interact with WASM directly, are there ? </td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed May 18 2022 00:34:51 GMT-0700 (Pacific Daylight Time)">07:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">sorry interact directly from C++ * </td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed May 18 2022 01:58:39 GMT-0700 (Pacific Daylight Time)">08:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">wraitii</span>: you mean, call wasm functions, for example?</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed May 18 2022 02:17:27 GMT-0700 (Pacific Daylight Time)">09:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@albus:tchncs.de">albus</span>&gt;</div></td><td class="msg-cell"><p>Oi good people, I have these turned off for my daily browsing since I don't need fancy javascript features for daily usage.</p>
<ul>
<li>ion &amp; baselinejit off (but trustedprincipals on)</li>
<li>wasm</li>
<li>asmjs</li>
<li>altsvc</li>
<li>serviceWorkers</li>
</ul>
<p>I am not breaking any security features am I?</p>
</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed May 18 2022 02:31:26 GMT-0700 (Pacific Daylight Time)">09:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">albus</span>: wasm has no fallback method of execution, as opposed to asmjs. So disabling it might cause failures on some websites.</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed May 18 2022 02:32:05 GMT-0700 (Pacific Daylight Time)">09:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">I can't tell about altsvc and serviceWorkers.</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed May 18 2022 02:34:08 GMT-0700 (Pacific Daylight Time)">09:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-12">wraitii</span>: you mean, call wasm functions, for example?</blockquote></mx-reply>Call WASM from C++ &amp; vice versa</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed May 18 2022 03:03:24 GMT-0700 (Pacific Daylight Time)">10:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">wraitii</span>: no, everything goes via JS at the moment, there hasn't been a need for anything else</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed May 18 2022 03:04:10 GMT-0700 (Pacific Daylight Time)">10:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">there's really no reason why we couldn't expose methods to look up names on wasm export objects and invoke them</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed May 18 2022 03:05:06 GMT-0700 (Pacific Daylight Time)">10:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">calling out to C++ from wasm mostly means some way of making C++ functions available to wasm via an import object, this does not have to be hard though the ABI used would be the JS interpreter's ABI</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed May 18 2022 03:06:01 GMT-0700 (Pacific Daylight Time)">10:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">i guess a more involved mechanism to call into wasm would present wasm as C function pointers, that would be more work</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed May 18 2022 03:13:30 GMT-0700 (Pacific Daylight Time)">10:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-12">wraitii</span>: no, everything goes via JS at the moment, there hasn't been a need for anything else</blockquote></mx-reply>Yes, I suppose the 'need' would come from embedder using SpidermonKey for its WASM capability (which maybe isn't the best choice if there's no need for JS alongside it ? )</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed May 18 2022 03:13:56 GMT-0700 (Pacific Daylight Time)">10:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">the general feeling is that wasm without js is not very interesting at the moment</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Wed May 18 2022 03:14:00 GMT-0700 (Pacific Daylight Time)">10:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> calling out to C++ from wasm mostly means some way of making C++ functions available to wasm via an import object, this does not have to be hard though the ABI used would be the JS interpreter's ABI</blockquote></mx-reply>That would be a first step for us, though I think the direct C call would be the real power, but yeah that sounds a lot more complicated</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Wed May 18 2022 03:15:01 GMT-0700 (Pacific Daylight Time)">10:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">(i mean, not very interesting in a browser context.  a pure embedding context is different, clearly.)</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Wed May 18 2022 03:15:31 GMT-0700 (Pacific Daylight Time)">10:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">Well for 0 A.D. we'd probably use both in tandem to be honest. I think WASM provides an interesting way to have faster AOT-compiled sets of code, and our regular JS code alongside it</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Wed May 18 2022 03:15:38 GMT-0700 (Pacific Daylight Time)">10:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">and our C++ on the backend</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Wed May 18 2022 03:16:17 GMT-0700 (Pacific Daylight Time)">10:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">but our C++&lt;-&gt;JS interop would probably benefit from being direct C++ &lt;-&gt; WASM instead of having to go through JS in the end</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Wed May 18 2022 03:16:44 GMT-0700 (Pacific Daylight Time)">10:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">I'm also kind of unclear how to expose JS objects to WASM, but I think that I just need to find good docs somewhere.</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Wed May 18 2022 03:17:19 GMT-0700 (Pacific Daylight Time)">10:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">at the moment you can use the type externref to represent js objects in wasm, they are opaque to wasm but the gc will handle them properly</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Wed May 18 2022 03:17:40 GMT-0700 (Pacific Daylight Time)">10:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">the idiom is to pass in an externref and when wasm needs to do something with it it needs to call out to js</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Wed May 18 2022 03:17:52 GMT-0700 (Pacific Daylight Time)">10:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">this will change with the "gc proposal" for wasm</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Wed May 18 2022 03:18:20 GMT-0700 (Pacific Daylight Time)">10:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">but it'd be lying if i said that i thought the gc proposal would ship in the next 12 months</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Wed May 18 2022 03:20:01 GMT-0700 (Pacific Daylight Time)">10:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">yeah it seems somewhat immature still</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Wed May 18 2022 03:20:27 GMT-0700 (Pacific Daylight Time)">10:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">Basically we expose C++ to JS via an object that holds nativeFunction. And I'd need to expose that same C++ to WASM</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Wed May 18 2022 03:20:42 GMT-0700 (Pacific Daylight Time)">10:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">wraitii</span>: WASM is useful under a context which associate it with a memory to work with. At the moment, this is done in JS within SpiderMonkey. There are use cases of WebAssembly, such as sandboxing part of C++ code, but the same way they need to know which range of memory they are working with.</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Wed May 18 2022 03:21:19 GMT-0700 (Pacific Daylight Time)">10:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">the way I understand it now, I'd need to have some JS 'execute Hook' that takes an externref (the c++ hook), and ask the JS to call it &amp; return the value. But obviously making that 'dynamic' is a pain.</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Wed May 18 2022 03:22:14 GMT-0700 (Pacific Daylight Time)">10:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">going forward (but also not done yet) there will be function references exposed to wasm that can be invoked with call_ref</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Wed May 18 2022 03:22:31 GMT-0700 (Pacific Daylight Time)">10:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">for the time being, the canonical way of doing this is stuffing the function reference in a table and using call_indirect</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Wed May 18 2022 03:22:34 GMT-0700 (Pacific Daylight Time)">10:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">technically speaking, C API is close to the compiled WASM API … some <del>dirty</del> really cool and awesome hacker could do a bridge between the two one day.</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Wed May 18 2022 03:23:11 GMT-0700 (Pacific Daylight Time)">10:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">(for the record I realise this is probably not doable now, but I figured I'd try and see what happens now)</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Wed May 18 2022 03:23:43 GMT-0700 (Pacific Daylight Time)">10:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">for wasm functions, we probably never want to decouple the function from its instance (which also carries its memory), as that will break way too many things including the sandbox</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Wed May 18 2022 03:24:21 GMT-0700 (Pacific Daylight Time)">10:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">but we can already import js functions, of course, so representing pure c++ as some new kind of import seems like it ought to be doable</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Wed May 18 2022 03:24:34 GMT-0700 (Pacific Daylight Time)">10:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">Yeah that's fine for us, I would just want to treat WASM &amp; JS modules the 'same' from the C++ perspective. Basically have some JS modules that interop with C++, some WASM modules that interop with C++, and some JS&lt;-&gt;WASM interop</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Wed May 18 2022 03:26:50 GMT-0700 (Pacific Daylight Time)">10:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">Assuming that wasm modules would execute faster than JS modules for some code, which would let us have 3 tiers of code: engine code that needs proper recompilation, wasm modules that are aot-compiled and trickier to write, and js that's easy to write but on the slower side</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Wed May 18 2022 03:27:57 GMT-0700 (Pacific Daylight Time)">10:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">Anyways, my takeaway here is that it might be fun to try and import C++ functions in wasm modules &amp; see what happens, but I'll have to hack the API to access internals of a module</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Wed May 18 2022 03:32:06 GMT-0700 (Pacific Daylight Time)">10:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">and as another line of thought: I'm assuming js&lt;-&gt;wasm interop is usually faster than js&lt;-&gt;C++ interop would be ?</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Wed May 18 2022 03:32:51 GMT-0700 (Pacific Daylight Time)">10:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">is there a weird world in which JS-&gt;wasm-&gt;C++ is faster than direct JS-&gt;C++ (and vice versa) ? </td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Wed May 18 2022 03:34:16 GMT-0700 (Pacific Daylight Time)">10:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">The GC support is what is slowing down JS-&gt;C++ calls.</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Wed May 18 2022 03:34:44 GMT-0700 (Pacific Daylight Time)">10:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">and some artifact we adopted around the way JS frames are setup</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Wed May 18 2022 03:36:24 GMT-0700 (Pacific Daylight Time)">10:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> The GC support is what is slowing down JS-&gt;C++ calls.</blockquote></mx-reply>I'm not that familiar with the internals I'm afraid, but I'm assuming you mean some unwrapping logic or something along those lines ?</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Wed May 18 2022 03:38:08 GMT-0700 (Pacific Daylight Time)">10:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">Ion compiled code needs to save registers on the stack, in a location which can be recovered by the GC, such that it can patch objects pointer when objects are moving.</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Wed May 18 2022 03:39:47 GMT-0700 (Pacific Daylight Time)">10:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">mh, I see, so doing a lot of storage/reads for any call</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Wed May 18 2022 03:40:00 GMT-0700 (Pacific Daylight Time)">10:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">exactly.</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Wed May 18 2022 03:40:42 GMT-0700 (Pacific Daylight Time)">10:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">Unrelated: I've seen in the notes for SM94/95 something about not tracing/marking permanent objects, is that vaguely related to permanent roots ? I've noted recently that 0 A.D. actually uses a <em>lot</em> of permanently rooted objects</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Wed May 18 2022 03:41:50 GMT-0700 (Pacific Daylight Time)">10:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">jonco</span>: ^ ?</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Wed May 18 2022 03:42:40 GMT-0700 (Pacific Daylight Time)">10:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> exactly.</blockquote></mx-reply>So if I'm reading you correctly, JS &lt;-&gt; WASM doesn't need to save registers since the WASM module cannot change stuff in the JS memory layout, and then the question will be on wasm&lt;-&gt;c++ calls.</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Wed May 18 2022 03:43:13 GMT-0700 (Pacific Daylight Time)">10:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">wraitii</span>: it's about cells that are allocated at startup and that live forever, for example common atoms</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Wed May 18 2022 03:43:29 GMT-0700 (Pacific Daylight Time)">10:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">we have to on JS-&gt;Wasm calls as well</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Wed May 18 2022 03:43:43 GMT-0700 (Pacific Daylight Time)">10:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">wraitii</span>: we now mark these once when they are allocated at startup and don't mark or sweep them afterwards</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Wed May 18 2022 03:43:55 GMT-0700 (Pacific Daylight Time)">10:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">as Wasm can call into JS or C++.</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Wed May 18 2022 03:44:59 GMT-0700 (Pacific Daylight Time)">10:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">jonco</span>: thanks, so unrelated. I think we might gain some time by putting our persistent roots in a separate GC zone that we don't actually GC all that often, but I need to actually read more about those</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Wed May 18 2022 03:46:54 GMT-0700 (Pacific Daylight Time)">10:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">nbp</span>: right, thanks. So ultimately from my POV the Q will be more about implementing direct wasm-c++ interop, and then potentially we might write some modules in either JS or WASM and treat them equivalently-ish from C++, and get local speed boosts on some functions potentially</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Wed May 18 2022 03:47:54 GMT-0700 (Pacific Daylight Time)">10:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">this would be one way to “hack” around the issue.</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Wed May 18 2022 03:51:00 GMT-0700 (Pacific Daylight Time)">10:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">And on a final unrelated note: SM uses some thread_local variables still, right? I've been looking into how we could potentially implement something similar to web workers, but depending on if code is single-threaded-but-can-run-on-various-threads-at-various-points or single-threaded-and-cannot-run-on-another-thread I'd have to take different approaches</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Wed May 18 2022 04:04:12 GMT-0700 (Pacific Daylight Time)">11:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">wasm instances are tied to a thread to some extent, at least</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Wed May 18 2022 04:05:01 GMT-0700 (Pacific Daylight Time)">11:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">it's a pretty loose coupling, the JSContext* is stored in the instance but isn't embedded in compiled code, since we can create multiple instances from the same module and modules can be shared cross-thread</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Wed May 18 2022 04:05:39 GMT-0700 (Pacific Daylight Time)">11:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">mh, I was referring to regular JS contexts here</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Wed May 18 2022 04:05:48 GMT-0700 (Pacific Daylight Time)">11:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell">i don't think we'd want to change the wasm model much, fwiw</td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Wed May 18 2022 04:06:02 GMT-0700 (Pacific Daylight Time)">11:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">I'm aware JSContext* can only run in a single thread at-a-time, but I'm asking if it always must be the same thread, basically</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Wed May 18 2022 04:06:23 GMT-0700 (Pacific Daylight Time)">11:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">(and by JSContext* I'm handwaving 'any code in a given JS runtime')</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Wed May 18 2022 04:06:45 GMT-0700 (Pacific Daylight Time)">11:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">yes, JSContext are tied to a single and unique thread.</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Wed May 18 2022 04:19:02 GMT-0700 (Pacific Daylight Time)">11:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">Alright, thanks. I assume that's not really planned to change</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Wed May 18 2022 04:47:47 GMT-0700 (Pacific Daylight Time)">11:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">yeah this wasm&lt;-&gt;C++ interop thing is getting hooked into my head. I think it could be really interesting for 0 A.D., as a way to support safe but faster 'scripting', to locally replace JS or just generally make things easier to change (e.g. perhaps if we could load AIs as WASM modules we'd have more possibilities)</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Wed May 18 2022 04:48:23 GMT-0700 (Pacific Daylight Time)">11:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">This is on a no-promises basis, but would there be interest in merging code that let C++ interact with WASM more directly into Spidermonkey ?</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Wed May 18 2022 04:50:11 GMT-0700 (Pacific Daylight Time)">11:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">(the scope I'm envisioning is letting C++ instantiate WASM modules that take C++ functions as imports, and its export can be called from C++ directly)</td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Wed May 18 2022 04:54:23 GMT-0700 (Pacific Daylight Time)">11:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@albus:tchncs.de">albus</span>&gt;</div></td><td class="msg-cell">Noob question: Does only using HTTP1.1 (Disabling HTTP2 and 3) have any effect on alternative services (altsvc) and javascript code or features such as wasm, etc.?</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Wed May 18 2022 05:30:35 GMT-0700 (Pacific Daylight Time)">12:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> This is on a no-promises basis, but would there be interest in merging code that let C++ interact with WASM more directly into Spidermonkey ?</blockquote></mx-reply>Possibly.  It probably depends on the form it takes.  It's unlikely (as I alluded to above) that we'll be interested in changing the wasm model, so we'll still need to be talking about imports and exports and modules and instances.  A means whereby a callout to C++ allows the C++ code to magically inspect the calling instance and its data, for example, is probably completely off the table.</td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Wed May 18 2022 05:30:49 GMT-0700 (Pacific Daylight Time)">12:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@lth:mozilla.org">lth</span>&gt;</div></td><td class="msg-cell"><span class="nick-16">Ryan Hunt</span>: ^</td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Wed May 18 2022 05:36:26 GMT-0700 (Pacific Daylight Time)">12:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Possibly.  It probably depends on the form it takes.  It's unlikely (as I alluded to above) that we'll be interested in changing the wasm model, so we'll still need to be talking about imports and exports and modules and instances.  A means whereby a callout to C++ allows the C++ code to magically inspect the calling instance and its data, for example, is probably completely off the table.</blockquote></mx-reply>Yes what I have in mind is more like making WASM modules more of a first-class citizen, alongside javascript, so that a potential embedder could see Spidermonkey as a Javascript or a WASM engine</td></tr>
  <tr class="msg" id="L72"><td class="ts-cell"><a class="ts" href="#L72" alt="Wed May 18 2022 05:36:39 GMT-0700 (Pacific Daylight Time)">12:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">but anyways this is all kinda speculative, I need to get a better grip on what's going on</td></tr>
  <tr class="msg" id="L73"><td class="ts-cell"><a class="ts" href="#L73" alt="Wed May 18 2022 06:13:04 GMT-0700 (Pacific Daylight Time)">13:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@rhunt:mozilla.org">Ryan Hunt</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">wraitii</span>: are you aware of <a href="https://github.com/WebAssembly/wasm-c-api">https://github.com/WebAssembly/wasm-c-api</a> ? that's the proposal for a standardized c/c++ API to WebAssembly VM's. We don't support it, but theoretically could. would that help your use case?</td></tr>
  <tr class="msg" id="L74"><td class="ts-cell"><a class="ts" href="#L74" alt="Wed May 18 2022 06:15:29 GMT-0700 (Pacific Daylight Time)">13:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-12">wraitii</span>: are you aware of <a href="https://github.com/WebAssembly/wasm-c-api">https://github.com/WebAssembly/wasm-c-api</a> ? that's the proposal for a standardized c/c++ API to WebAssembly VM's. We don't support it, but theoretically could. would that help your use case?</blockquote></mx-reply>I am not, it sounds rather related though. That being said, my particular use case is not "a "black box" API for embedding a Wasm engine in other C/C++ applications." but more like "using Spidermonkey as a WASM engine"</td></tr>
  <tr class="msg" id="L75"><td class="ts-cell"><a class="ts" href="#L75" alt="Wed May 18 2022 06:15:58 GMT-0700 (Pacific Daylight Time)">13:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">The implementation 'details' of SM are completely acceptable, I'd just like to allow C++ to run WASM modules instead of JS modules, everything else being equal</td></tr>
  <tr class="msg" id="L76"><td class="ts-cell"><a class="ts" href="#L76" alt="Wed May 18 2022 06:20:25 GMT-0700 (Pacific Daylight Time)">13:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@rhunt:mozilla.org">Ryan Hunt</span>&gt;</div></td><td class="msg-cell">Sure, I may be missing something but that API would allow you to create and instantiate WASM modules, optionally providing imports that may be your own native functions, and calling the exports directly. Is there more you'd like to do?</td></tr>
  <tr class="msg" id="L77"><td class="ts-cell"><a class="ts" href="#L77" alt="Wed May 18 2022 06:33:16 GMT-0700 (Pacific Daylight Time)">13:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">I think that would about cover my needs</td></tr>
  <tr class="msg" id="L78"><td class="ts-cell"><a class="ts" href="#L78" alt="Wed May 18 2022 09:47:20 GMT-0700 (Pacific Daylight Time)">16:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@lgoodacre:matrix.org">liam_g</span>&gt;</div></td><td class="msg-cell">I need to store a vector of JSScripts (compiled from one of the Compile() functions). Do JSScripts get garbage collected? If so, is there a standard way of holding them? Or do I have to store  them in JS::Heap and then deal with tracing?</td></tr>
  <tr class="msg" id="L79"><td class="ts-cell"><a class="ts" href="#L79" alt="Wed May 18 2022 09:56:55 GMT-0700 (Pacific Daylight Time)">16:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell">Yes, JSScripts are GCed. There may be some existing container classes for tracing them. The precise way you need to keep them alive depend on how you are using them, so I'm not sure what you want to do exactly.</td></tr>
  <tr class="msg" id="L80"><td class="ts-cell"><a class="ts" href="#L80" alt="Wed May 18 2022 09:57:33 GMT-0700 (Pacific Daylight Time)">16:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell">The easiest thing is probably JS::Rooted&lt;JSScript*&gt;, but that can cause leaks if the thing you are putting it in can be kept alive itself via JS.</td></tr>
  <tr class="msg" id="L81"><td class="ts-cell"><a class="ts" href="#L81" alt="Wed May 18 2022 10:40:34 GMT-0700 (Pacific Daylight Time)">17:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">liam_g</span>: are they on the stack or the heap?  stack is easiest, it's roughly Rooted&lt;GCVector&lt;JSScript*&gt;&gt;</td></tr>
  <tr class="msg" id="L82"><td class="ts-cell"><a class="ts" href="#L82" alt="Wed May 18 2022 10:42:15 GMT-0700 (Pacific Daylight Time)">17:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><p>In my current ShadowRealms implementation, if you do <code>sr.evaluate('new Error().stack')</code>, you can observe stack frames outside the shadow realm... the spec is currently silent on this, but I suspect this will eventually be strongly suggested to not-happen.</p>
<p>Is there a pre-existing mechanism we have that truncates stacks?</p>
</td></tr>
  <tr class="msg" id="L83"><td class="ts-cell"><a class="ts" href="#L83" alt="Wed May 18 2022 10:42:40 GMT-0700 (Pacific Daylight Time)">17:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">so I could flag execution and say "hey, don't traverse past here should you experience an error"? </td></tr>
  <tr class="msg" id="L84"><td class="ts-cell"><a class="ts" href="#L84" alt="Wed May 18 2022 10:46:39 GMT-0700 (Pacific Daylight Time)">17:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">(Safari doesn't censor their stacks yet either, so not urgent) </td></tr>
  <tr class="msg" id="L85"><td class="ts-cell"><a class="ts" href="#L85" alt="Wed May 18 2022 11:03:57 GMT-0700 (Pacific Daylight Time)">18:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">I guess there's something we use for hiding self-hosted stack?</td></tr>
  <tr class="msg" id="L86"><td class="ts-cell"><a class="ts" href="#L86" alt="Wed May 18 2022 11:05:05 GMT-0700 (Pacific Daylight Time)">18:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">not sure if that applies here, given both inside and outside can be user code</td></tr>
  <tr class="msg" id="L87"><td class="ts-cell"><a class="ts" href="#L87" alt="Wed May 18 2022 13:12:30 GMT-0700 (Pacific Daylight Time)">20:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">mgaudet</span>: i have an item on the agenda at the June TC39 to discuss errors in ShadowRealms, see <a href="https://github.com/tc39/proposal-shadowrealm/issues/353">https://github.com/tc39/proposal-shadowrealm/issues/353</a></td></tr>
  <tr class="msg" id="L88"><td class="ts-cell"><a class="ts" href="#L88" alt="Wed May 18 2022 13:12:52 GMT-0700 (Pacific Daylight Time)">20:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">the SES folks don't want stacks to observable across the boundary, but not sure how we can specify anything around that since it's not a standard</td></tr>
  <tr class="msg" id="L89"><td class="ts-cell"><a class="ts" href="#L89" alt="Wed May 18 2022 13:13:10 GMT-0700 (Pacific Daylight Time)">20:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">it's not clear to me from that discussion what should and shouldn't cross the boundary</td></tr>
  <tr class="msg" id="L90"><td class="ts-cell"><a class="ts" href="#L90" alt="Wed May 18 2022 13:18:01 GMT-0700 (Pacific Daylight Time)">20:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-2">mgaudet</span>: i have an item on the agenda at the June TC39 to discuss errors in ShadowRealms, see <a href="https://github.com/tc39/proposal-shadowrealm/issues/353">https://github.com/tc39/proposal-shadowrealm/issues/353</a></blockquote></mx-reply>Thanks, yeah i saw that. It's definitely a weird situation</td></tr>
  <tr class="msg" id="L91"><td class="ts-cell"><a class="ts" href="#L91" alt="Wed May 18 2022 13:18:23 GMT-0700 (Pacific Daylight Time)">20:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">and the developer experience as speced kinda stinks </td></tr>
  <tr class="msg" id="L92"><td class="ts-cell"><a class="ts" href="#L92" alt="Wed May 18 2022 13:24:02 GMT-0700 (Pacific Daylight Time)">20:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">yeah it sucks real bad</td></tr>
  <tr class="msg" id="L93"><td class="ts-cell"><a class="ts" href="#L93" alt="Wed May 18 2022 13:24:36 GMT-0700 (Pacific Daylight Time)">20:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i chased a test failure on CI for an hour, it ended up just being "file not found" because we forgot to add the supporting <code>.mjs</code> files for some ShadowRealm import tests</td></tr>
  <tr class="msg" id="L94"><td class="ts-cell"><a class="ts" href="#L94" alt="Wed May 18 2022 13:24:42 GMT-0700 (Pacific Daylight Time)">20:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">because the error message was opaque</td></tr>
  <tr class="msg" id="L95"><td class="ts-cell"><a class="ts" href="#L95" alt="Wed May 18 2022 13:25:53 GMT-0700 (Pacific Daylight Time)">20:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">Yep. I've a couple similar stories. </td></tr>

</tbody></table></div></div></div>
</body></html>