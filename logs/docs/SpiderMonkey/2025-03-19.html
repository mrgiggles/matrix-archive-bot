<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2025-03-19</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2025-03-19<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2025-03-18" class="nav-link"><span>prev</span></a>
<a href="2025-03-20" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Mar 18 2025 22:05:58 GMT-0700 (Pacific Daylight Time)">05:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@mayankleoboy1:mozilla.org">mayankleoboy1</span>&gt;</div></td><td class="msg-cell">Is the 800ms time spent in 
TaskController #0 weird? : <a href="https://share.firefox.dev/4iEzTKV">https://share.firefox.dev/4iEzTKV</a></td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Mar 18 2025 22:09:19 GMT-0700 (Pacific Daylight Time)">05:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@mstange:mozilla.org">mstange</span>&gt;</div></td><td class="msg-cell">I'd say it's expected - the main thread is allocating lots of small things, so the GC will be poisoning lots of small things when it frees them</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Mar 18 2025 22:10:39 GMT-0700 (Pacific Daylight Time)">05:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@mayankleoboy1:mozilla.org">mayankleoboy1</span>&gt;</div></td><td class="msg-cell">Ok. We are faster than chrome anyway on this.</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue Mar 18 2025 23:56:51 GMT-0700 (Pacific Daylight Time)">06:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">There is an example lower down in file that I believe still works <a href="https://searchfox.org/mozilla-central/rev/0f5273b9b232a3daa0a710e851cbb24393d62845/js/public/UbiNode.h#983">https://searchfox.org/mozilla-central/rev/0f5273b9b232a3daa0a710e851cbb24393d62845/js/public/UbiNode.h#983</a></td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Mar 19 2025 01:40:18 GMT-0700 (Pacific Daylight Time)">08:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Also I think that poisoning might be Nightly-only</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Mar 19 2025 06:20:02 GMT-0700 (Pacific Daylight Time)">13:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><a href="https://searchfox.org/mozilla-central/rev/be3db2aef8d3916c891527794a2d5e2f2dc9fab1/js/src/builtin/TestingFunctions.cpp#7218">https://searchfox.org/mozilla-central/rev/be3db2aef8d3916c891527794a2d5e2f2dc9fab1/js/src/builtin/TestingFunctions.cpp#7218</a> is an example user. The description "convert a JSContext* to a ubi::Node" is a little deceptive in that comment, but I believe that initializing a rootList without passing in  any debuggees is the same thing.</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Mar 19 2025 06:20:14 GMT-0700 (Pacific Daylight Time)">13:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">what are you doing with it?</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Mar 19 2025 07:47:10 GMT-0700 (Pacific Daylight Time)">14:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">I did finally run this test: I can confirm on a threadripper I get 520ms for the slow version and 229 for the fast. </td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed Mar 19 2025 07:52:44 GMT-0700 (Pacific Daylight Time)">14:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Yeah, nbp saw the same thing</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed Mar 19 2025 07:53:28 GMT-0700 (Pacific Daylight Time)">14:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">We have data points for recent Intel (Raptor Lake), old intel (nbp's 7-year-old thinkpad), and AMD, and it was an issue for all three</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed Mar 19 2025 07:59:18 GMT-0700 (Pacific Daylight Time)">14:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@emilio:mozilla.org">emilio</span>&gt;</div></td><td class="msg-cell">That comes from 2012 it seems... Seems plausible back then it was faster?</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed Mar 19 2025 10:33:08 GMT-0700 (Pacific Daylight Time)">17:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sefeng:mozilla.org">sefeng</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">arai</span>: it looks like I still have a bug in my SCHEDULING_STATE_SLOT stuff..I now hit a <a href="https://treeherder.mozilla.org/jobs?repo=try&amp;revision=08cc631ee29b4c0dbae45eb9421b10cf58078d89&amp;selectedTaskRun=BPVBkaqtRnW5fR-IknxOrg.0">crash that only occurs on try on Windows</a>, if I commented out all my SCHEDULING_STATE_SLOT usage, it stops the crash</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed Mar 19 2025 10:33:28 GMT-0700 (Pacific Daylight Time)">17:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sefeng:mozilla.org">sefeng</span>&gt;</div></td><td class="msg-cell">unfortunately try doesn't provide me any crash info about this..</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed Mar 19 2025 11:05:58 GMT-0700 (Pacific Daylight Time)">18:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@asuth:mozilla.org">asuth</span>&gt;</div></td><td class="msg-cell">Is there any kind of weird internal flag or setting related to undefined that could make this reduction :gcp created at <a href="https://jsfiddle.net/tk1je739/">https://jsfiddle.net/tk1je739/</a> where undefineds go into IDB structured serialization but all the <code data-md="`">undefined</code>s come back out as <code data-md="`">{}</code>?  And in particular where it happens in Private Browsing Mode in a specific profile, but not normal browsing and not in PBM in a fresh profile?</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed Mar 19 2025 11:07:43 GMT-0700 (Pacific Daylight Time)">18:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@asuth:mozilla.org">asuth</span>&gt;</div></td><td class="msg-cell">hm, let me ask about web extensions again in case maybe something's just defining undefined.</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Wed Mar 19 2025 11:08:34 GMT-0700 (Pacific Daylight Time)">18:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell">For stuff sent over JS IPC? Possibly this mess: <a href="https://searchfox.org/mozilla-central/rev/be3db2aef8d3916c891527794a2d5e2f2dc9fab1/dom/base/nsFrameMessageManager.cpp#471-492">https://searchfox.org/mozilla-central/rev/be3db2aef8d3916c891527794a2d5e2f2dc9fab1/dom/base/nsFrameMessageManager.cpp#471-492</a></td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Wed Mar 19 2025 11:10:30 GMT-0700 (Pacific Daylight Time)">18:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@asuth:mozilla.org">asuth</span>&gt;</div></td><td class="msg-cell">so the test case is thankfully just pure IDB in content.</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Wed Mar 19 2025 11:10:53 GMT-0700 (Pacific Daylight Time)">18:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@asuth:mozilla.org">asuth</span>&gt;</div></td><td class="msg-cell">but yeah, that sometimes-JSON, sometimes-cloned is horrible</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Wed Mar 19 2025 11:16:12 GMT-0700 (Pacific Daylight Time)">18:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@asuth:mozilla.org">asuth</span>&gt;</div></td><td class="msg-cell">okay, it was an evil webextension</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Wed Mar 19 2025 12:13:27 GMT-0700 (Pacific Daylight Time)">19:13</a></td><td class="nick-cell"><div class="m-ov"><span class="nick nick-8" title="@sefeng:mozilla.org">sefeng</span></div></td><td class="msg-cell">wonder if I should observe the xpcom shutdown</td></tr>

</tbody></table></div></div></div>
</body></html>