<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2024-08-26</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2024-08-26<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2024-08-23" class="nav-link"><span>prev</span></a>
<a href="2024-08-27" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search SpiderMonkey">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Mon Aug 26 2024 05:27:21 GMT-0700 (Pacific Daylight Time)">12:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@romgrk:mozilla.org">romgrk</span>&gt;</div></td><td class="msg-cell">hello, I'm benchmarking hashing functions in JS and I've found SM to be substantially slower than V8 and JSC. I've been using <code>gjs</code> as a runtime, is there any chance gjs itself is slowing down the benchmark?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Mon Aug 26 2024 05:28:45 GMT-0700 (Pacific Daylight Time)">12:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@nchevobbe:mozilla.org">nchevobbe [on PTO - back on August 26]</span>&gt;</div></td><td class="msg-cell">we have some regressions on DevTools perf test (<a href="https://treeherder.mozilla.org/perfherder/alerts?id=1760&amp;hideDwnToInv=0">https://treeherder.mozilla.org/perfherder/alerts?id=1760&amp;hideDwnToInv=0</a>), and in the pushlog, <a href="https://hg.mozilla.org/integration/autoland/rev/4f1411f1beb61bdc40b858a03cfe82c2ea56288f">https://hg.mozilla.org/integration/autoland/rev/4f1411f1beb61bdc40b858a03cfe82c2ea56288f</a> seems like a good candidate. I don't have access to the bug, so I'm not sure what it's about, but maybe <span class="nick-4">iain</span> / <span class="nick-10">jandem</span> have an idea ? (<code>source-map.allGeneratedPositionsFor.DAMP</code> doesn't involve the whole browser, it's only testing our sourcemap library, so it's usually a good indicator that the regression occured in spidermonkey)</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Mon Aug 26 2024 05:37:21 GMT-0700 (Pacific Daylight Time)">12:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-14">nchevobbe</span>: mind filing a bug for this? I think the problem is that devtools is using dynamic scope chains that behave like <code>with</code>, and name lookups will now be a bit slower</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Mon Aug 26 2024 05:38:47 GMT-0700 (Pacific Daylight Time)">12:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell">sure, here it is <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1914895">https://bugzilla.mozilla.org/show_bug.cgi?id=1914895</a></td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Mon Aug 26 2024 05:40:00 GMT-0700 (Pacific Daylight Time)">12:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell">what's dynamic scope chain by the way?</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Mon Aug 26 2024 05:48:50 GMT-0700 (Pacific Daylight Time)">12:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">that's related to the perf issue here: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=793345">https://bugzilla.mozilla.org/show_bug.cgi?id=793345</a></td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Mon Aug 26 2024 05:50:38 GMT-0700 (Pacific Daylight Time)">12:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">I commented on the bug. I'm not sure if this is the problem but it could be</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Mon Aug 26 2024 05:51:02 GMT-0700 (Pacific Daylight Time)">12:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell">oh, I wouldn't expect the sourcemap test to use the Debugger API, but I don't know this code very well</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Mon Aug 26 2024 05:51:46 GMT-0700 (Pacific Daylight Time)">12:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">yeah I just wanted to say, maybe the underlying issue is that we're using weird environment chains where we shouldn't..</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Mon Aug 26 2024 05:52:34 GMT-0700 (Pacific Daylight Time)">12:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell">okay, thanks for your input. I'll also double check that the regression are indeed introduced by the SM patch</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Mon Aug 26 2024 06:01:53 GMT-0700 (Pacific Daylight Time)">13:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-11">romgrk</span>: the fastest way to check if it's related to GJS is to put the JS code in an HTML file and measure it in Firefox</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Mon Aug 26 2024 10:09:58 GMT-0700 (Pacific Daylight Time)">17:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@bvisness:mozilla.org">bvisness</span>&gt;</div></td><td class="msg-cell">do we run mips and risc-v builds in try? or is that just not part of the sm-all preset that I'm using</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Mon Aug 26 2024 10:12:35 GMT-0700 (Pacific Daylight Time)">17:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">afaik, we don't run them</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Mon Aug 26 2024 10:16:27 GMT-0700 (Pacific Daylight Time)">17:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">We don't run them in try. mips32 is dead as a doornail and just waiting for somebody to find time to delete it. Mips64, loong64 and risc-v are all supported by external contributors. If you write a patch that requires per-architecture work and it's easy to write the patches for our unsupported architectures, you can go ahead and do so, but if you don't then an external contributor will come along pretty quickly and write a patch to do so.</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Mon Aug 26 2024 10:18:00 GMT-0700 (Pacific Daylight Time)">17:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">For example, anba landed bug 1913413, and then four days later bug 1914537 showed up in my review queue.</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Mon Aug 26 2024 10:39:40 GMT-0700 (Pacific Daylight Time)">17:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@debadree25:mozilla.org">debadree25</span>&gt;</div></td><td class="msg-cell">what happened to that nice bot which read bug numbers and sent the bug link</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Mon Aug 26 2024 11:00:41 GMT-0700 (Pacific Daylight Time)">18:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Hmm, that's an interesting question. <span class="nick-12">sfink</span>, were you in charge of botzilla?</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Mon Aug 26 2024 11:02:44 GMT-0700 (Pacific Daylight Time)">18:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">no, that's bbouvier's. But I thought there was another bot doing that now.</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Mon Aug 26 2024 11:06:42 GMT-0700 (Pacific Daylight Time)">18:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">but the last one I see here <em>was</em> done by botzilla. Aw, what happened to it?</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Mon Aug 26 2024 11:19:27 GMT-0700 (Pacific Daylight Time)">18:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">(I'm asking bnjbvr.)</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Mon Aug 26 2024 12:00:21 GMT-0700 (Pacific Daylight Time)">19:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">jonco</span>: for the Worker iGC scheduling, I need to be able to set the budget for the initial GC slice. On the mainthread, I did this by adding a callback for computing the schedule. I can use the same mechanism on the Worker, but it's kind of gross (no more so than the mainthread, but still).</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Mon Aug 26 2024 12:02:08 GMT-0700 (Pacific Daylight Time)">19:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I was thinking maybe I should extend GCOptions to have a "FastStart" bit, which would yield immediately after preparing the GC. Then I could use existing APIs to kick the GC off, and then set a budget for the first slice using the other existing APIs.</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Mon Aug 26 2024 12:03:57 GMT-0700 (Pacific Daylight Time)">19:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">This would require handling GCOptions as more than a set of 3 discrete values, but it seems easy enough; I have a patch for that. It would also require passing GCOptions into eg <code>JS_MaybeGC()</code>. Which shouldn't be too bad, but it's starting to feel like I should check with you to see if you need to tell me I'm overengineering again. ;-)</td></tr>

</tbody></table></div></div></div>
</body></html>