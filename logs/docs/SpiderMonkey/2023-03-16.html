<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2023-03-16</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2023-03-16<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2023-03-15" class="nav-link"><span>prev</span></a>
<a href="2023-03-17" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Thu Mar 16 2023 01:04:01 GMT-0700 (Pacific Daylight Time)">08:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-13">davidj361</span>: you can get the callee's <code>JSFunction</code> inside the native function with <code>args.callee()</code>. Is that what you mean?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Thu Mar 16 2023 02:22:28 GMT-0700 (Pacific Daylight Time)">09:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell">note that gdoc now has code blocks, that would be helpful for snippets in the tc39 meeting doc :)</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Thu Mar 16 2023 04:15:36 GMT-0700 (Pacific Daylight Time)">11:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dminor:mozilla.org">dminor</span>&gt;</div></td><td class="msg-cell">I missed this earlier, but the spidermonkey-reviewers review group has been created: <a href="https://phabricator.services.mozilla.com/project/profile/173/">https://phabricator.services.mozilla.com/project/profile/173/</a>. We'd want to use this for extremely large reviews (e.g. Temporal) as well as for people external to the team who don't necessarily know who to ask for review.</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Thu Mar 16 2023 05:54:30 GMT-0700 (Pacific Daylight Time)">12:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">Can I just check if <code>ModuleLink</code> does the same thing that <code>ModuleInstantiate</code> used to do?</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Thu Mar 16 2023 06:29:32 GMT-0700 (Pacific Daylight Time)">13:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@ms2ger:igalia.com">Ms2ger</span>&gt;</div></td><td class="msg-cell">Yeah, that got renamed in the spec</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Thu Mar 16 2023 07:15:28 GMT-0700 (Pacific Daylight Time)">14:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@bnjbvr:delire.party">bnjbvr</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">mstange</span>: howdy! so it turns out implementing the old perf map support was easy enough and sufficient for our wasmtime embedding. Is there a way to let <code>samply</code> know about the perf mapping file? (it doesn't seem to grab it automatically)</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Thu Mar 16 2023 07:17:56 GMT-0700 (Pacific Daylight Time)">14:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@mstange:mozilla.org">mstange</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">bnjbvr</span>: As of today, samply supports neither <a href="http://perf.map">perf.map</a> nor jitdump. It only supports <a href="http://perf.data">perf.data</a> files which have have been processed by <code>perf inject --jit</code>, because that makes it look like JIT code came from regular binaries, and samply supports regular binaries.</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Thu Mar 16 2023 07:19:15 GMT-0700 (Pacific Daylight Time)">14:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@mstange:mozilla.org">mstange</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">bnjbvr</span>: I've only looked at jitdump so far, not at <a href="http://perf.map">perf.map</a>, so I'm not sure if <code>perf inject --jit</code> does anything for <a href="http://perf.map">perf.map</a> files or whether <a href="http://perf.map">perf.map</a> files are consulted at a different stage of the pipeline</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Thu Mar 16 2023 07:23:19 GMT-0700 (Pacific Daylight Time)">14:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@bnjbvr:delire.party">bnjbvr</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">mstange</span>: ok, yeah <code><a href="http://perf.map">perf.map</a></code> files are so dumb (lines of <code>{ADDR_BASE} {CODE_LEN} {SYMBOL}</code>) that it wouldn't be too hard supporting them manually. <code>perf report</code>/<code>hotspot</code> automatically use those</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Thu Mar 16 2023 07:23:54 GMT-0700 (Pacific Daylight Time)">14:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@mstange:mozilla.org">mstange</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">bnjbvr</span>: ok great, I'll look into that after I've made jitdump work</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Thu Mar 16 2023 07:24:29 GMT-0700 (Pacific Daylight Time)">14:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@bnjbvr:delire.party">bnjbvr</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">mstange</span>: i could actually implement this, I've found <code>process.jit_functions.insert</code> which seems to be the only thing to call ðŸ‘€</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Thu Mar 16 2023 07:24:59 GMT-0700 (Pacific Daylight Time)">14:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell">any idea if <a href="https://developer.mozilla.org/en/SpiderMonkey/Parser_API">https://developer.mozilla.org/en/SpiderMonkey/Parser_API</a> was moved somewhere ? mdn page is down</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Thu Mar 16 2023 07:26:45 GMT-0700 (Pacific Daylight Time)">14:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@mstange:mozilla.org">mstange</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">bnjbvr</span>: ok I'm going to merge the prepend-jit-functions branch to main first, push that, and then you can make your changes</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Thu Mar 16 2023 07:27:21 GMT-0700 (Pacific Daylight Time)">14:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@bnjbvr:delire.party">bnjbvr</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">mstange</span>: great, cheers</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Thu Mar 16 2023 07:28:17 GMT-0700 (Pacific Daylight Time)">14:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@mstange:mozilla.org">mstange</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">bnjbvr</span>: it's pushed</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Thu Mar 16 2023 07:28:41 GMT-0700 (Pacific Daylight Time)">14:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> any idea if <a href="https://developer.mozilla.org/en/SpiderMonkey/Parser_API">https://developer.mozilla.org/en/SpiderMonkey/Parser_API</a> was moved somewhere ? mdn page is down</blockquote></mx-reply>I think all of the SpiderMonkey pages on MDN were taken down</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Thu Mar 16 2023 07:29:37 GMT-0700 (Pacific Daylight Time)">14:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@ms2ger:igalia.com">Ms2ger</span>&gt;</div></td><td class="msg-cell">Maybe there's <a href="https://spidermonkey.dev/docs/">https://spidermonkey.dev/docs/</a></td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Thu Mar 16 2023 07:30:09 GMT-0700 (Pacific Daylight Time)">14:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@ms2ger:igalia.com">Ms2ger</span>&gt;</div></td><td class="msg-cell">Or <a href="https://github.com/mdn/archived-content">https://github.com/mdn/archived-content</a></td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Thu Mar 16 2023 07:32:24 GMT-0700 (Pacific Daylight Time)">14:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><span class="nick-14">nchevobbe</span>: <a href="https://mdn-archive.mossop.dev/en-us/mozilla/projects/spidermonkey/parser_api">https://mdn-archive.mossop.dev/en-us/mozilla/projects/spidermonkey/parser_api</a> works</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Thu Mar 16 2023 07:32:42 GMT-0700 (Pacific Daylight Time)">14:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell">great, thanks all</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Thu Mar 16 2023 07:33:48 GMT-0700 (Pacific Daylight Time)">14:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">There's been divergence I'm sure, but you may also find <a href="https://docs.esprima.org/en/latest/syntax-tree-format.html">https://docs.esprima.org/en/latest/syntax-tree-format.html</a> as helpfil, their tree format was related to the older versions of Reflect.parse</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Thu Mar 16 2023 07:36:33 GMT-0700 (Pacific Daylight Time)">14:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">random thought, maybe a lot of the spidermonkey-embedding-examples docs could be on <a href="http://spidermonkey.dev">spidermonkey.dev</a>?</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Thu Mar 16 2023 07:37:08 GMT-0700 (Pacific Daylight Time)">14:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">github file viewing isn't exactly the most intuitive or convenient</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Thu Mar 16 2023 09:28:28 GMT-0700 (Pacific Daylight Time)">16:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">Does anyone know how to go about invoking an object's super constructor from Spidermonkey?</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Thu Mar 16 2023 10:03:57 GMT-0700 (Pacific Daylight Time)">17:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-13">davidj361</span>: you can get the callee's <code>JSFunction</code> inside the native function with <code>args.callee()</code>. Is that what you mean?</blockquote></mx-reply>Thanks, no idea where I would be without your help. Is it expected to just read the entire code base to basically know all this?</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Thu Mar 16 2023 12:54:14 GMT-0700 (Pacific Daylight Time)">19:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">Are these basically the same: <code>JS::GetMaybePtrFromReservedSlot</code> and <code>js::GetFunctionNativeReserved</code>? If so, why so many duplicate functions?</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Thu Mar 16 2023 14:33:58 GMT-0700 (Pacific Daylight Time)">21:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">the convention is that <code>JS::</code> is public API, <code>js::</code> is internal.</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Thu Mar 16 2023 14:34:48 GMT-0700 (Pacific Daylight Time)">21:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">(and <code>JS_</code> is "public and we've been too lazy to rename it")</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Thu Mar 16 2023 14:36:47 GMT-0700 (Pacific Daylight Time)">21:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Thanks, no idea where I would be without your help. Is it expected to just read the entire code base to basically know all this?</blockquote></mx-reply>The situation is not great for non-Firefox embeddings. I think the idea is: read the docs. But the docs are very incomplete, so read <a href="http://spidermonkey.dev">spidermonkey.dev</a>. But that's also very incomplete, so ask here.</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Thu Mar 16 2023 14:38:17 GMT-0700 (Pacific Daylight Time)">21:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">as in, we don't currently expect people to be all that successful at embedding the JSAPI without asking for at least some amount here. We'd all like it to be less necessary, but are making fairly slow progress on that. <a href="http://spidermonkey.dev">spidermonkey.dev</a> is the fastest improving piece.</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Thu Mar 16 2023 14:38:26 GMT-0700 (Pacific Daylight Time)">21:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell">I'm still a little sad my idea to use "Js" for friend API functions was (rightly) rejected.</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Thu Mar 16 2023 14:39:05 GMT-0700 (Pacific Daylight Time)">21:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">maybe if you augmented it with a convincing justification for <code>jS</code> as well?</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Thu Mar 16 2023 14:39:22 GMT-0700 (Pacific Daylight Time)">21:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">callbacks?</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Thu Mar 16 2023 14:39:43 GMT-0700 (Pacific Daylight Time)">21:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell">jS is probably better than Js, honestly, because it jumps out at you.</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Thu Mar 16 2023 14:44:41 GMT-0700 (Pacific Daylight Time)">21:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">mccr8: so can you close bug 720879 now? Thank you very much for <code>xpcom/docs/cc-macros.rst</code>!</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Thu Mar 16 2023 14:44:42 GMT-0700 (Pacific Daylight Time)">21:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/720879">https://bugzil.la/720879</a> â€” NEW (mccr8) â€” Document the cycle collector macros</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Thu Mar 16 2023 14:46:24 GMT-0700 (Pacific Daylight Time)">21:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> mccr8: so can you close bug 720879 now? Thank you very much for <code>xpcom/docs/cc-macros.rst</code>!</blockquote></mx-reply>Well, I still haven't really addressed the original motivation for that bug which I think was the skippable stuff.  Which I'm 90% sure that Olli and possibly me are still the only ones who really understand them.</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Thu Mar 16 2023 14:47:05 GMT-0700 (Pacific Daylight Time)">21:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">ah, fair</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Thu Mar 16 2023 14:47:35 GMT-0700 (Pacific Daylight Time)">21:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell">Yeah, I should have documented the basic stuff earlier. Given that I had to copy off of existing macro stuff any time I wanted to use them, I'm sure it was pretty difficult for anybody else.</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Thu Mar 16 2023 14:48:38 GMT-0700 (Pacific Daylight Time)">21:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I thought the "cut &amp; paste some random crap and ask mccr8 for review to fix it" workflow worked out pretty ok</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Thu Mar 16 2023 14:48:41 GMT-0700 (Pacific Daylight Time)">21:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell">We should really also document the CC internals but that's even lower on the priority list.</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Thu Mar 16 2023 14:48:53 GMT-0700 (Pacific Daylight Time)">21:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I thought the "cut &amp; paste some random crap and ask mccr8 for review to fix it" workflow worked out pretty ok</blockquote></mx-reply>Yeah but I had to go and refigure them out every time.</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Thu Mar 16 2023 14:49:12 GMT-0700 (Pacific Daylight Time)">21:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">so say we all</td></tr>

</tbody></table></div></div></div>
</body></html>