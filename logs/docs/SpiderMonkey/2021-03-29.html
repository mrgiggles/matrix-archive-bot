<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2021-03-29</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2021-03-29<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2021-03-28" class="nav-link"><span>prev</span></a>
<a href="2021-03-30" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search SpiderMonkey">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Sun Mar 28 2021 23:19:24 GMT-0700 (Pacific Daylight Time)">06:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@18f:mozilla.org">18f</span>&gt;</div></td><td class="msg-cell">Hey, Can I declare that if I run x64, this will be JS_PUNBOX64</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Sun Mar 28 2021 23:19:47 GMT-0700 (Pacific Daylight Time)">06:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@18f:mozilla.org">18f</span>&gt;</div></td><td class="msg-cell">and If I run spidermonkey on x86, It will be JS_NUNBOX32?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Sun Mar 28 2021 23:41:34 GMT-0700 (Pacific Daylight Time)">06:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">18f</span>: Yes</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Sun Mar 28 2021 23:41:59 GMT-0700 (Pacific Daylight Time)">06:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Similarly, arm32 is JS_NUNBOX32 and arm64 is JS_PUNBOX64</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Mon Mar 29 2021 00:04:21 GMT-0700 (Pacific Daylight Time)">07:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@18f:mozilla.org">18f</span>&gt;</div></td><td class="msg-cell">ok</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Mon Mar 29 2021 00:04:23 GMT-0700 (Pacific Daylight Time)">07:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@18f:mozilla.org">18f</span>&gt;</div></td><td class="msg-cell">thanks</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Mon Mar 29 2021 00:18:30 GMT-0700 (Pacific Daylight Time)">07:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">(<span class="nick-4">18f</span>: if you are trying to understand our Value representation, <a href="https://searchfox.org/mozilla-central/rev/d58860eb739af613774c942c3bb61754123e449b/js/src/gdb/mozilla/jsval.py#16-74">this comment</a> might be the best introduction)</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Mon Mar 29 2021 00:19:18 GMT-0700 (Pacific Daylight Time)">07:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@18f:mozilla.org">18f</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> (<span class="nick-4">18f</span>: if you are trying to understand our Value representation, <a href="https://searchfox.org/mozilla-central/rev/d58860eb739af613774c942c3bb61754123e449b/js/src/gdb/mozilla/jsval.py#16-74">this comment</a> might be the best introduction)</blockquote></mx-reply>cool</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Mon Mar 29 2021 00:19:26 GMT-0700 (Pacific Daylight Time)">07:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@18f:mozilla.org">18f</span>&gt;</div></td><td class="msg-cell">I try to understand another thing</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Mon Mar 29 2021 00:19:36 GMT-0700 (Pacific Daylight Time)">07:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@18f:mozilla.org">18f</span>&gt;</div></td><td class="msg-cell">like MInterruptCheck How work</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Mon Mar 29 2021 00:22:24 GMT-0700 (Pacific Daylight Time)">07:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">18f</span>: <a href="https://searchfox.org/mozilla-central/source/js/src/vm/JSContext.h#856-874">This comment may help</a></td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Mon Mar 29 2021 00:23:13 GMT-0700 (Pacific Daylight Time)">07:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@18f:mozilla.org">18f</span>&gt;</div></td><td class="msg-cell">Thanks, It's so interesting.</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Mon Mar 29 2021 04:46:15 GMT-0700 (Pacific Daylight Time)">11:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@leveryd:mozilla.org">leveryd</span>&gt;</div></td><td class="msg-cell">where is the latest documention? i see below url is old and not actively maintained.</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Mon Mar 29 2021 05:08:42 GMT-0700 (Pacific Daylight Time)">12:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">doesn't this message appear automatically if the page did not received any modification in a year?</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Mon Mar 29 2021 05:17:09 GMT-0700 (Pacific Daylight Time)">12:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@leveryd:mozilla.org">leveryd</span>&gt;</div></td><td class="msg-cell">JS::AutoValueArray  class does not exist in source code really (firefox-78.1.0). is it discard ?</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Mon Mar 29 2021 05:18:55 GMT-0700 (Pacific Daylight Time)">12:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">Looking at the commit log … <code>Bug 1634435 - Rename AutoValueArray to RootedValueArray</code></td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Mon Mar 29 2021 05:18:56 GMT-0700 (Pacific Daylight Time)">12:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1634435">https://bugzil.la/1634435</a> — RESOLVED (jonco) — Remove some AutoGCRooter kinds</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Mon Mar 29 2021 05:48:54 GMT-0700 (Pacific Daylight Time)">12:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">also mentioned on <a href="https://github.com/mozilla-spidermonkey/spidermonkey-embedding-examples/blob/esr78/docs/Migration%20Guide.md">https://github.com/mozilla-spidermonkey/spidermonkey-embedding-examples/blob/esr78/docs/Migration%20Guide.md</a></td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Mon Mar 29 2021 05:53:00 GMT-0700 (Pacific Daylight Time)">12:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@leveryd:mozilla.org">leveryd</span>&gt;</div></td><td class="msg-cell">thanks for your guide.maybe add those information about "rename AutoValueArray to RootedValueArray" on the <a href="http://mozilla.net">mozilla.net</a> page is good, i think it will help other beginner like me.</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Mon Mar 29 2021 06:22:38 GMT-0700 (Pacific Daylight Time)">13:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">If you are looking for information about SpiderMonkey, the recommended starting point is <code><a href="https://spidermonkey.dev/">https://spidermonkey.dev/</a></code> The pages on MDN will be removed at some point since MDN intends to focus on the web for everyone instead of mozilla implementation details.</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Mon Mar 29 2021 06:23:14 GMT-0700 (Pacific Daylight Time)">13:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">(we probably should like the migration guide directly from <a href="http://spidermonkey.dev">spidermonkey.dev</a> since it is a common question..)</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Mon Mar 29 2021 07:16:15 GMT-0700 (Pacific Daylight Time)">14:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">Good morning!</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Mon Mar 29 2021 07:17:14 GMT-0700 (Pacific Daylight Time)">14:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">My boss seems to think that there's a more direct/efficient way to call a JS function defined in the current interpreter context than building a script as a straing and evaluating it.</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Mon Mar 29 2021 07:18:40 GMT-0700 (Pacific Daylight Time)">14:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">I've been trolling through JSAPI (we still build with 1.8.5) because the online pages are spotty.  But I also support a newer version of Spidermonkey (JS60 for now) and it doesn't look like that's possible.</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Mon Mar 29 2021 07:23:36 GMT-0700 (Pacific Daylight Time)">14:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@awingo:igalia.com">wingo</span>&gt;</div></td><td class="msg-cell">afaiu string is the best option -- AST isn't public api</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Mon Mar 29 2021 07:23:46 GMT-0700 (Pacific Daylight Time)">14:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">chaircrusher</span>: Would any of these work for you? <a href="https://searchfox.org/mozilla-central/source/js/src/jsapi.h#1420-1438">https://searchfox.org/mozilla-central/source/js/src/jsapi.h#1420-1438</a></td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Mon Mar 29 2021 07:24:11 GMT-0700 (Pacific Daylight Time)">14:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@awingo:igalia.com">wingo</span>&gt;</div></td><td class="msg-cell">aah call, not define</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Mon Mar 29 2021 07:24:22 GMT-0700 (Pacific Daylight Time)">14:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">I just found JS_CallFunction.</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Mon Mar 29 2021 07:24:34 GMT-0700 (Pacific Daylight Time)">14:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">It looks like that might work</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Mon Mar 29 2021 07:24:38 GMT-0700 (Pacific Daylight Time)">14:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@awingo:igalia.com">wingo</span>&gt;</div></td><td class="msg-cell">good thing nbp is here to read properly :)</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Mon Mar 29 2021 07:25:06 GMT-0700 (Pacific Daylight Time)">14:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell"><span class="nick-9">wingo</span>: the odds are low, but sometime I manage to pick the right words.</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Mon Mar 29 2021 07:26:44 GMT-0700 (Pacific Daylight Time)">14:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">SO - How would someone query an interpreter instance for a JSFunction * object corresponding to an already defined/compiled function? </td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Mon Mar 29 2021 07:29:10 GMT-0700 (Pacific Daylight Time)">14:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">Would these tests help? <a href="https://searchfox.org/mozilla-central/source/js/src/jsapi-tests/testProfileStrings.cpp#89">https://searchfox.org/mozilla-central/source/js/src/jsapi-tests/testProfileStrings.cpp#89</a></td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Mon Mar 29 2021 07:29:47 GMT-0700 (Pacific Daylight Time)">14:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">The use case is that we have stuff implemented in JS, and we want to call it the most efficient way possible.  That JS_CallFunction stuff looks like something I could do but it needs  a JSFunction *</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Mon Mar 29 2021 07:30:04 GMT-0700 (Pacific Daylight Time)">14:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">@nbp thanks will look at that.</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Mon Mar 29 2021 07:31:25 GMT-0700 (Pacific Daylight Time)">14:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">those tests appear to do exactly what we'd like.</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Mon Mar 29 2021 07:32:21 GMT-0700 (Pacific Daylight Time)">14:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">Is there a way to get the JSFunction *, given the name of the function?</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Mon Mar 29 2021 07:32:26 GMT-0700 (Pacific Daylight Time)">14:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell"><a href="https://searchfox.org/mozilla-central/source/js/src/jsapi-tests/testChromeBuffer.cpp#108-116">https://searchfox.org/mozilla-central/source/js/src/jsapi-tests/testChromeBuffer.cpp#108-116</a> This one uses <code>JS_CallFunction</code> after compiling the function.</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Mon Mar 29 2021 07:33:42 GMT-0700 (Pacific Daylight Time)">14:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">I suggest to look how <code>JS_CallFunctionName</code> is implemented, and factor everything before the <code>Call</code></td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Mon Mar 29 2021 07:33:58 GMT-0700 (Pacific Daylight Time)">14:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">OK</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Mon Mar 29 2021 07:34:20 GMT-0700 (Pacific Daylight Time)">14:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">This forum is as helpful as the online documentation is confusing and incomplete ;-)</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Mon Mar 29 2021 07:36:52 GMT-0700 (Pacific Daylight Time)">14:36</a></td><td class="nick-cell"><div class="m-ov"><span class="nick nick-2" title="@nbp:mozilla.org">nbp</span></div></td><td class="msg-cell">always read the code, even if there is some documentation.</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Mon Mar 29 2021 07:51:06 GMT-0700 (Pacific Daylight Time)">14:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">JS_CallFunctionName finds the function with private functions (js_Atomize, js_GetMethod, ExternalInvoke in 1.8.5) - is there anything exposed in JSAPI for that?</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Mon Mar 29 2021 08:18:20 GMT-0700 (Pacific Daylight Time)">15:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell"><a href="https://searchfox.org/mozilla-central/source/js/src/jsapi.h#1248-1250">JS_GetProperty</a>, maybe?</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Mon Mar 29 2021 08:20:06 GMT-0700 (Pacific Daylight Time)">15:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">Worth a try</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Mon Mar 29 2021 08:20:57 GMT-0700 (Pacific Daylight Time)">15:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">All globals are properties of global, right?</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Mon Mar 29 2021 08:23:09 GMT-0700 (Pacific Daylight Time)">15:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">yes</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Mon Mar 29 2021 08:52:51 GMT-0700 (Pacific Daylight Time)">15:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pingu:mozilla.org">pingu</span>&gt;</div></td><td class="msg-cell">Anyone know if it would be possible to intercept the result of a Call or FunCall opcode in interpreter.cpp, was considering attempting to intercept Return but that could be triggered by a function before the one I need</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Mon Mar 29 2021 09:11:23 GMT-0700 (Pacific Daylight Time)">16:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">The handling of call is either a <a href="https://searchfox.org/mozilla-central/rev/d58860eb739af613774c942c3bb61754123e449b/js/src/vm/Interpreter.cpp#3229-3247">slow-path</a> that would be straightforward to catch, otherwise it will reuse the C++ function call, so you'd need to check Return</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Mon Mar 29 2021 09:14:32 GMT-0700 (Pacific Daylight Time)">16:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">If you are doing this in a debugger you might be able to set a memory watch on the stack memory where the return value will be written to</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Mon Mar 29 2021 09:15:18 GMT-0700 (Pacific Daylight Time)">16:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell"><code>InterpreterFrame::rval_</code>. Doing this would avoid being mislead by the other function calls that happen. <span class="nick-3">pingu</span></td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Mon Mar 29 2021 09:36:49 GMT-0700 (Pacific Daylight Time)">16:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pingu:mozilla.org">pingu</span>&gt;</div></td><td class="msg-cell">not a slow-pathy unfourtanetly but hooking the stack memory is a great idea, thanks for the help <span class="nick-15">tcampbell</span> 😃</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Mon Mar 29 2021 09:37:34 GMT-0700 (Pacific Daylight Time)">16:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">If you are on linux, we also recommend <a href="https://rr-project.org/">rr</a> as debugger for this sort of stuff because you can go backwards or forwards in time.</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Mon Mar 29 2021 09:44:45 GMT-0700 (Pacific Daylight Time)">16:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell">Folks, I would like to know if I can interrogate the JS engine to find "pending" things, i.e., Promises that have not yet settled/resolved, tasks in the task queue, etc.</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Mon Mar 29 2021 09:45:36 GMT-0700 (Pacific Daylight Time)">16:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">nalexander</span>: that currently all lives in DOM land</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Mon Mar 29 2021 09:45:41 GMT-0700 (Pacific Daylight Time)">16:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell">My use case is pretty standard: I think there's some asynchronous activity that's not being waited on, and I'd like to get the engine to tell me things that it knows about.  I expect my final solution will be to actually wait for those things, not to wait until the engine reaches quiescence.</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Mon Mar 29 2021 09:45:49 GMT-0700 (Pacific Daylight Time)">16:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">tcampbell</span>: oh.  That's not what I expected.</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Mon Mar 29 2021 09:46:15 GMT-0700 (Pacific Daylight Time)">16:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">(which isn't to say they own the problem, just the queues..)</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Mon Mar 29 2021 09:46:25 GMT-0700 (Pacific Daylight Time)">16:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">tcampbell</span>: my use case is a bunch of privileged (chrome) JS, i.e., JSMs.  That's probably below the level the DOM knows about, yes?</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Mon Mar 29 2021 09:46:49 GMT-0700 (Pacific Daylight Time)">16:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">tcampbell</span>: but for my own education, can you suggest some keywords to start searching/reading?</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Mon Mar 29 2021 09:47:08 GMT-0700 (Pacific Daylight Time)">16:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">just trying to work through searchfox myself now..</td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Mon Mar 29 2021 09:48:14 GMT-0700 (Pacific Daylight Time)">16:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">by "DOM", I mostly mean <code>/dom</code> which is where things like ScriptLoader live</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Mon Mar 29 2021 09:48:19 GMT-0700 (Pacific Daylight Time)">16:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">nalexander</span>: I am starting here.. <a href="https://searchfox.org/mozilla-central/source/xpcom/base/CycleCollectedJSContext.cpp#383">https://searchfox.org/mozilla-central/source/xpcom/base/CycleCollectedJSContext.cpp#383</a></td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Mon Mar 29 2021 09:49:01 GMT-0700 (Pacific Daylight Time)">16:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">I'm trying to remember where something like an unresolved promise lives..</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Mon Mar 29 2021 09:49:09 GMT-0700 (Pacific Daylight Time)">16:49</a></td><td class="nick-cell"><div class="m-ov"><span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span></div></td><td class="msg-cell">hopes someone jumps in with a smarter answer..</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Mon Mar 29 2021 09:49:44 GMT-0700 (Pacific Daylight Time)">16:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">I was going to suggest looking at subclasses of JS::JobQueue (and <a href="https://searchfox.org/mozilla-central/search?q=symbol:_ZN2JS8JobQueue7runJobsEP9JSContext&amp;redirect=false">runJobs implementations</a>)</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Mon Mar 29 2021 09:49:44 GMT-0700 (Pacific Daylight Time)">16:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">tcampbell</span>: hmm, JSMs are loaded with <a href="https://searchfox.org/mozilla-central/source/js/xpconnect/loader/mozJSComponentLoader.cpp">https://searchfox.org/mozilla-central/source/js/xpconnect/loader/mozJSComponentLoader.cpp</a>; that's below <code>ScriptLoader</code>, I think.</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Mon Mar 29 2021 09:50:07 GMT-0700 (Pacific Daylight Time)">16:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">yeah, JSMs use a different scriptloader. (beside, rather than below)</td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Mon Mar 29 2021 09:50:41 GMT-0700 (Pacific Daylight Time)">16:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">tcampbell</span>: re: beside, duly noted.</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Mon Mar 29 2021 09:50:54 GMT-0700 (Pacific Daylight Time)">16:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">the only related thing I know of is <a href="https://searchfox.org/mozilla-central/source/xpcom/base/CycleCollectedJSContext.cpp#456-470">where the microtask queue is processed</a></td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Mon Mar 29 2021 09:51:09 GMT-0700 (Pacific Daylight Time)">16:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">(I make the distinction because there is unfortunately no single source of truth)</td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Mon Mar 29 2021 09:53:00 GMT-0700 (Pacific Daylight Time)">16:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">We aspire to have better answers here, but you'll need to have some patience with our clunky digging around since historically dom::ScriptLoader and xpconnect were other groups (which is silly and we are improving situation)</td></tr>
  <tr class="msg" id="L72"><td class="ts-cell"><a class="ts" href="#L72" alt="Mon Mar 29 2021 09:53:21 GMT-0700 (Pacific Daylight Time)">16:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell">Mmm, I can tell this is going to be an interesting and enlightening goose chase :)</td></tr>
  <tr class="msg" id="L73"><td class="ts-cell"><a class="ts" href="#L73" alt="Mon Mar 29 2021 09:53:32 GMT-0700 (Pacific Daylight Time)">16:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell"><p>Hello everyone, quick question to make sure I'm not misunderstanding something: SpiderMonkey has one JS-executing thread per JSRuntime. Inside a given runtime (&amp; context), there can be several Compartments. Inside these compartments can be several Realms. (am ignoring zones here).<br>Is this correct:</p>
<ul>
<li>Passing data between runtimes needs structured clones</li>
<li>Passing data between compartments is OK/transparent to the code, but crosscompartmentwrappers are created (not sure what those do?)</li>
<li>Passing data between realms is OK/transparent, and needs no wrappers?</li>
</ul>
</td></tr>
  <tr class="msg" id="L74"><td class="ts-cell"><a class="ts" href="#L74" alt="Mon Mar 29 2021 09:53:36 GMT-0700 (Pacific Daylight Time)">16:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">tcampbell</span>: I have nothing but patience!  (And appreciation for being able to ask the experts.)</td></tr>
  <tr class="msg" id="L75"><td class="ts-cell"><a class="ts" href="#L75" alt="Mon Mar 29 2021 09:54:15 GMT-0700 (Pacific Daylight Time)">16:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">team: how does the unhandled-rejections logic work?</td></tr>
  <tr class="msg" id="L76"><td class="ts-cell"><a class="ts" href="#L76" alt="Mon Mar 29 2021 09:54:51 GMT-0700 (Pacific Daylight Time)">16:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">that's the stuff that <span class="nick-15">arai</span> implemented?</td></tr>
  <tr class="msg" id="L77"><td class="ts-cell"><a class="ts" href="#L77" alt="Mon Mar 29 2021 09:55:00 GMT-0700 (Pacific Daylight Time)">16:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">I think so?</td></tr>
  <tr class="msg" id="L78"><td class="ts-cell"><a class="ts" href="#L78" alt="Mon Mar 29 2021 09:56:29 GMT-0700 (Pacific Daylight Time)">16:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">wraitii</span>: yes, that's all correct, with minor caveats. The cross-compartment wrappers are because compartments are a security boundary, and so <em>all</em> cross-compartment access has to be done in a way that can be checked and revoked according to the permissions model. They form a membrane between compartments.</td></tr>
  <tr class="msg" id="L79"><td class="ts-cell"><a class="ts" href="#L79" alt="Mon Mar 29 2021 09:56:58 GMT-0700 (Pacific Daylight Time)">16:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">or at least, it's correct if by "transparent to the code", you mean JS code. Things need to be manually wrapped in C++.</td></tr>
  <tr class="msg" id="L80"><td class="ts-cell"><a class="ts" href="#L80" alt="Mon Mar 29 2021 09:57:58 GMT-0700 (Pacific Daylight Time)">16:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">and I guess structured clone is one way of transmitting data between runtimes. You could also serialize to JSON. Or for very limited data types, use <code>SharedArrayBuffer</code>.</td></tr>
  <tr class="msg" id="L81"><td class="ts-cell"><a class="ts" href="#L81" alt="Mon Mar 29 2021 09:58:03 GMT-0700 (Pacific Daylight Time)">16:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell"><code>JS_WrapObject</code> needs to be called, yes.</td></tr>
  <tr class="msg" id="L82"><td class="ts-cell"><a class="ts" href="#L82" alt="Mon Mar 29 2021 09:58:47 GMT-0700 (Pacific Daylight Time)">16:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">tcampbell</span>: when any rejection happens on promises that doesn't have associated rejection handler (.then or .catch), the runtime records them, and when rejection handler is associated to those promises, the runtime removes them from the list.  at some point, embedder reports remaining promises as unhandled</td></tr>
  <tr class="msg" id="L83"><td class="ts-cell"><a class="ts" href="#L83" alt="Mon Mar 29 2021 09:59:12 GMT-0700 (Pacific Daylight Time)">16:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">arai</span>: do we have any tracking of a promise that is still pending?</td></tr>
  <tr class="msg" id="L84"><td class="ts-cell"><a class="ts" href="#L84" alt="Mon Mar 29 2021 09:59:19 GMT-0700 (Pacific Daylight Time)">16:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">I would expect not, since it is just an object.</td></tr>
  <tr class="msg" id="L85"><td class="ts-cell"><a class="ts" href="#L85" alt="Mon Mar 29 2021 10:00:16 GMT-0700 (Pacific Daylight Time)">17:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">afaik, we don't track the list of pending promises</td></tr>
  <tr class="msg" id="L86"><td class="ts-cell"><a class="ts" href="#L86" alt="Mon Mar 29 2021 10:00:30 GMT-0700 (Pacific Daylight Time)">17:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">(it might be in other place tho</td></tr>
  <tr class="msg" id="L87"><td class="ts-cell"><a class="ts" href="#L87" alt="Mon Mar 29 2021 10:02:44 GMT-0700 (Pacific Daylight Time)">17:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">nalexander</span> I think the promises would need to be tracked at their source. </td></tr>
  <tr class="msg" id="L88"><td class="ts-cell"><a class="ts" href="#L88" alt="Mon Mar 29 2021 10:02:45 GMT-0700 (Pacific Daylight Time)">17:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">sfink</span>: yes my question is from the JS code's perspective. We have code living in the same runtime but in different compartments, I'd like to get them to communicate in more 'real time'. They're in different zones though, I'm not sure if that matters with regards to what I wrote above</td></tr>
  <tr class="msg" id="L89"><td class="ts-cell"><a class="ts" href="#L89" alt="Mon Mar 29 2021 10:03:44 GMT-0700 (Pacific Daylight Time)">17:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">tcampbell</span>: okay, I think that will not be possible, since my goal is to understand the "unknown unknowns".</td></tr>
  <tr class="msg" id="L90"><td class="ts-cell"><a class="ts" href="#L90" alt="Mon Mar 29 2021 10:04:25 GMT-0700 (Pacific Daylight Time)">17:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">tcampbell</span>: leaving aside "interrogating the engine", what if I just wanted to "printf debug" the engine.  Like, could I get the engine to print (the length of) the various queues, say?</td></tr>
  <tr class="msg" id="L91"><td class="ts-cell"><a class="ts" href="#L91" alt="Mon Mar 29 2021 10:05:19 GMT-0700 (Pacific Daylight Time)">17:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">oh, just realized there are some more contexts before the question</td></tr>
  <tr class="msg" id="L92"><td class="ts-cell"><a class="ts" href="#L92" alt="Mon Mar 29 2021 10:05:26 GMT-0700 (Pacific Daylight Time)">17:05</a></td><td class="nick-cell"><div class="m-ov"><span class="nick nick-15" title="@arai:mozilla.org">arai</span></div></td><td class="msg-cell">reads backlog</td></tr>
  <tr class="msg" id="L93"><td class="ts-cell"><a class="ts" href="#L93" alt="Mon Mar 29 2021 10:06:10 GMT-0700 (Pacific Daylight Time)">17:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">arai</span>: for my discussion, yes, first message is 9:44am Pacific.</td></tr>
  <tr class="msg" id="L94"><td class="ts-cell"><a class="ts" href="#L94" alt="Mon Mar 29 2021 10:06:13 GMT-0700 (Pacific Daylight Time)">17:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">(back in 10)</td></tr>
  <tr class="msg" id="L95"><td class="ts-cell"><a class="ts" href="#L95" alt="Mon Mar 29 2021 10:06:20 GMT-0700 (Pacific Daylight Time)">17:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">tcampbell</span>: thanks for your help.</td></tr>
  <tr class="msg" id="L96"><td class="ts-cell"><a class="ts" href="#L96" alt="Mon Mar 29 2021 10:11:41 GMT-0700 (Pacific Daylight Time)">17:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">nalexander</span>: I think the problem with printf debugging the queues is that they contain promises that have already resolved and need handling</td></tr>
  <tr class="msg" id="L97"><td class="ts-cell"><a class="ts" href="#L97" alt="Mon Mar 29 2021 10:12:31 GMT-0700 (Pacific Daylight Time)">17:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">And it sounds like you're looking for things that haven't resolved?</td></tr>
  <tr class="msg" id="L98"><td class="ts-cell"><a class="ts" href="#L98" alt="Mon Mar 29 2021 10:12:33 GMT-0700 (Pacific Daylight Time)">17:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">iain</span>: need handling by the JS runtime, you mean, in a way that wouldn't necessarily be visible to the consumign code?</td></tr>
  <tr class="msg" id="L99"><td class="ts-cell"><a class="ts" href="#L99" alt="Mon Mar 29 2021 10:12:53 GMT-0700 (Pacific Daylight Time)">17:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">iain</span>: I'm not really sure what I'm looking for, 'cuz I don't understand all the things that are in play.</td></tr>
  <tr class="msg" id="L100"><td class="ts-cell"><a class="ts" href="#L100" alt="Mon Mar 29 2021 10:17:39 GMT-0700 (Pacific Daylight Time)">17:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">nalexander</span>: Sorry, maybe I was misreading "I think there's some asynchronous activity that's not being waited on"</td></tr>
  <tr class="msg" id="L101"><td class="ts-cell"><a class="ts" href="#L101" alt="Mon Mar 29 2021 10:18:10 GMT-0700 (Pacific Daylight Time)">17:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">What are the symptoms of your problem?</td></tr>
  <tr class="msg" id="L102"><td class="ts-cell"><a class="ts" href="#L102" alt="Mon Mar 29 2021 10:18:47 GMT-0700 (Pacific Daylight Time)">17:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">iain</span>: hmm, I'm not sure I want to waste your time, but:</td></tr>
  <tr class="msg" id="L103"><td class="ts-cell"><a class="ts" href="#L103" alt="Mon Mar 29 2021 10:18:54 GMT-0700 (Pacific Daylight Time)">17:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1700846">https://bugzilla.mozilla.org/show_bug.cgi?id=1700846</a></td></tr>
  <tr class="msg" id="L104"><td class="ts-cell"><a class="ts" href="#L104" alt="Mon Mar 29 2021 10:19:51 GMT-0700 (Pacific Daylight Time)">17:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell">As a lazy substitute while we "green this up" I've landed with a wait to let some things happen/resolve: <a href="https://searchfox.org/mozilla-central/rev/d58860eb739af613774c942c3bb61754123e449b/toolkit/mozapps/update/BackgroundTask_backgroundupdate.jsm#181">https://searchfox.org/mozilla-central/rev/d58860eb739af613774c942c3bb61754123e449b/toolkit/mozapps/update/BackgroundTask_backgroundupdate.jsm#181</a></td></tr>
  <tr class="msg" id="L105"><td class="ts-cell"><a class="ts" href="#L105" alt="Mon Mar 29 2021 10:20:19 GMT-0700 (Pacific Daylight Time)">17:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell">This code is very old and mostly-synchronous; it might be as easy as needing to wait a tick/cycle to let some other notifications process.</td></tr>
  <tr class="msg" id="L106"><td class="ts-cell"><a class="ts" href="#L106" alt="Mon Mar 29 2021 10:20:45 GMT-0700 (Pacific Daylight Time)">17:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell">I just wanted to start with "what can the engine/tooling" tell me about the world before trying to trace the many threads at work.</td></tr>
  <tr class="msg" id="L107"><td class="ts-cell"><a class="ts" href="#L107" alt="Mon Mar 29 2021 10:20:56 GMT-0700 (Pacific Daylight Time)">17:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell">(threads in the sense of fabric, not in a technical sense)</td></tr>
  <tr class="msg" id="L108"><td class="ts-cell"><a class="ts" href="#L108" alt="Mon Mar 29 2021 10:22:57 GMT-0700 (Pacific Daylight Time)">17:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">(Don't worry too much about wasting my time; I am just about to start digging into our promise resolution / event handling code for my own reasons, so this is helpful for ramping up)</td></tr>
  <tr class="msg" id="L109"><td class="ts-cell"><a class="ts" href="#L109" alt="Mon Mar 29 2021 10:24:14 GMT-0700 (Pacific Daylight Time)">17:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">iain</span>: I'll leave to you then, since I agree we should know how to answer this question regardless</td></tr>
  <tr class="msg" id="L110"><td class="ts-cell"><a class="ts" href="#L110" alt="Mon Mar 29 2021 10:24:36 GMT-0700 (Pacific Daylight Time)">17:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">The big problem with waiting for all pending promises to resolve is that we don't have a centralized place that stores pending promises</td></tr>
  <tr class="msg" id="L111"><td class="ts-cell"><a class="ts" href="#L111" alt="Mon Mar 29 2021 10:25:10 GMT-0700 (Pacific Daylight Time)">17:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Pending promises are just objects with callback functions</td></tr>
  <tr class="msg" id="L112"><td class="ts-cell"><a class="ts" href="#L112" alt="Mon Mar 29 2021 10:25:22 GMT-0700 (Pacific Daylight Time)">17:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">iain</span>: there is also that existential "what is a promise" question since I don't think we require them to all use PromiseObject (eg dom promises are fun, I think?)</td></tr>
  <tr class="msg" id="L113"><td class="ts-cell"><a class="ts" href="#L113" alt="Mon Mar 29 2021 10:25:24 GMT-0700 (Pacific Daylight Time)">17:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">And when the callback fires, they get put into a queue for handling</td></tr>
  <tr class="msg" id="L114"><td class="ts-cell"><a class="ts" href="#L114" alt="Mon Mar 29 2021 10:26:03 GMT-0700 (Pacific Daylight Time)">17:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">for reaction jobs for already-resolved promises, waiting for the end of a microtask checkpoint would work  (if such reactions resolves promises and enqueues more reactions, those will also be performed in the same checkpoint).  for promises that's not yet resolved, there's no easy way, given that completely depends on the consumer who resolves the promise, that exists outside of the engine</td></tr>
  <tr class="msg" id="L115"><td class="ts-cell"><a class="ts" href="#L115" alt="Mon Mar 29 2021 10:27:19 GMT-0700 (Pacific Daylight Time)">17:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">arai</span>: what's the way to wait for the microtask checkpoints from consumer-side?  Something like scheduling on the next tick?</td></tr>
  <tr class="msg" id="L116"><td class="ts-cell"><a class="ts" href="#L116" alt="Mon Mar 29 2021 10:27:27 GMT-0700 (Pacific Daylight Time)">17:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">The secondary problem with waiting for all pending promises is that it could be really slow for, say, network access</td></tr>
  <tr class="msg" id="L117"><td class="ts-cell"><a class="ts" href="#L117" alt="Mon Mar 29 2021 10:27:49 GMT-0700 (Pacific Daylight Time)">17:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">nalexander</span>: The microtask queue is flushed on the way out of JS</td></tr>
  <tr class="msg" id="L118"><td class="ts-cell"><a class="ts" href="#L118" alt="Mon Mar 29 2021 10:27:51 GMT-0700 (Pacific Daylight Time)">17:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell">Which is <code><a href="http://Services.tm">Services.tm</a>.dispatchToMainThread</code> in Gecko, IIRC?</td></tr>
  <tr class="msg" id="L119"><td class="ts-cell"><a class="ts" href="#L119" alt="Mon Mar 29 2021 10:28:50 GMT-0700 (Pacific Daylight Time)">17:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">Note, do not touch <code>jsapi.h</code> while working on Firefox. (rediscover this by mistake)</td></tr>
  <tr class="msg" id="L120"><td class="ts-cell"><a class="ts" href="#L120" alt="Mon Mar 29 2021 10:29:03 GMT-0700 (Pacific Daylight Time)">17:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">nbp</span>: duly noted :)</td></tr>
  <tr class="msg" id="L121"><td class="ts-cell"><a class="ts" href="#L121" alt="Mon Mar 29 2021 10:29:12 GMT-0700 (Pacific Daylight Time)">17:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">nbp</span>: may I ask why?</td></tr>
  <tr class="msg" id="L122"><td class="ts-cell"><a class="ts" href="#L122" alt="Mon Mar 29 2021 10:29:20 GMT-0700 (Pacific Daylight Time)">17:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell">(Presumably, rebuild the universe?)</td></tr>
  <tr class="msg" id="L123"><td class="ts-cell"><a class="ts" href="#L123" alt="Mon Mar 29 2021 10:29:25 GMT-0700 (Pacific Daylight Time)">17:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">(So you shouldn't have to do anything special to wait for the end of a microtask checkpoint; it will just happen)</td></tr>
  <tr class="msg" id="L124"><td class="ts-cell"><a class="ts" href="#L124" alt="Mon Mar 29 2021 10:29:32 GMT-0700 (Pacific Daylight Time)">17:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><a href="https://searchfox.org/mozilla-central/rev/d58860eb739af613774c942c3bb61754123e449b/xpcom/base/CycleCollectedJSContext.cpp#472">https://searchfox.org/mozilla-central/rev/d58860eb739af613774c942c3bb61754123e449b/xpcom/base/CycleCollectedJSContext.cpp#472</a></td></tr>
  <tr class="msg" id="L125"><td class="ts-cell"><a class="ts" href="#L125" alt="Mon Mar 29 2021 10:29:36 GMT-0700 (Pacific Daylight Time)">17:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">nalexander</span>: it is included everywhere, and is equivalent to a clobber build.</td></tr>
  <tr class="msg" id="L126"><td class="ts-cell"><a class="ts" href="#L126" alt="Mon Mar 29 2021 10:29:44 GMT-0700 (Pacific Daylight Time)">17:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@nalexander:mozilla.org">nalexander</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">nbp</span>: roger.</td></tr>
  <tr class="msg" id="L127"><td class="ts-cell"><a class="ts" href="#L127" alt="Mon Mar 29 2021 10:29:50 GMT-0700 (Pacific Daylight Time)">17:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">that method is called after performing microtask</td></tr>
  <tr class="msg" id="L128"><td class="ts-cell"><a class="ts" href="#L128" alt="Mon Mar 29 2021 10:30:32 GMT-0700 (Pacific Daylight Time)">17:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">unless you are building firefox in 4 minutes instead of 40.</td></tr>
  <tr class="msg" id="L129"><td class="ts-cell"><a class="ts" href="#L129" alt="Mon Mar 29 2021 10:36:05 GMT-0700 (Pacific Daylight Time)">17:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">sfink</span>: So for different compartments, all I need to do is get the JS::Value from realm A in compartment A, enter the realm B in compartment B via autorealm, call JS_WrapValue, and the send the value to my JS code ?</td></tr>
  <tr class="msg" id="L130"><td class="ts-cell"><a class="ts" href="#L130" alt="Mon Mar 29 2021 10:38:08 GMT-0700 (Pacific Daylight Time)">17:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">(not entirely clear how to create a compartment wrapper from C++)</td></tr>
  <tr class="msg" id="L131"><td class="ts-cell"><a class="ts" href="#L131" alt="Mon Mar 29 2021 10:40:24 GMT-0700 (Pacific Daylight Time)">17:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">JS_WrapValue creates the wrapper for you</td></tr>
  <tr class="msg" id="L132"><td class="ts-cell"><a class="ts" href="#L132" alt="Mon Mar 29 2021 10:40:39 GMT-0700 (Pacific Daylight Time)">17:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">Are you sure you need compartments? These wrappers are not free</td></tr>
  <tr class="msg" id="L133"><td class="ts-cell"><a class="ts" href="#L133" alt="Mon Mar 29 2021 10:45:41 GMT-0700 (Pacific Daylight Time)">17:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">(my responses will be much delayed; it's homeschooling math hour over here)</td></tr>
  <tr class="msg" id="L134"><td class="ts-cell"><a class="ts" href="#L134" alt="Mon Mar 29 2021 10:46:04 GMT-0700 (Pacific Daylight Time)">17:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I would echo evilpie's question. If you don't have a security boundary, then you probably don't want compartments.</td></tr>
  <tr class="msg" id="L135"><td class="ts-cell"><a class="ts" href="#L135" alt="Mon Mar 29 2021 10:46:20 GMT-0700 (Pacific Daylight Time)">17:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">they're slow and very easy to get wrong from C++</td></tr>
  <tr class="msg" id="L136"><td class="ts-cell"><a class="ts" href="#L136" alt="Mon Mar 29 2021 10:46:31 GMT-0700 (Pacific Daylight Time)">17:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">any semantic separation can be done with Realms</td></tr>
  <tr class="msg" id="L137"><td class="ts-cell"><a class="ts" href="#L137" alt="Mon Mar 29 2021 10:55:13 GMT-0700 (Pacific Daylight Time)">17:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">right</td></tr>
  <tr class="msg" id="L138"><td class="ts-cell"><a class="ts" href="#L138" alt="Mon Mar 29 2021 10:55:28 GMT-0700 (Pacific Daylight Time)">17:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">I probably don't need them, just need to change more code to have different realms in the same compartment :p </td></tr>
  <tr class="msg" id="L139"><td class="ts-cell"><a class="ts" href="#L139" alt="Mon Mar 29 2021 10:56:02 GMT-0700 (Pacific Daylight Time)">17:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">Given that I'm doing that change for performance reasons, it probably makes sense anyways</td></tr>
  <tr class="msg" id="L140"><td class="ts-cell"><a class="ts" href="#L140" alt="Mon Mar 29 2021 10:56:05 GMT-0700 (Pacific Daylight Time)">17:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">Thanks for the answers</td></tr>
  <tr class="msg" id="L141"><td class="ts-cell"><a class="ts" href="#L141" alt="Mon Mar 29 2021 11:11:45 GMT-0700 (Pacific Daylight Time)">18:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">wraitii</span>: you mentioned that currently they're in different zones. Putting them in the same compartment does mean they'll be in the same zone, and you won't be able to GC them independently anymore. But it would be pretty hard to construct a scenario where that's a bad tradeoff.</td></tr>
  <tr class="msg" id="L142"><td class="ts-cell"><a class="ts" href="#L142" alt="Mon Mar 29 2021 11:13:11 GMT-0700 (Pacific Daylight Time)">18:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">wraitii</span>: if you happen to see performance improvements we'd love to hear about them. (The realm/compartment split happened just a few years ago.)</td></tr>
  <tr class="msg" id="L143"><td class="ts-cell"><a class="ts" href="#L143" alt="Mon Mar 29 2021 11:14:14 GMT-0700 (Pacific Daylight Time)">18:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">The change will be part of a greater philosophy change I'm trying, if it succeeds the performance improvements are liable to mostly from that, so I doubt I'll be able to easily measure the impact of the SM changes</td></tr>
  <tr class="msg" id="L144"><td class="ts-cell"><a class="ts" href="#L144" alt="Mon Mar 29 2021 11:15:04 GMT-0700 (Pacific Daylight Time)">18:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">(Basically right now our AI is setup to run threaded, but we didn't actually thread it, so it's just in another compartment. The issue is that we lose a lot of time copying data over to the other compartment, so not doing that is liable to be faster)</td></tr>
  <tr class="msg" id="L145"><td class="ts-cell"><a class="ts" href="#L145" alt="Mon Mar 29 2021 11:15:25 GMT-0700 (Pacific Daylight Time)">18:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">that makes sense</td></tr>
  <tr class="msg" id="L146"><td class="ts-cell"><a class="ts" href="#L146" alt="Mon Mar 29 2021 11:23:14 GMT-0700 (Pacific Daylight Time)">18:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@wraitii:mozilla.org">wraitii</span>&gt;</div></td><td class="msg-cell">(and I'll probably implement pseudo-web-workers to do some things asynchronously, since there is still value in that)</td></tr>
  <tr class="msg" id="L147"><td class="ts-cell"><a class="ts" href="#L147" alt="Mon Mar 29 2021 13:55:12 GMT-0700 (Pacific Daylight Time)">20:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">design question: how should we represent "undefined" PropertyDescriptor?</td></tr>
  <tr class="msg" id="L148"><td class="ts-cell"><a class="ts" href="#L148" alt="Mon Mar 29 2021 13:55:35 GMT-0700 (Pacific Daylight Time)">20:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">Maybe&lt;PropertyDescriptor&gt;? or just have some method on PropertyDescriptor like "isUndefined()" ?</td></tr>
  <tr class="msg" id="L149"><td class="ts-cell"><a class="ts" href="#L149" alt="Mon Mar 29 2021 14:02:41 GMT-0700 (Pacific Daylight Time)">21:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">like a hole? I think I like the "Maybe" version since "isUndefined" is a little close to <code>{value:undefined}</code></td></tr>
  <tr class="msg" id="L150"><td class="ts-cell"><a class="ts" href="#L150" alt="Mon Mar 29 2021 14:08:22 GMT-0700 (Pacific Daylight Time)">21:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">tcampbell</span>: the spec does something like this <a href="https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable">https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable</a></td></tr>
  <tr class="msg" id="L151"><td class="ts-cell"><a class="ts" href="#L151" alt="Mon Mar 29 2021 14:09:10 GMT-0700 (Pacific Daylight Time)">21:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">hmm right</td></tr>
  <tr class="msg" id="L152"><td class="ts-cell"><a class="ts" href="#L152" alt="Mon Mar 29 2021 14:09:36 GMT-0700 (Pacific Daylight Time)">21:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">Currently we use desc.object(), which is like the worst possible solution</td></tr>
  <tr class="msg" id="L153"><td class="ts-cell"><a class="ts" href="#L153" alt="Mon Mar 29 2021 14:12:08 GMT-0700 (Pacific Daylight Time)">21:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">I am going to try Maybe&lt;PropertyDescriptor&gt; in a few places and see how it feels</td></tr>
  <tr class="msg" id="L154"><td class="ts-cell"><a class="ts" href="#L154" alt="Mon Mar 29 2021 14:12:50 GMT-0700 (Pacific Daylight Time)">21:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">I think that is clearest (and clearer than the spec..)</td></tr>
  <tr class="msg" id="L155"><td class="ts-cell"><a class="ts" href="#L155" alt="Mon Mar 29 2021 14:20:32 GMT-0700 (Pacific Daylight Time)">21:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">tcampbell</span>: sounds good to me. cheers</td></tr>
  <tr class="msg" id="L156"><td class="ts-cell"><a class="ts" href="#L156" alt="Mon Mar 29 2021 14:58:44 GMT-0700 (Pacific Daylight Time)">21:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">confession: Trying to sort through a bytecode emission gap in private method/field patches; hoist on my own petard for not writing a sufficiently comprehensive set of private field patches when I did it originally </td></tr>
  <tr class="msg" id="L157"><td class="ts-cell"><a class="ts" href="#L157" alt="Mon Mar 29 2021 14:58:46 GMT-0700 (Pacific Daylight Time)">21:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell">Seen! Your update will eventually appear on <a href="https://robotzilla.github.io/histoire">https://robotzilla.github.io/histoire</a></td></tr>
  <tr class="msg" id="L158"><td class="ts-cell"><a class="ts" href="#L158" alt="Mon Mar 29 2021 14:59:28 GMT-0700 (Pacific Daylight Time)">21:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">(side note: boy trying to share emission functionality makes reasoning about bytecode emission hard. Out of juice for today )</td></tr>

</tbody></table></div></div></div>
</body></html>