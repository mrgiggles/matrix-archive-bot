<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2022-06-25</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2022-06-25<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-06-24" class="nav-link"><span>prev</span></a>
<a href="2022-06-27" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Fri Jun 24 2022 17:30:56 GMT-0700 (Pacific Daylight Time)">00:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell">has anyone tried building SM on Windows lately?<br>I remember a while ago <code>mozmake</code> was used to build it, but it's not available anymore with the latest MozillaBuild</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Fri Jun 24 2022 17:31:41 GMT-0700 (Pacific Daylight Time)">00:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell">MozillaBuild version: 4.0.1
Mozilla repo src version: ESR 91.10</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Fri Jun 24 2022 17:37:32 GMT-0700 (Pacific Daylight Time)">00:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><span class="nick-13">TheQwertiest</span>: iiuc, mozmake is downloaded during mach bootstrap or mach build, into ~/.mozbuild</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Fri Jun 24 2022 17:38:27 GMT-0700 (Pacific Daylight Time)">00:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">Pastah</span>: can you pastebin the error details?</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Fri Jun 24 2022 17:41:06 GMT-0700 (Pacific Daylight Time)">00:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">the exact output in the terminal, and the content of log files pointed there, etc</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Sat Jun 25 2022 05:14:49 GMT-0700 (Pacific Daylight Time)">12:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">arai</span>: I've tried on the clean branch checkout and now it's broken completely :D<br>is there anyone I could poke who can help me with Win build?</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Sat Jun 25 2022 05:23:35 GMT-0700 (Pacific Daylight Time)">12:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell"><p>Various ways I've tried (all on clean checkout):<br>0. (same for all ways) Exec start-shell.bat from windows cmd</p>
<ol>
<li>Build by mach (based on <a href="https://firefox-source-docs.mozilla.org/setup/windows_build.html">https://firefox-source-docs.mozilla.org/setup/windows_build.html</a>):</li>
</ol>
<ul>
<li><code>export MOZBUILD_STATE_PATH=SOME_PATH</code></li>
<li><code>./mach bootstrap</code>: choose SM, opt out of telemetry and commiting</li>
<li><code>./mach build</code></li>
<li>fails with <code>FileNotFoundError: [WinError 2]</code> (full log will be attached in the next msg)</li>
</ul>
<ol start="2">
<li>Build from js/src (based on <a href="https://github.com/mozilla-spidermonkey/spidermonkey-embedding-examples/blob/esr91/docs/Building%20SpiderMonkey.md">https://github.com/mozilla-spidermonkey/spidermonkey-embedding-examples/blob/esr91/docs/Building%20SpiderMonkey.md</a>):</li>
</ol>
<ul>
<li><code>cd js/src</code></li>
<li><code>cp ./<a href="http://configure.in">configure.in</a> ./configure</code></li>
<li><code>chmod +x ./configure</code></li>
<li><code>mkdir _build</code></li>
<li><code>cd _build</code></li>
<li><code>../configure --enable-nspr-build --disable-jemalloc --disable-js-shell --disable-tests --target=i686-pc-mingw32 --host=i686-pc-mingw32</code></li>
<li>fails during <code>checking for host system type</code> (full log in the next msg)</li>
</ul>
</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Sat Jun 25 2022 06:15:12 GMT-0700 (Pacific Daylight Time)">13:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell">narrowed down a bit the crash in case 2: it seems that the <code>shell</code> argument here is not set (i.e. None) - <a href="https://github.com/mozilla/gecko-dev/blob/7dcf573525/build/moz.configure/init.configure#L834">https://github.com/mozilla/gecko-dev/blob/7dcf573525/build/moz.configure/init.configure#L834</a></td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Sat Jun 25 2022 06:26:26 GMT-0700 (Pacific Daylight Time)">13:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell"><p>ok, I've figured it out: it seems that esr 91.10 is incompatible with the latest MozillaBuild:</p>
<ul>
<li>MozillaBuild 4.01 uses msys2</li>
<li>esr branch expects msys (<a href="https://github.com/mozilla/gecko-dev/blob/7dcf573525/build/moz.configure/init.configure#L199">https://github.com/mozilla/gecko-dev/blob/7dcf573525/build/moz.configure/init.configure#L199</a> , <a href="https://github.com/mozilla/gecko-dev/blob/7dcf573525/python/mozbuild/mozbuild/mozconfig.py#L135">https://github.com/mozilla/gecko-dev/blob/7dcf573525/python/mozbuild/mozbuild/mozconfig.py#L135</a>)</li>
</ul>
</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Sat Jun 25 2022 06:31:04 GMT-0700 (Pacific Daylight Time)">13:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell">Changing corresponding lines to msys2/usr/bin fixed (one part of) the build</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Sat Jun 25 2022 06:32:03 GMT-0700 (Pacific Daylight Time)">13:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell">sigh, I don't think I've ever had a SM version upgrade that didn't involve debugging Win build related problems...</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Sat Jun 25 2022 06:33:07 GMT-0700 (Pacific Daylight Time)">13:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell">ps: probably that's the same reason why it couldn't find mozmake</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Sat Jun 25 2022 08:55:00 GMT-0700 (Pacific Daylight Time)">15:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">people in <a href="https://matrix.to/#/#build:mozilla.org">#build:mozilla.org</a> would know better about MozillaBuild and requirement</td></tr>

</tbody></table></div></div></div>
</body></html>