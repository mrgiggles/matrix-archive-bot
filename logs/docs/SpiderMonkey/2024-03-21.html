<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2024-03-21</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2024-03-21<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2024-03-20" class="nav-link"><span>prev</span></a>
<a href="2024-03-22" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Thu Mar 21 2024 03:33:17 GMT-0700 (Pacific Daylight Time)">10:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@ms2ger:igalia.com">Ms2ger</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Holy moly. Trying to figure out what the equivalent of <code>hg split</code> is in git, and it makes me want to just start over again and redo the changes by hand</blockquote></mx-reply>Is that like <span class="nick-2">nika</span>'s <code>git revise --cut</code>?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Thu Mar 21 2024 03:35:36 GMT-0700 (Pacific Daylight Time)">10:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@padenot:mozilla.org">padenot</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">mgaudet</span>: <a href="https://github.com/andrewshadura/git-crecord">https://github.com/andrewshadura/git-crecord</a> is nice</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Thu Mar 21 2024 03:35:45 GMT-0700 (Pacific Daylight Time)">10:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@padenot:mozilla.org">padenot</span>&gt;</div></td><td class="msg-cell">oh well I'm late</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Thu Mar 21 2024 06:59:05 GMT-0700 (Pacific Daylight Time)">13:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Is that like <span class="nick-2">nika</span>'s <code>git revise --cut</code>?</blockquote></mx-reply>Sure sounds like it... will have to give that a try!</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Thu Mar 21 2024 07:01:45 GMT-0700 (Pacific Daylight Time)">14:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nika:mozilla.org">nika</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Is that like <span class="nick-2">nika</span>'s <code>git revise --cut</code>?</blockquote></mx-reply>Unfortunately it currently has the ux of git add -p, because it literally shells out to it under the hood :-p</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Thu Mar 21 2024 07:02:20 GMT-0700 (Pacific Daylight Time)">14:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">aww nuts :) (I suppose I will get used to add -p eventually)</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Thu Mar 21 2024 07:02:39 GMT-0700 (Pacific Daylight Time)">14:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nika:mozilla.org">nika</span>&gt;</div></td><td class="msg-cell">Might not be too hard to add a crecord backend though if thatâ€™s more desirable</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Thu Mar 21 2024 07:03:00 GMT-0700 (Pacific Daylight Time)">14:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nika:mozilla.org">nika</span>&gt;</div></td><td class="msg-cell">Could add a revise.cut.backend config or something</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Thu Mar 21 2024 07:03:27 GMT-0700 (Pacific Daylight Time)">14:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@ms2ger:igalia.com">Ms2ger</span>&gt;</div></td><td class="msg-cell">I've been brainwashed by -p for too long ðŸ˜…</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Thu Mar 21 2024 07:03:47 GMT-0700 (Pacific Daylight Time)">14:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@ms2ger:igalia.com">Ms2ger</span>&gt;</div></td><td class="msg-cell">Still, thanks for revise</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Thu Mar 21 2024 07:03:59 GMT-0700 (Pacific Daylight Time)">14:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nika:mozilla.org">nika</span>&gt;</div></td><td class="msg-cell">Same, though I tend to use the staging commands in vscode these days</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Thu Mar 21 2024 07:04:20 GMT-0700 (Pacific Daylight Time)">14:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nika:mozilla.org">nika</span>&gt;</div></td><td class="msg-cell">Iâ€™m glad folks still like it</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Thu Mar 21 2024 07:04:53 GMT-0700 (Pacific Daylight Time)">14:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nika:mozilla.org">nika</span>&gt;</div></td><td class="msg-cell">I still use it every day :-)</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Thu Mar 21 2024 07:08:56 GMT-0700 (Pacific Daylight Time)">14:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">jonco</span>: Do you happen to know if there is any mean to limit Firefox/SpiderMonkey memory within <code>about:config</code>? I know about <code>javascript.options.mem.max</code> but this is only the GC, AFAIU.</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Thu Mar 21 2024 07:21:16 GMT-0700 (Pacific Daylight Time)">14:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">nbp</span>: not that I know of, except for the GC heap</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Thu Mar 21 2024 07:21:30 GMT-0700 (Pacific Daylight Time)">14:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">we do trigger GC based on size of malloc memory attached to GC things, but there's no hard limit</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Thu Mar 21 2024 08:53:46 GMT-0700 (Pacific Daylight Time)">15:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@bthrall:mozilla.org">Bryan Thrall [:bthrall]</span>&gt;</div></td><td class="msg-cell"><p>It looks like <code>JSON.parse</code> SyntaxErrors report line and column numbers for the script that calls <code>JSON.parse</code>, rather than for the input data:</p>
<pre><code>try {
  const invalidJson = '{"a": 123,"b": "Hello," "c": true,}';
  JSON.parse(invalidJson);
} catch (e) {
  console.log("msg", e.message);
  console.log("lineNumber", e.lineNumber);
  console.log("columnNumber", e.columnNumber);
}
</code></pre>
<p>Outputs:</p>
<blockquote>
<p>msg JSON.parse: expected ',' or '}' after property value in object at line 1 column 25 of the JSON data<br>lineNumber 3<br>columnNumber 8</p>
</blockquote>
<p>This isn't consistent with <code>eval()</code> (which reports line and column numbers for the input data), and you can see that the error message is inconsistent with the fields on the error.<br>The JSON modules integration also <a href="https://phabricator.services.mozilla.com/D204174#7029224">wants the line numbers for the input data</a>.</p>
<p>What problems could we encounter if we switched to setting the line numbers for the input data instead of for the script that calls <code>JSON.parse</code>?</p>
</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Thu Mar 21 2024 09:01:09 GMT-0700 (Pacific Daylight Time)">16:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">We could potentially break tooling that maps error messages to source code locations</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Thu Mar 21 2024 09:01:27 GMT-0700 (Pacific Daylight Time)">16:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell">If I understand correctly, this could impact the DevTools console, where we do print the error location. Users can then click on it to jump to the source in the Debugger. If we'd set the line and column number relative to the JSON, it won't take you to the line <code>JSON.parse</code> is done</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Thu Mar 21 2024 09:31:16 GMT-0700 (Pacific Daylight Time)">16:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">it's nice to see that git-crecord is just a port of mercurial's crecord, since I have some local patches to crecord that I've kinda gotten used to having. I should try upstreaming them and see if they make it to git-crecord. ;-)</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Thu Mar 21 2024 09:32:17 GMT-0700 (Pacific Daylight Time)">16:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">(They're for selecting a range of lines by holding down shift. The curses UI is a little clunky when dissecting larger hunks right now.)</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Thu Mar 21 2024 09:35:50 GMT-0700 (Pacific Daylight Time)">16:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@padenot:mozilla.org">padenot</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">sfink</span>: how much for your patches</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Thu Mar 21 2024 09:36:05 GMT-0700 (Pacific Daylight Time)">16:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@padenot:mozilla.org">padenot</span>&gt;</div></td><td class="msg-cell">I pay cash, that sounds wonderful</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Thu Mar 21 2024 09:40:22 GMT-0700 (Pacific Daylight Time)">16:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I don't know whether upstream will take it, since it's questionable whether the toggle should apply to the line you're on or not. But my current version looks to be a tiny patch: <a href="https://paste.mozilla.org/5HOzSDZQ">https://paste.mozilla.org/5HOzSDZQ</a></td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Thu Mar 21 2024 09:41:34 GMT-0700 (Pacific Daylight Time)">16:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">hey, that's not JS. <a href="https://paste.mozilla.org/ZkoMcqBD">https://paste.mozilla.org/ZkoMcqBD</a></td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Thu Mar 21 2024 10:01:15 GMT-0700 (Pacific Daylight Time)">17:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">well, that was relatively painless: <a href="https://foss.heptapod.net/mercurial/mercurial-devel/-/merge_requests/818">https://foss.heptapod.net/mercurial/mercurial-devel/-/merge_requests/818</a> (though partly because I already had a developer account there)</td></tr>

</tbody></table></div></div></div>
</body></html>