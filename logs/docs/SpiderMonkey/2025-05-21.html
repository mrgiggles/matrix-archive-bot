<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2025-05-21</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2025-05-21<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2025-05-20" class="nav-link"><span>prev</span></a>
<a href="2025-05-22" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue May 20 2025 23:39:57 GMT-0700 (Pacific Daylight Time)">06:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@glandium:mozilla.org">glandium</span>&gt;</div></td><td class="msg-cell">can someone remind me how to make the jit print out the instructions it's compiling to?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed May 21 2025 00:08:40 GMT-0700 (Pacific Daylight Time)">07:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@debadree25:mozilla.org">debadree25</span>&gt;</div></td><td class="msg-cell">IONFLAGS=codegen would be the one i guess?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed May 21 2025 01:03:47 GMT-0700 (Pacific Daylight Time)">08:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@glandium:mozilla.org">glandium</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">debadree25</span>: thanks</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed May 21 2025 03:05:31 GMT-0700 (Pacific Daylight Time)">10:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@padenot:mozilla.org">padenot</span>&gt;</div></td><td class="msg-cell">This is what I ended up doing, thanks for confirming</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed May 21 2025 08:03:22 GMT-0700 (Pacific Daylight Time)">15:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@henry-x:matrix.org">henry-x</span>&gt;</div></td><td class="msg-cell"><p>Hello. How do I enable <code>JitSpew</code> log messages? E.g. <a href="https://searchfox.org/mozilla-central/rev/dbef1a2f75798fb0136b7428d959c8feb09ad5d1/js/src/jsapi.cpp#4351">https://searchfox.org/mozilla-central/rev/dbef1a2f75798fb0136b7428d959c8feb09ad5d1/js/src/jsapi.cpp#4351</a> . I figured it would be through <code>MOZ_LOG</code>, but I'm not sure about the module names.</p>
</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed May 21 2025 08:07:10 GMT-0700 (Pacific Daylight Time)">15:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">henry-x</span>: Ah, no, we have our own bespoke mechanism. You set IONFLAGS=name-of-channel. Look <a href="https://searchfox.org/mozilla-central/source/js/src/jit/JitSpewer.cpp#415-531">here</a> for the exact string-&gt;channel mapping</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed May 21 2025 08:07:28 GMT-0700 (Pacific Daylight Time)">15:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@mstange:mozilla.org">mstange</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">henry-x</span>: note that your build needs to be complied with <code>--enable-jitspew</code></td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed May 21 2025 08:07:30 GMT-0700 (Pacific Daylight Time)">15:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">(You can enable multiple channels with <code>IONFLAGS=foo,bar</code>)</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed May 21 2025 08:09:18 GMT-0700 (Pacific Daylight Time)">15:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@henry-x:matrix.org">henry-x</span>&gt;</div></td><td class="msg-cell">ah ok. Thanks for the information. I guess I need a recompile</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed May 21 2025 10:02:25 GMT-0700 (Pacific Daylight Time)">17:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">JitSpew actually should work through MOZ_LOG (c.f. <a href="https://searchfox.org/mozilla-central/source/js/src/vm/Logging.h#99">https://searchfox.org/mozilla-central/source/js/src/vm/Logging.h#99</a>) </td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed May 21 2025 10:04:06 GMT-0700 (Pacific Daylight Time)">17:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><p>MOZ_LOG=IonScripts:5 should work.</p>
<p>Having said that, that's not <em>100%</em> true, as there are some JitSpew functions which don't go through that path</p>
</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed May 21 2025 10:04:52 GMT-0700 (Pacific Daylight Time)">17:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><p>but that one <span class="nick-1">henry-x</span> linked to should be accessible via JIT_SPEW, but markus does point out correctly you still need <code>--enable-jitspew</code>.</p>
<p>the MOZ_LOG approach is nice because it will work in browser and dump logs into profiles tooo</p>
</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed May 21 2025 12:38:16 GMT-0700 (Pacific Daylight Time)">19:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:matrix.org">kfjvj</span>&gt;</div></td><td class="msg-cell">I'm calling JS_NewPlainObject, and it's causing a segfault.  Does anyone know why this might be occurring?</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed May 21 2025 13:34:56 GMT-0700 (Pacific Daylight Time)">20:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">lots of potential reasons. You'll probably need to get a stack trace. And are you compiling with -DDEBUG?</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed May 21 2025 13:44:57 GMT-0700 (Pacific Daylight Time)">20:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:matrix.org">kfjvj</span>&gt;</div></td><td class="msg-cell">Yeah, I'm about to analyze the core dump.</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Wed May 21 2025 14:50:18 GMT-0700 (Pacific Daylight Time)">21:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:matrix.org">kfjvj</span>&gt;</div></td><td class="msg-cell">I've just attempted analyzing the core dump, and I'm having an issue.  The stack trace says that the failure is occurring in jsapi.cpp.

However, my local clone of mozjs has no such file.</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Wed May 21 2025 14:55:28 GMT-0700 (Pacific Daylight Time)">21:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">kfjvj</span>: It should be <a href="https://searchfox.org/mozilla-central/source/js/src">right at the root of src</a>.</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Wed May 21 2025 15:37:05 GMT-0700 (Pacific Daylight Time)">22:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:matrix.org">kfjvj</span>&gt;</div></td><td class="msg-cell">Maybe there's just something wrong with my local clone.  Does anyone know how to specify a particular version on searchfox?</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Wed May 21 2025 15:37:25 GMT-0700 (Pacific Daylight Time)">22:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:matrix.org">kfjvj</span>&gt;</div></td><td class="msg-cell">Maybe I can use the same version as my local instance to find the correct line in the source code.</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Wed May 21 2025 15:38:34 GMT-0700 (Pacific Daylight Time)">22:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Searchfox indexes old ESR versions separately: <a href="https://searchfox.org/">https://searchfox.org/</a> (scroll down and look for eg mozilla-esr128)</td></tr>

</tbody></table></div></div></div>
</body></html>