<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2022-10-18</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2022-10-18<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-10-17" class="nav-link"><span>prev</span></a>
<a href="2022-10-19" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Oct 18 2022 01:58:58 GMT-0700 (Pacific Daylight Time)">08:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@ms2ger:igalia.com">Ms2ger ðŸ’‰ðŸ’‰ðŸ’‰</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">mgaudet</span>: hey, I was wondering about the ShadowRealms plans, since domenic was asking about implementer interest in <a href="https://github.com/whatwg/html/pull/5339">https://github.com/whatwg/html/pull/5339</a></td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Oct 18 2022 06:34:16 GMT-0700 (Pacific Daylight Time)">13:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><p><span class="nick-2">Ms2ger ðŸ’‰ðŸ’‰ðŸ’‰</span>: I don't have a concrete plan yet, but it was on my list to come up with over the next week or two.</p>
<p>Right now the implementation isn't quite complete; we don't handle <code>importValue</code> inside a worker yet.</p>
<p>I also wanted to get the WPT tests for the HTML working too (saw your github comment, will test out the harness fix in the next day or two)</p>
<p>There's also some questions I still would like to dig into (that are just outside my skillset, so would take some skill acquisition): e.g. the single fetch assumption is, afaict, un-tested. In general I'd like to re-audit all the modules integration of ShadowRealms before shipping -- I think it works, but also, it's now been months since I've looked at it.</p>
</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Oct 18 2022 06:34:42 GMT-0700 (Pacific Daylight Time)">13:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">(I did mention in <a href="https://matrix.to/#/#whatwg:matrix.org">#whatwg:matrix.org</a> that having a final spec would help too... because we also want that)</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue Oct 18 2022 06:34:56 GMT-0700 (Pacific Daylight Time)">13:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@ms2ger:igalia.com">Ms2ger ðŸ’‰ðŸ’‰ðŸ’‰</span>&gt;</div></td><td class="msg-cell">Yeah, I saw - thanks!</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Tue Oct 18 2022 06:37:01 GMT-0700 (Pacific Daylight Time)">13:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@ms2ger:igalia.com">Ms2ger ðŸ’‰ðŸ’‰ðŸ’‰</span>&gt;</div></td><td class="msg-cell">As long as I can move the spec work forward, I'm happy for now :)</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Tue Oct 18 2022 06:39:01 GMT-0700 (Pacific Daylight Time)">13:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">Ms2ger ðŸ’‰ðŸ’‰ðŸ’‰</span>: Yeah; at least from my perspective I don't see us abandoning ShadowRealms as an idea. This is all paged out of my head, as I moved onto other stuff while a number of questions got worked on by committee -- though I was on parental leave and can't recall where TC39 got to with them last meeting.</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Tue Oct 18 2022 06:39:49 GMT-0700 (Pacific Daylight Time)">13:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@ms2ger:igalia.com">Ms2ger ðŸ’‰ðŸ’‰ðŸ’‰</span>&gt;</div></td><td class="msg-cell">That's clearly more important :)</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Tue Oct 18 2022 06:40:06 GMT-0700 (Pacific Daylight Time)">13:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@ms2ger:igalia.com">Ms2ger ðŸ’‰ðŸ’‰ðŸ’‰</span>&gt;</div></td><td class="msg-cell">I just want to avoid a situation where everyone is waiting for everyone else and nobody moves</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Tue Oct 18 2022 06:51:22 GMT-0700 (Pacific Daylight Time)">13:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">Fair!</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Tue Oct 18 2022 10:48:19 GMT-0700 (Pacific Daylight Time)">17:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">PSA: the spidermonkey SM(...) shell jobs in CI will stop disabling ASLR, at least for now. I was disabling it to make failures more reproducible, but those jobs are being moved over to GCP and allowing ASLR would require some docker configuration work that nobody wants to block on atm. (bug 1795063)</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Tue Oct 18 2022 10:48:21 GMT-0700 (Pacific Daylight Time)">17:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1795063">https://bugzil.la/1795063</a> â€” ASSIGNED (ahal) â€” Migrate spidermonkey builds from AWS -&gt; GCP</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Tue Oct 18 2022 12:29:10 GMT-0700 (Pacific Daylight Time)">19:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">If I use JS_CallFunctionValue to call an async javascript function, could that potentially cause problems?</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Tue Oct 18 2022 12:40:28 GMT-0700 (Pacific Daylight Time)">19:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">Or rather, how can I make sure that all async code completes before I call JsShutdown</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Tue Oct 18 2022 12:46:12 GMT-0700 (Pacific Daylight Time)">19:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">iiuc, an async function is just a function that returns a Promise.</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Tue Oct 18 2022 12:47:19 GMT-0700 (Pacific Daylight Time)">19:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">so I guess you'd need to drain whatever you're using as a job queue? Which may not resolve everything, if there are Promises waiting on external events or something. (Note: I don't really know much about promises. I'm guessing here.)</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Tue Oct 18 2022 12:48:14 GMT-0700 (Pacific Daylight Time)">19:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">Yeah.  I'm not entirely clear on how job queues/event queues work in SpiderMonkey</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Tue Oct 18 2022 12:50:00 GMT-0700 (Pacific Daylight Time)">19:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">my understanding is that the embedding has to provide some of the job queue functionality. In the browser, it's done with a microtask queue, but that's not part of spidermonkey. There's a default job queue in SM that does part of what you need. I think <span class="nick-15">arai</span> is the expert in these things.</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Tue Oct 18 2022 13:02:12 GMT-0700 (Pacific Daylight Time)">20:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">You can provide your own job queue, or use the internal one. See here: <a href="https://searchfox.org/mozilla-central/source/js/src/jsfriendapi.h#210-222">https://searchfox.org/mozilla-central/source/js/src/jsfriendapi.h#210-222</a></td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Tue Oct 18 2022 13:02:57 GMT-0700 (Pacific Daylight Time)">20:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">So you just run this one time for each context?</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Tue Oct 18 2022 13:04:18 GMT-0700 (Pacific Daylight Time)">20:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">You call it early in setup to indicate that you want to use the internal job queue, then you are responsible for calling <code>RunJobs</code> when you want to actually pull jobs out of the queue.</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Tue Oct 18 2022 13:04:49 GMT-0700 (Pacific Daylight Time)">20:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">I see.  And when should run jobs be called, typically?</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Tue Oct 18 2022 13:06:22 GMT-0700 (Pacific Daylight Time)">20:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Roughly speaking, you run some JS, it may or may not put some jobs into the queue, and then when the initial JS is done, you call RunJobs to drain the queue.</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Tue Oct 18 2022 13:06:41 GMT-0700 (Pacific Daylight Time)">20:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">OK.  I will try it</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Tue Oct 18 2022 13:11:13 GMT-0700 (Pacific Daylight Time)">20:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">I get that the SpiderMonkey MDN is hard to keep up to date but why was it all scrapped? I can see archives of it and it's incredibly good and useful.</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Tue Oct 18 2022 13:42:03 GMT-0700 (Pacific Daylight Time)">20:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">Not our decision. MDN only documents web features nowadays </td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Tue Oct 18 2022 14:14:38 GMT-0700 (Pacific Daylight Time)">21:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">we really ought to grab an archive and extract the JSAPI stuff that's still relevant</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Tue Oct 18 2022 14:15:17 GMT-0700 (Pacific Daylight Time)">21:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">I did a pass a couple of years ago and included a lot of what was still relevant in spidermonkey-embedders-docs</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Tue Oct 18 2022 14:15:35 GMT-0700 (Pacific Daylight Time)">21:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">oh! that sounds like the right place, then</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Tue Oct 18 2022 14:15:52 GMT-0700 (Pacific Daylight Time)">21:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">(but not the API docs for individual functions, since there was very little that wasn't obsolete by that point)</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Tue Oct 18 2022 15:52:12 GMT-0700 (Pacific Daylight Time)">22:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">Using RunJobs to execute the job queue, is there a way to make sure each of those jobs finishes?</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Tue Oct 18 2022 16:01:45 GMT-0700 (Pacific Daylight Time)">23:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">kfjvj</span>: If you're using the internal job queue, then I believe they should all run to completion unless one of them calls <a href="https://searchfox.org/mozilla-central/source/js/src/vm/JSContext.cpp#810">StopDrainingJobQueue</a></td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Tue Oct 18 2022 16:04:47 GMT-0700 (Pacific Daylight Time)">23:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-15">kfjvj</span>: If you're using the internal job queue, then I believe they should all run to completion unless one of them calls <a href="https://searchfox.org/mozilla-central/source/js/src/vm/JSContext.cpp#810">StopDrainingJobQueue</a></blockquote></mx-reply>Does it automatically wait for all jobs to complete, even the results of nested promises?</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Tue Oct 18 2022 16:05:09 GMT-0700 (Pacific Daylight Time)">23:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell"><p>For instance, if I call this function:</p>
<pre><code>async function testFn(prom) {
            print("Before waiting for promise.");
            var s = await prom;
            print(`Received promise value: ${s}`);
        }
</code></pre>
</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Tue Oct 18 2022 16:05:35 GMT-0700 (Pacific Daylight Time)">23:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">I think it should</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Tue Oct 18 2022 16:05:42 GMT-0700 (Pacific Daylight Time)">23:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Is something not working for you?</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Tue Oct 18 2022 16:06:48 GMT-0700 (Pacific Daylight Time)">23:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell"><p>Here's some test code I'm using:</p>
<pre><code>bool TestFutures(JSContext* ctx, JS::HandleObject global) {

    char testCode[] = R"js(
        async function testFn(prom) {
            print("Before waiting for promise.");
            var s = await prom;
            print(`Received promise value: ${s}`);
        }
        testFn;
    )js";

    JS::RootedValue testFn(ctx);
    if (!ExecuteCode(ctx, testCode, &amp;testFn)) {
        return false;
    }

    JS::RootedValueVector args(ctx);
    JS::RootedValue retVal(ctx);

    JS::RootedValue jsPromise(ctx, ToJs(ctx, Demo_JS::ReturnStringInMilliseconds("Hello", 2000)));

    if (!args.append(jsPromise) || !JS_CallFunctionValue(ctx, global, testFn, args, &amp;retVal)){
        return false;
    }
    js::RunJobs(ctx);

    std::this_thread::sleep_for(std::chrono::milliseconds(5000));

    return true;
}
</code></pre>
</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Tue Oct 18 2022 16:07:22 GMT-0700 (Pacific Daylight Time)">23:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">I have to use that thread sleep statement at the end to make sure jsPromise actually completed after 2 seconds.</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Tue Oct 18 2022 16:07:50 GMT-0700 (Pacific Daylight Time)">23:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">It looks like you are running jobs before sleeping?</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Tue Oct 18 2022 16:08:20 GMT-0700 (Pacific Daylight Time)">23:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">If I don't sleep, the function exits scope, shuts down JS, and there's a segfault</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Tue Oct 18 2022 16:08:47 GMT-0700 (Pacific Daylight Time)">23:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">So assuming that <code>ReturnStringInMilliseconds</code> resolves a promise after 2000 ms, there's nothing in the job queue when you call RunJobs</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Tue Oct 18 2022 16:09:16 GMT-0700 (Pacific Daylight Time)">23:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">oh, I thought calling an async function implicitly added things to the job queue</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Tue Oct 18 2022 16:10:21 GMT-0700 (Pacific Daylight Time)">23:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">On line 9, is it just me, or are you not actually calling <code>testFn</code>?</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Tue Oct 18 2022 16:11:14 GMT-0700 (Pacific Daylight Time)">23:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">Line 9 will ensure that testFn is the return value from ExecuteCode, which I store in the c++ testFn variable.</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Tue Oct 18 2022 16:11:19 GMT-0700 (Pacific Daylight Time)">23:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Ah, got it</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Tue Oct 18 2022 16:15:10 GMT-0700 (Pacific Daylight Time)">23:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I think <code>retVal</code> would contain the Promise for testFn. I'm guessing you need to call <code>js::EnqueueJob(cx, testFn)</code> before calling <code>js::RunJobs</code>.</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Tue Oct 18 2022 16:15:43 GMT-0700 (Pacific Daylight Time)">23:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I think <code>retVal</code> would contain the Promise for testFn. I'm guessing you need to call <code>js::EnqueueJob(cx, testFn)</code> before calling <code>js::RunJobs</code>.</blockquote></mx-reply>OK I'll try that</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Tue Oct 18 2022 16:23:10 GMT-0700 (Pacific Daylight Time)">23:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">Now something strange is happening: Runjobs causes a segfault when jobs are enqueued</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Tue Oct 18 2022 16:25:00 GMT-0700 (Pacific Daylight Time)">23:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell"><p>When I run this code, the last thing that's output is "Jobs starting".  Then it waits 2 seconds and segfaults.</p>
<pre><code>bool TestFutures(JSContext* ctx, JS::HandleObject global) {

    char testCode[] = R"js(
        async function testFn(prom) {
            print("Before waiting for promise.");
            var s = await prom;
            print(`Received promise value: ${s}`);
        }
        testFn;
    )js";

    JS::RootedValue testFn(ctx);
    if (!ExecuteCode(ctx, testCode, &amp;testFn)) {
        return false;
    }

    JS::RootedValueVector args(ctx);
    JS::RootedValue retVal(ctx);

    JS::RootedValue jsPromise(ctx, ToJs(ctx, Demo_JS::ReturnStringInMilliseconds("Hello", 2000)));

    if (!args.append(jsPromise) || !JS_CallFunctionValue(ctx, global, testFn, args, &amp;retVal)){
        return false;
    }
    JS::RootedObject promiseObj(ctx, jsPromise.toObjectOrNull());
    JS::RootedObject retValObj(ctx, retVal.toObjectOrNull());
    js::EnqueueJob(ctx, promiseObj);
    js::EnqueueJob(ctx, retValObj);
    cout &lt;&lt; "Jobs starting" &lt;&lt; endl;
    js::RunJobs(ctx);
    cout &lt;&lt; "Jobs done" &lt;&lt; endl;

    std::this_thread::sleep_for(std::chrono::milliseconds(5000));

    return true;
}
</code></pre>
</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Tue Oct 18 2022 16:30:40 GMT-0700 (Pacific Daylight Time)">23:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">but this still seems a little odd; what does <code>ReturnStringInMilliseconds</code> do? I'm guessing it sleeps for 2sec then returns its value, blocking anything else from happening on the thread during that time. Which isn't really async. I would think the "right way" would be for <code>ReturnStringInMilliseconds</code> to remember when its deadline is, then your <code>RunJobs</code> call would see an empty queue and immediately return, and then you would have some <code>select/poll</code> loop or similar that would wait until the deadline, at which point you would call <code>RunJobs</code> again. I think?</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Tue Oct 18 2022 16:32:11 GMT-0700 (Pacific Daylight Time)">23:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> but this still seems a little odd; what does <code>ReturnStringInMilliseconds</code> do? I'm guessing it sleeps for 2sec then returns its value, blocking anything else from happening on the thread during that time. Which isn't really async. I would think the "right way" would be for <code>ReturnStringInMilliseconds</code> to remember when its deadline is, then your <code>RunJobs</code> call would see an empty queue and immediately return, and then you would have some <code>select/poll</code> loop or similar that would wait until the deadline, at which point you would call <code>RunJobs</code> again. I think?</blockquote></mx-reply>ReturnSTringInMilliseconds operates from a different thread, but I suppose the promise object waiting for it would just block on the current thread until it's finished</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Tue Oct 18 2022 16:32:48 GMT-0700 (Pacific Daylight Time)">23:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">yeah, all the interesting stuff pretty much has to happen on the original JS thread</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Tue Oct 18 2022 16:33:16 GMT-0700 (Pacific Daylight Time)">23:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">And it does work well, but only if I add in that extra sleep statement</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Tue Oct 18 2022 16:36:23 GMT-0700 (Pacific Daylight Time)">23:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">it seems like it does "work", I'm not sure about the "well" part given that it sounds pretty synchronous. ;-) I'm actually not sure why it would seg fault; I would assume that shutting down JS without clearing the job queue would be ok. Even though you'd prefer it to wait somehow. (But you're responsible for the waiting.)</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Tue Oct 18 2022 16:36:48 GMT-0700 (Pacific Daylight Time)">23:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">but that's the thing... it doesn't even get to the sleep statement if there's anything in the queue</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Tue Oct 18 2022 16:37:25 GMT-0700 (Pacific Daylight Time)">23:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">which sleep statement? The one in <code>ReturnStringInMilliseconds</code>?</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Tue Oct 18 2022 16:37:41 GMT-0700 (Pacific Daylight Time)">23:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">the one at the end of the function I sent above</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Tue Oct 18 2022 16:38:47 GMT-0700 (Pacific Daylight Time)">23:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I'm not understanding something. You're saying that if you delete <code>RunJobs</code> and leave everything else as you pasted above, that it seg faults... when?</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Tue Oct 18 2022 16:39:22 GMT-0700 (Pacific Daylight Time)">23:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">it segfaults only if I enqueue jobs </td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Tue Oct 18 2022 16:39:39 GMT-0700 (Pacific Daylight Time)">23:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">actually, wait a minute</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Tue Oct 18 2022 16:40:18 GMT-0700 (Pacific Daylight Time)">23:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">ok there are a few other issues here.  I'll have to look into them before I come back.

But thatnks everyone for the help.  I actually made some progress on this thing.</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Tue Oct 18 2022 16:40:30 GMT-0700 (Pacific Daylight Time)">23:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">ok, good luck!</td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Tue Oct 18 2022 16:45:48 GMT-0700 (Pacific Daylight Time)">23:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">upon rereading my sketch above, I don't think the end part is right. You wouldn't just call <code>RunJobs</code>, since nothing was ever enqueued. You would either resolve the promise (associated with the deadline) directly, or you would (after the <code>select</code> returns) call <code>EnqueueJob</code> with it. Then at the end of your event loop, which would be "immediately" from the standpoint of JS stuff, you'd call <code>RunJobs</code> to drain the queue that now contains the promise.</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Tue Oct 18 2022 16:46:25 GMT-0700 (Pacific Daylight Time)">23:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> upon rereading my sketch above, I don't think the end part is right. You wouldn't just call <code>RunJobs</code>, since nothing was ever enqueued. You would either resolve the promise (associated with the deadline) directly, or you would (after the <code>select</code> returns) call <code>EnqueueJob</code> with it. Then at the end of your event loop, which would be "immediately" from the standpoint of JS stuff, you'd call <code>RunJobs</code> to drain the queue that now contains the promise.</blockquote></mx-reply>what's the 'select'?</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Tue Oct 18 2022 16:46:38 GMT-0700 (Pacific Daylight Time)">23:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">your embedding's event loop</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Tue Oct 18 2022 16:47:09 GMT-0700 (Pacific Daylight Time)">23:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> your embedding's event loop</blockquote></mx-reply>I'm not clear on what you mean</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Tue Oct 18 2022 16:47:22 GMT-0700 (Pacific Daylight Time)">23:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">what OS are you on? I'm talking *nix terminology.</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Tue Oct 18 2022 16:47:55 GMT-0700 (Pacific Daylight Time)">23:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">yeah, I'm on Linux</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Tue Oct 18 2022 16:48:40 GMT-0700 (Pacific Daylight Time)">23:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">ok, then if you're doing anything involving async stuff, then you need some event loop that does whatever is pending to do, and if there's nothing pending, it waits some amount of time. Forever, if there's nothing to wait for. Otherwise, until the next soonest deadline.</td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Tue Oct 18 2022 16:48:53 GMT-0700 (Pacific Daylight Time)">23:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">OK</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Tue Oct 18 2022 16:49:09 GMT-0700 (Pacific Daylight Time)">23:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">it might also be waiting for messages on sockets or whatever</td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Tue Oct 18 2022 16:49:43 GMT-0700 (Pacific Daylight Time)">23:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">OK I'll have to find a way to deal with that.  The specific implementation of GetStringAfteMillis doesn't really matter.  This is just a dummy test case, and the system I'm writing should be able to work on arbitrary future objects passed to it</td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Tue Oct 18 2022 16:50:04 GMT-0700 (Pacific Daylight Time)">23:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I guess <code>select</code> is kind of old school. <a href="https://www.man7.org/linux/man-pages/man2/poll.2.html"><code>poll</code></a> is probably a better example.</td></tr>
  <tr class="msg" id="L72"><td class="ts-cell"><a class="ts" href="#L72" alt="Tue Oct 18 2022 16:50:16 GMT-0700 (Pacific Daylight Time)">23:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">OK, thanks. </td></tr>
  <tr class="msg" id="L73"><td class="ts-cell"><a class="ts" href="#L73" alt="Tue Oct 18 2022 16:51:38 GMT-0700 (Pacific Daylight Time)">23:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">so you have an event loop which is roughly <code>while (true) { todo = poll(fds that matter, timeout=min(deadlines)); if (timed out) { resolve the promise associated with that deadline; } else { handle the fd that became active; }; }</code></td></tr>
  <tr class="msg" id="L74"><td class="ts-cell"><a class="ts" href="#L74" alt="Tue Oct 18 2022 16:52:11 GMT-0700 (Pacific Daylight Time)">23:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">or perhaps <code>while (true) { todo = poll(fds that matter, timeout=min(deadlines)); if (timed out) { enqueue the promise associated with that deadline; } else { handle the fd that became active; }; RunJobs(); }</code></td></tr>
  <tr class="msg" id="L75"><td class="ts-cell"><a class="ts" href="#L75" alt="Tue Oct 18 2022 16:52:46 GMT-0700 (Pacific Daylight Time)">23:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">I won't have access to deadlines</td></tr>
  <tr class="msg" id="L76"><td class="ts-cell"><a class="ts" href="#L76" alt="Tue Oct 18 2022 16:53:26 GMT-0700 (Pacific Daylight Time)">23:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">it would be some global-ish mapping that you would create and manage. You'd insert into it in eg <code>ReturnStringInMilliseconds</code>.</td></tr>
  <tr class="msg" id="L77"><td class="ts-cell"><a class="ts" href="#L77" alt="Tue Oct 18 2022 16:54:27 GMT-0700 (Pacific Daylight Time)">23:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">Like I said, that string function is just a dummy. This is to be integrated into a much larger API that already has its own Future objects that I have to handle, and I won't have any influence on how those are implemented.</td></tr>
  <tr class="msg" id="L78"><td class="ts-cell"><a class="ts" href="#L78" alt="Tue Oct 18 2022 16:54:53 GMT-0700 (Pacific Daylight Time)">23:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">if that's the case, does that other API already have an event loop?</td></tr>
  <tr class="msg" id="L79"><td class="ts-cell"><a class="ts" href="#L79" alt="Tue Oct 18 2022 16:55:32 GMT-0700 (Pacific Daylight Time)">23:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">I honestly am not sure.  I'm really just working from the Future interface they've given me.  It's not much more than a wrapper around std::future</td></tr>
  <tr class="msg" id="L80"><td class="ts-cell"><a class="ts" href="#L80" alt="Tue Oct 18 2022 16:56:07 GMT-0700 (Pacific Daylight Time)">23:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">you can think of what I'm doing as close to trying to convert an arbitrary std::future object to a JS promise object and have it work</td></tr>
  <tr class="msg" id="L81"><td class="ts-cell"><a class="ts" href="#L81" alt="Tue Oct 18 2022 16:56:50 GMT-0700 (Pacific Daylight Time)">23:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">I don't think I have any influence on how exactly those futures are completed.  It could be from an IO event, from another thread, who knows...</td></tr>
  <tr class="msg" id="L82"><td class="ts-cell"><a class="ts" href="#L82" alt="Tue Oct 18 2022 16:57:45 GMT-0700 (Pacific Daylight Time)">23:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">sounds like it'd be worth finding out, how do users of that Future interface in C++ programs wait for the futures to be completed</td></tr>
  <tr class="msg" id="L83"><td class="ts-cell"><a class="ts" href="#L83" alt="Tue Oct 18 2022 16:58:39 GMT-0700 (Pacific Daylight Time)">23:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">yeah, you'll need to understand whatever is calling <code>std::future&lt;T&gt;::wait_for</code> or <code>std::future&lt;T&gt;::wait_until</code>.</td></tr>
  <tr class="msg" id="L84"><td class="ts-cell"><a class="ts" href="#L84" alt="Tue Oct 18 2022 16:59:06 GMT-0700 (Pacific Daylight Time)">23:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I'm not sure how you typically handle multiple futures, unless you somehow wrap them up together or something?</td></tr>
  <tr class="msg" id="L85"><td class="ts-cell"><a class="ts" href="#L85" alt="Tue Oct 18 2022 16:59:15 GMT-0700 (Pacific Daylight Time)">23:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I've never used <code>std::future</code></td></tr>
  <tr class="msg" id="L86"><td class="ts-cell"><a class="ts" href="#L86" alt="Tue Oct 18 2022 16:59:22 GMT-0700 (Pacific Daylight Time)">23:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">I haven't used it much either.</td></tr>
  <tr class="msg" id="L87"><td class="ts-cell"><a class="ts" href="#L87" alt="Tue Oct 18 2022 16:59:43 GMT-0700 (Pacific Daylight Time)">23:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">OK, this has certainly given me a lot to think about.  I'll have to follow up with my team.</td></tr>

</tbody></table></div></div></div>
</body></html>