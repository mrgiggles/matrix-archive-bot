<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2022-08-10</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2022-08-10<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-08-09" class="nav-link"><span>prev</span></a>
<a href="2022-08-11" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Aug 10 2022 07:21:09 GMT-0700 (Pacific Daylight Time)">14:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@bthrall:mozilla.org">Bryan Thrall [:bthrall]</span>&gt;</div></td><td class="msg-cell"><p>Is it possible to have multiple threads using SpiderMonkey? I understand I need to have a <code>JSContext</code> for each thread, and I know about SpiderMonkey's internal helper threads (but that's not what I'm asking about).</p>
<p>Is using multiple threads like that useful to anyone?<br>(asking out of curiosity)</p>
</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Aug 10 2022 07:36:13 GMT-0700 (Pacific Daylight Time)">14:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-7">Bryan Thrall [:bthrall]</span>: You can create <a href="https://developer.mozilla.org/en-US/docs/Web/API/Worker">worker threads</a> that each get their own context</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Aug 10 2022 07:37:41 GMT-0700 (Pacific Daylight Time)">14:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">They have to communicate via message passing</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Aug 10 2022 07:38:32 GMT-0700 (Pacific Daylight Time)">14:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">There was also an attempt years ago called PJS to make SM support multithreaded JS, but AFAIK it's mostly been ripped out</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Aug 10 2022 07:39:10 GMT-0700 (Pacific Daylight Time)">14:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">My understanding is that some of the wrapper types in JS::Context (<code>js::ContextData</code>) are a remnant of that</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Aug 10 2022 07:39:14 GMT-0700 (Pacific Daylight Time)">14:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">But it was all before my time</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Aug 10 2022 07:41:43 GMT-0700 (Pacific Daylight Time)">14:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">(<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1325050">Example bug</a>)</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Aug 10 2022 07:43:09 GMT-0700 (Pacific Daylight Time)">14:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@bthrall:mozilla.org">Bryan Thrall [:bthrall]</span>&gt;</div></td><td class="msg-cell">Thanks, <span class="nick-4">iain</span> !</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed Aug 10 2022 08:19:38 GMT-0700 (Pacific Daylight Time)">15:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">in the JS shell you can use <code>evalInWorker(code)</code></td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed Aug 10 2022 08:22:39 GMT-0700 (Pacific Daylight Time)">15:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">(the bug mentioned above was for Quantum DOM, the idea was to have multiple threads running JS in parallel for separate websites / tabs instead of everything on the main thread.. It was complicated and e10s-multi and Fission mostly made it not relevant anymore)</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed Aug 10 2022 08:47:51 GMT-0700 (Pacific Daylight Time)">15:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">sfink</span>: ping</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed Aug 10 2022 09:58:41 GMT-0700 (Pacific Daylight Time)">16:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@krosylight:mozilla.org">krosylight</span>&gt;</div></td><td class="msg-cell">Hey people, is it safe to <code>new T[]</code> and pass it to <code>JS::NewArrayBufferWithContents</code>? It seems some callers use <code>JS_malloc</code> or <code>js_pod_arena_malloc</code>, but what's the differences there?</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed Aug 10 2022 10:03:43 GMT-0700 (Pacific Daylight Time)">17:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">hm, that would want to be freed with delete[] but it'll get passed to <code>free</code> instead</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed Aug 10 2022 10:06:47 GMT-0700 (Pacific Daylight Time)">17:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@krosylight:mozilla.org">krosylight</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> hm, that would want to be freed with delete[] but it'll get passed to <code>free</code> instead</blockquote></mx-reply>Ah yes, sure.</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed Aug 10 2022 10:08:03 GMT-0700 (Pacific Daylight Time)">17:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">the memory gets freed with <a href="https://searchfox.org/mozilla-central/source/js/src/vm/ArrayBufferObject.cpp#947-948">https://searchfox.org/mozilla-central/source/js/src/vm/ArrayBufferObject.cpp#947-948</a></td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Wed Aug 10 2022 10:10:50 GMT-0700 (Pacific Daylight Time)">17:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">which <a href="https://searchfox.org/mozilla-central/rev/43ba67391e71c57a14420e554e9d381543292611/js/public/Utility.h#409-414">calls js_free</a>, which has a scary comment about arenas (probably largely for this case!)</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Wed Aug 10 2022 10:11:52 GMT-0700 (Pacific Daylight Time)">17:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">the other option is JS::NewExternalArrayBuffer, which would allow you to provide your own free function that could do the <code>delete[]</code></td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Wed Aug 10 2022 10:13:29 GMT-0700 (Pacific Daylight Time)">17:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@krosylight:mozilla.org">krosylight</span>&gt;</div></td><td class="msg-cell">I think I don't need that much, I just want to know what's the right way to allocate memory for NewArrayBufferWithContents and do that</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Wed Aug 10 2022 10:13:56 GMT-0700 (Pacific Daylight Time)">17:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><code>JS_malloc</code> would be safe</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Wed Aug 10 2022 10:14:15 GMT-0700 (Pacific Daylight Time)">17:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@krosylight:mozilla.org">krosylight</span>&gt;</div></td><td class="msg-cell"><pre><code>static inline void js_free(void* p) {
  // TODO: This should call |moz_arena_free(js::MallocArena, p)| but we
  // currently can't enforce that all memory freed here was allocated by
  // js_malloc().
  free(p);
}
</code></pre>
<p>This sounds like the existing things like <code>js_pod_arena_malloc&lt;char&gt;(js::ArrayBufferContentsArena, blobSize)</code> is wrong ðŸ¤”</p>
</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Wed Aug 10 2022 10:15:15 GMT-0700 (Pacific Daylight Time)">17:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">you make a good point</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Wed Aug 10 2022 10:16:40 GMT-0700 (Pacific Daylight Time)">17:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@krosylight:mozilla.org">krosylight</span>&gt;</div></td><td class="msg-cell">Okay thanks, I'll go JS_malloc for my purpose. But it seems some existing things should be reviewed again</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Wed Aug 10 2022 10:19:11 GMT-0700 (Pacific Daylight Time)">17:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">bug 1052582 suggests that those other allocations are correct</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Wed Aug 10 2022 10:19:13 GMT-0700 (Pacific Daylight Time)">17:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1052582">https://bugzil.la/1052582</a> â€” RESOLVED (mhowell) â€” Store non-inline JS array buffer contents in their own malloc arena</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Wed Aug 10 2022 10:20:39 GMT-0700 (Pacific Daylight Time)">17:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">we probably ought to provide <code>JS::MallocForArrayBuffer</code> or something. <code>js_pod_arena_malloc&lt;char&gt;(js::ArrayBufferContentsArena, blobSize)</code> is a bit ugly.</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Wed Aug 10 2022 10:24:35 GMT-0700 (Pacific Daylight Time)">17:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">Filed bug 1784116</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Wed Aug 10 2022 10:24:37 GMT-0700 (Pacific Daylight Time)">17:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1784116">https://bugzil.la/1784116</a> â€” NEW (nobody) â€” Expose JS::MallocForArrayBuffer</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Wed Aug 10 2022 11:17:05 GMT-0700 (Pacific Daylight Time)">18:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@krosylight:mozilla.org">krosylight</span>&gt;</div></td><td class="msg-cell">Does that mean the comment in js_free should be revised?</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Wed Aug 10 2022 11:20:11 GMT-0700 (Pacific Daylight Time)">18:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1052582">https://bugzil.la/1052582</a> â€” RESOLVED (mhowell) â€” Store non-inline JS array buffer contents in their own malloc arena</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Wed Aug 10 2022 11:51:19 GMT-0700 (Pacific Daylight Time)">18:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell">how long does the commit access level 1 take?</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Wed Aug 10 2022 14:37:23 GMT-0700 (Pacific Daylight Time)">21:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">at most 1 week maybe?</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Wed Aug 10 2022 14:51:01 GMT-0700 (Pacific Daylight Time)">21:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rick.button:matrix.org">rickbutton</span>&gt;</div></td><td class="msg-cell">hi, I'm looking at this very old bugzilla: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=709909">https://bugzilla.mozilla.org/show_bug.cgi?id=709909</a> and want to look at the revisions mentioned in the comments , but it looks like the revision is no longer available? <a href="https://hg.mozilla.org/projects/larch/rev/ca2d2123be37">https://hg.mozilla.org/projects/larch/rev/ca2d2123be37</a> . I assume that it was lost in some migration at some point. Does anyone know where I could find it?</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Wed Aug 10 2022 15:03:51 GMT-0700 (Pacific Daylight Time)">22:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rick.button:matrix.org">rickbutton</span>&gt;</div></td><td class="msg-cell">i see that its actually a part of the "larch" project folder, but not sure what that means in this context</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Wed Aug 10 2022 15:05:01 GMT-0700 (Pacific Daylight Time)">22:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">rickbutton</span>: incremental GC was probably developed on a different HG repository, then when it was finished all of the work was rolled up into the patches in bug 641025, or something like that.</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Wed Aug 10 2022 15:05:02 GMT-0700 (Pacific Daylight Time)">22:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/641025">https://bugzil.la/641025</a> â€” RESOLVED (billm) â€” Incremental GC</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Wed Aug 10 2022 15:05:33 GMT-0700 (Pacific Daylight Time)">22:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rick.button:matrix.org">rickbutton</span>&gt;</div></td><td class="msg-cell">oh interesting!</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Wed Aug 10 2022 15:06:13 GMT-0700 (Pacific Daylight Time)">22:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell">Are you seeing a crash with the same signature? It is probably unrelated to whatever this was.</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Wed Aug 10 2022 15:07:48 GMT-0700 (Pacific Daylight Time)">22:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rick.button:matrix.org">rickbutton</span>&gt;</div></td><td class="msg-cell">yes precisely this stack in our embedding</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Wed Aug 10 2022 15:08:54 GMT-0700 (Pacific Daylight Time)">22:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rick.button:matrix.org">rickbutton</span>&gt;</div></td><td class="msg-cell">but if it was rolled into that igc bug then its probably already in my version of spidermonkey (13)</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Wed Aug 10 2022 15:09:39 GMT-0700 (Pacific Daylight Time)">22:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell">Yeah, unfortunately lots of random memory corruption issues can end up showing up as crashes in the GC somewhere.</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Wed Aug 10 2022 15:09:44 GMT-0700 (Pacific Daylight Time)">22:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rick.button:matrix.org">rickbutton</span>&gt;</div></td><td class="msg-cell">i actually haven't tested with IGC off yet so TBD</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Wed Aug 10 2022 15:10:19 GMT-0700 (Pacific Daylight Time)">22:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rick.button:matrix.org">rickbutton</span>&gt;</div></td><td class="msg-cell">ty for the pointer!</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Wed Aug 10 2022 16:14:10 GMT-0700 (Pacific Daylight Time)">23:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell"><p><code>hg commit --amend</code></p>
<pre><code>Processing 1 file(s)...
nothing changed
</code></pre>
</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Wed Aug 10 2022 16:14:23 GMT-0700 (Pacific Daylight Time)">23:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell">has any one faced this before </td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Wed Aug 10 2022 16:14:45 GMT-0700 (Pacific Daylight Time)">23:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell">I can't modify my previous commit.</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Wed Aug 10 2022 16:25:47 GMT-0700 (Pacific Daylight Time)">23:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">what does <code>hg diff</code> show? You're sure that there are pending changes?</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Wed Aug 10 2022 16:26:31 GMT-0700 (Pacific Daylight Time)">23:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell">It shows the changes that I want to make to the previous patch </td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Wed Aug 10 2022 16:26:55 GMT-0700 (Pacific Daylight Time)">23:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell">It's just a comment I want to modify it. </td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Wed Aug 10 2022 16:28:01 GMT-0700 (Pacific Daylight Time)">23:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">Huh. I use <code>hg amend</code> from the evolve extension, but <code>hg commit --amend</code> seems like it ought to work. What if you give the path on the command line? <code>hg commit --amend path/to/changed/file</code> (I'm just hoping for a useful error message.)</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Wed Aug 10 2022 16:29:37 GMT-0700 (Pacific Daylight Time)">23:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <p><code>hg commit --amend</code></p>
<pre><code>Processing 1 file(s)...
nothing changed
</code></pre>
</blockquote></mx-reply>The same</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Wed Aug 10 2022 16:29:50 GMT-0700 (Pacific Daylight Time)">23:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell">It creates a new diff</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Wed Aug 10 2022 16:31:41 GMT-0700 (Pacific Daylight Time)">23:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">does <code>hg status</code> show the file as changed?</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Wed Aug 10 2022 16:31:58 GMT-0700 (Pacific Daylight Time)">23:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell">Yes </td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Wed Aug 10 2022 16:32:51 GMT-0700 (Pacific Daylight Time)">23:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell">If I modified the file and then `hg commit - - amend`</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Wed Aug 10 2022 16:33:03 GMT-0700 (Pacific Daylight Time)">23:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell">It ignores the changes </td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Wed Aug 10 2022 16:33:35 GMT-0700 (Pacific Daylight Time)">23:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell">If <code>hg commit --amend</code> and then modify</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Wed Aug 10 2022 16:33:41 GMT-0700 (Pacific Daylight Time)">23:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell">it creates a new diff</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Wed Aug 10 2022 16:33:50 GMT-0700 (Pacific Daylight Time)">23:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell">the status is changed </td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Wed Aug 10 2022 16:34:22 GMT-0700 (Pacific Daylight Time)">23:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">what do you mean by "it creates a new diff"?</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Wed Aug 10 2022 16:34:26 GMT-0700 (Pacific Daylight Time)">23:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><code>hg diff</code> output changes?</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Wed Aug 10 2022 16:34:35 GMT-0700 (Pacific Daylight Time)">23:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell">Yes </td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Wed Aug 10 2022 16:35:23 GMT-0700 (Pacific Daylight Time)">23:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">huh. I don't know what's going on. You could try <code>hg debugrebuilddirstate</code>, though I'm doubtful it will do anything.</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Wed Aug 10 2022 16:36:09 GMT-0700 (Pacific Daylight Time)">23:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">maybe try making an additional change to the same file and see if it will accept it? You can then amend it back.</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Wed Aug 10 2022 16:37:03 GMT-0700 (Pacific Daylight Time)">23:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">or the more involved approach: create a new commit with your changes, then use <code>hg histedit</code> to "roll" it into the previous commit.</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Wed Aug 10 2022 16:37:15 GMT-0700 (Pacific Daylight Time)">23:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I feel like I'm missing something obvious, though.</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Wed Aug 10 2022 16:38:02 GMT-0700 (Pacific Daylight Time)">23:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> or the more involved approach: create a new commit with your changes, then use <code>hg histedit</code> to "roll" it into the previous commit.</blockquote></mx-reply>I will try this</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Wed Aug 10 2022 16:38:14 GMT-0700 (Pacific Daylight Time)">23:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@mohamed_atef:matrix.org">Mohamed Atef</span>&gt;</div></td><td class="msg-cell">Thanks.</td></tr>

</tbody></table></div></div></div>
</body></html>