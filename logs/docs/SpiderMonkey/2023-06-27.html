<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2023-06-27</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2023-06-27<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2023-06-26" class="nav-link"><span>prev</span></a>
<a href="2023-06-28" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Jun 27 2023 09:42:14 GMT-0700 (Pacific Daylight Time)">16:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">What's our policy with slow tests? Which is to say, if I were to mark a slow test as slow, will it ever actually get run in integration, or is it effectively black-holed until one of us tries running jit-test with the enable-slow arg?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Jun 27 2023 10:47:14 GMT-0700 (Pacific Daylight Time)">17:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><span class="nick-7">Bryan Thrall [:bthrall]</span>: When working in the parser where we have a FrontendContext, is it expected you can't get access to the runtime?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Jun 27 2023 10:47:29 GMT-0700 (Pacific Daylight Time)">17:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">Or should one have access to JSRuntime*? </td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue Jun 27 2023 10:54:56 GMT-0700 (Pacific Daylight Time)">17:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><span class="nick-7">Bryan Thrall [:bthrall]</span>: (about to head to lunch myself; to be clear about the specific issue I've run into: Import assertions has a public API call to <a href="https://searchfox.org/mozilla-central/source/js/public/Modules.h#49-50">set the supported assertion types</a>. However, it seems the parser actually <a href="https://searchfox.org/mozilla-central/source/js/src/builtin/ModuleObject.cpp#1678">looks this up on the FrontendContext</a>. However, currently I don't think there's connective code which takes the runtime's list and <a href="https://searchfox.org/mozilla-central/source/js/src/frontend/FrontendContext.cpp#44-52">puts it on the FrontendContext</a>. I'm trying to figure out 1) if the cut between the RT and the FrontendContext makes sense, and 2) where I would actually do said initialization. Sort of feels like FrontendContext should take a runtime as a constructor argument, but that doesn't totally work, because of the use of FrontendContext in IsValidJSON impl.)</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Tue Jun 27 2023 10:55:48 GMT-0700 (Pacific Daylight Time)">17:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">(It turns out that the import assertion tests weren't running properly, hence why this hadn't been caught yet)</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Tue Jun 27 2023 11:27:55 GMT-0700 (Pacific Daylight Time)">18:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@bthrall:mozilla.org">Bryan Thrall [:bthrall]</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">mgaudet</span>: You are correct, there is no connective code which copies the runtime's list to the FrontendContext. The intention was to use <a href="https://searchfox.org/mozilla-central/source/js/src/frontend/FrontendContext.h#135-136">setSupportedImportAssertions()</a> when necessary, but I think that got lost somewhere along the way.</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Tue Jun 27 2023 11:29:33 GMT-0700 (Pacific Daylight Time)">18:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@bthrall:mozilla.org">Bryan Thrall [:bthrall]</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-7">Bryan Thrall [:bthrall]</span>: When working in the parser where we have a FrontendContext, is it expected you can't get access to the runtime?</blockquote></mx-reply>You might be able to access the runtime (if <code>maybeCurrentJSContext()</code> returns a <code>JSContext</code>), but not always.</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Tue Jun 27 2023 11:52:26 GMT-0700 (Pacific Daylight Time)">18:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@jkratzer:mozilla.org">jkratzer</span>&gt;</div></td><td class="msg-cell">Hi all.  I'm in the process of writing an advisory for <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1834711">https://bugzilla.mozilla.org/show_bug.cgi?id=1834711</a>.  Can anyone tell me, is this a memory corruption issue or an issue with accessing another compartment?</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Tue Jun 27 2023 12:32:05 GMT-0700 (Pacific Daylight Time)">19:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Hi all.  I'm in the process of writing an advisory for <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1834711">https://bugzilla.mozilla.org/show_bug.cgi?id=1834711</a>.  Can anyone tell me, is this a memory corruption issue or an issue with accessing another compartment?</blockquote></mx-reply>Yeah, I think the possible issue here would be the GC getting confused and that leading to some kind of memory corruption or UAF kind of thing.</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Tue Jun 27 2023 12:35:06 GMT-0700 (Pacific Daylight Time)">19:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@jkratzer:mozilla.org">jkratzer</span>&gt;</div></td><td class="msg-cell">Great.  Thanks <span class="nick-16">mccr8</span></td></tr>

</tbody></table></div></div></div>
</body></html>