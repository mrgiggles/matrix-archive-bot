<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2022-03-08</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2022-03-08<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-03-07" class="nav-link"><span>prev</span></a>
<a href="2022-03-09" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search SpiderMonkey">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Mar 08 2022 03:03:05 GMT-0800 (Pacific Standard Time)">11:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@standard8:mozilla.org">Standard8</span>&gt;</div></td><td class="msg-cell"><p>For the work for moving to ES modules, we've been concentrating on dropping <code>null</code> and <code>this</code> as the target arg to <code>ChromeUtils.import</code>.</p>
<p>Presumably it would also help to drop the second (target) arg completely?</p>
</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Mar 08 2022 03:38:36 GMT-0800 (Pacific Standard Time)">11:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">I think so. Everything that reduces the difference to ES modules helps</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Mar 08 2022 04:47:51 GMT-0800 (Pacific Standard Time)">12:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@l11d:mozilla.org">l11d</span>&gt;</div></td><td class="msg-cell">is there a MIR instruction just returning the input value? the problem I'm trying to solve is: a Phi node should select V1 when entering via BB1 and V2 when entering via BB2. V2 is the very value returned by the Phi, however I cannot (afaikt) use a phi as its own operand. because the phi instruction dominates BB2, a "copy this MIR value"-instruction should work</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue Mar 08 2022 04:56:31 GMT-0800 (Pacific Standard Time)">12:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">l11d</span>: Pretty sure you can use a phi as its own operand</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Tue Mar 08 2022 04:59:16 GMT-0800 (Pacific Standard Time)">12:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@l11d:mozilla.org">l11d</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">evilpie</span>: thanks, I'll give that another try</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Tue Mar 08 2022 06:09:57 GMT-0800 (Pacific Standard Time)">14:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">confession: Trying to reduce treeherder JavaScript source code by automatically starting firefox and comparing the console output. Let's see if <a href="https://github.com/MozillaSecurity/lithium">Lithium</a> can be used for that once all failures modes of Firefox are worked around â€¦</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Tue Mar 08 2022 06:10:00 GMT-0800 (Pacific Standard Time)">14:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell">Seen! Your update will eventually appear on <a href="https://robotzilla.github.io/histoire">https://robotzilla.github.io/histoire</a></td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Tue Mar 08 2022 07:59:09 GMT-0800 (Pacific Standard Time)">15:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">chaircrusher</span>, would you like to guide me on a usual build procedure for ESR78?</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Tue Mar 08 2022 08:02:31 GMT-0800 (Pacific Standard Time)">16:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell">going to need to download Rocky Linux <a href="https://rockylinux.org/">https://rockylinux.org/</a></td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Tue Mar 08 2022 08:05:05 GMT-0800 (Pacific Standard Time)">16:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell">oh, it's a distro of RHEL / CentOS</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Tue Mar 08 2022 08:12:38 GMT-0800 (Pacific Standard Time)">16:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell">wow, this is an impressive OS, can tell why you like it already wow</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Tue Mar 08 2022 08:26:15 GMT-0800 (Pacific Standard Time)">16:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> CENTOS8</blockquote></mx-reply>correction ^</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Tue Mar 08 2022 08:31:09 GMT-0800 (Pacific Standard Time)">16:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell">would like to know more about that particular fork or whatever, but that is a known issue and actually the reason why loss of support is coming for Node.js v18.x release line, sad to say and sad to see that happen</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Tue Mar 08 2022 09:03:42 GMT-0800 (Pacific Standard Time)">17:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> would like to know more about that particular fork or whatever, but that is a known issue and actually the reason why loss of support is coming for Node.js v18.x release line, sad to say and sad to see that happen</blockquote></mx-reply>this is what concerned me about all this: <a href="https://github.com/nodejs/nodejs.org/pull/4279">https://github.com/nodejs/nodejs.org/pull/4279</a> and there is a good video on youtube explaining the whole problem, so surprised that a way was found around that whole problem</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Tue Mar 08 2022 09:16:12 GMT-0800 (Pacific Standard Time)">17:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">l11d</span>: Do you mind if I create a meta bug for all the fuzzing you do in the JS engine?</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Tue Mar 08 2022 09:36:44 GMT-0800 (Pacific Standard Time)">17:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@l11d:mozilla.org">l11d</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">nbp</span>: not at all</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Tue Mar 08 2022 09:52:43 GMT-0800 (Pacific Standard Time)">17:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">l11d</span>: <a href="https://bugzil.la/l11d-js-fuzzing">Bug l11d-js-fuzzing</a> ;)</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Tue Mar 08 2022 10:35:23 GMT-0800 (Pacific Standard Time)">18:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@l11d:mozilla.org">l11d</span>&gt;</div></td><td class="msg-cell">more bugs than I could remember :D anyways, I'm still working to make the list longer</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Tue Mar 08 2022 13:01:51 GMT-0800 (Pacific Standard Time)">21:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell"><span class="nick-9">DerekNonGeneric</span>: I can tell you what we do, but you'll have to work out how to do it in your context.</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Tue Mar 08 2022 13:07:07 GMT-0800 (Pacific Standard Time)">21:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">If you check out gecko-dev from github:
git clone <a href="https://github.com/mozilla/gecko-dev.git">https://github.com/mozilla/gecko-dev.git</a>
cd gecko-dev
git checkout FIREFOX_ESR_78_10_X_RELBRANCH
Then follow the instructions here: <a href="https://firefox-source-docs.mozilla.org/js/build.html">https://firefox-source-docs.mozilla.org/js/build.html</a>

That seemed to not work very well to me so we fell back on the gnu/linux configure

cd gecko-dev/js/src
autoconf
cd ../..
mkdir js-build
cd js-build
../gecko-dev/js/src/configure &lt;config params&gt;
make</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Tue Mar 08 2022 13:14:16 GMT-0800 (Pacific Standard Time)">21:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">the caveats: the js configure script seems to require an obsolete version of autoconf.
<a href="http://ftp.gnu.org/gnu/autoconf/autoconf-2.13.tar.gz">http://ftp.gnu.org/gnu/autoconf/autoconf-2.13.tar.gz</a>
That's pretty straightforward, but you need install it somewhere and use it to configure the configure script.

the flags we use are --disable-jemalloc --with-system-zlib --with-system-icu
For debugging add --disable-optimize --enable-debug --enable-debug-symbols
For release --enable-optimize

In general you should compile it for release, even if you're compiling your program debug, because unless you're a mad genius like @evilpie there's not much sense you'll make out of stepping into the SpiderMonkey api calls.

There's some serious juju in there that really isn't for mere mortals to mess with, unless you want a job at Mozilla hacking the gecko source</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Tue Mar 08 2022 13:17:00 GMT-0800 (Pacific Standard Time)">21:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">anyone have anything to add?</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Tue Mar 08 2022 13:17:50 GMT-0800 (Pacific Standard Time)">21:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">Also I might add don't start from ESR78, we're stuck on that for the moment because we're working on our own code and porting up to the latest always takes me several days.</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Tue Mar 08 2022 13:19:03 GMT-0800 (Pacific Standard Time)">21:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">If I was starting today from a standing start, I'd use FIREFOX_ESR_91_6_X_RELBRANCH instead of ESR_78</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Tue Mar 08 2022 13:19:26 GMT-0800 (Pacific Standard Time)">21:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell">I just want to test out this workflow, not going to be permanent (have a few days down-time anyways)</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Tue Mar 08 2022 13:19:37 GMT-0800 (Pacific Standard Time)">21:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">good luck</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Tue Mar 08 2022 13:20:34 GMT-0800 (Pacific Standard Time)">21:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@chaircrusher:mozilla.org">chaircrusher</span>&gt;</div></td><td class="msg-cell">Not to criticize anyone present, but companies as large and established as Mozilla end up in a pocket universe of software development that isn't easily understood from the outside.</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Tue Mar 08 2022 15:20:06 GMT-0800 (Pacific Standard Time)">23:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@dvir:mozilla.org">dvir</span>&gt;</div></td><td class="msg-cell"><p>hi folks! I'm dealing with a random crash that looks pretty core, and was directed here by folks in GeckoView. Hope it's ok :)</p>
<p>I'm testing a prototype Android app with GeckoView. I'm seeing a hard crash when setting up surfaces and starting the runtime, but that same crash goes away if I remove three other completely unrelated native libraries from the app.</p>
<p>The crash looks cryptic to me and I couldn't find anything about it online. I'm looking for any advice debugging this - any prefs or args I can throw in to get an idea of what's going on would be much appreciated!</p>
<p>The stack trace:</p>
<pre><code>pid: 27771, tid: 28172, name: MainThread  &gt;&gt;&gt; com~sanitized &lt;&lt;&lt;
uid: 10088
signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x0
Cause: null pointer dereference
#00 pc 0000000002e08568  /data/app/com~sanitized/lib/arm64/libxul.so (mozilla::detail::ThreadLocal&lt;bool, mozilla::detail::ThreadLocalKeyStorage&gt;::infallibleInit()+88) (BuildId: b7f2fa3022d4cbfee57cded75955f0ca02f5193d)
#01 pc 00000000047b2760  /data/app/com~sanitized/lib/arm64/libxul.so (js::wasm::EnsureEagerProcessSignalHandlers()+152) (BuildId: b7f2fa3022d4cbfee57cded75955f0ca02f5193d)
#02 pc 000000000444ae28  /data/app/com~sanitized/lib/arm64/libxul.so (js::NewContext(unsigned int, JSRuntime*)+92) (BuildId: b7f2fa3022d4cbfee57cded75955f0ca02f5193d)
#03 pc 00000000036d96f8  /data/app/com~sanitized/lib/arm64/libxul.so (mozilla::CycleCollectedJSContext::Initialize(JSRuntime*, unsigned int)+44) (BuildId: b7f2fa3022d4cbfee57cded75955f0ca02f5193d)
#04 pc 0000000000ffc550  /data/app/com~sanitized/lib/arm64/libxul.so (XPCJSContext::Initialize()+60) (BuildId: b7f2fa3022d4cbfee57cded75955f0ca02f5193d)
#05 pc 0000000000ffcdf4  /data/app/com~sanitized/lib/arm64/libxul.so (XPCJSContext::NewXPCJSContext()+32) (BuildId: b7f2fa3022d4cbfee57cded75955f0ca02f5193d)
#06 pc 000000000100bb00  /data/app/com~sanitized/lib/arm64/libxul.so (nsXPConnect::InitJSContext()+8) (BuildId: b7f2fa3022d4cbfee57cded75955f0ca02f5193d)
#07 pc 0000000002f89258  /data/app/com~sanitized/lib/arm64/libxul.so (XREMain::XRE_mainRun()+568) (BuildId: b7f2fa3022d4cbfee57cded75955f0ca02f5193d)
#08 pc 0000000002f89e5c  /data/app/com~sanitized/lib/arm64/libxul.so (XREMain::XRE_main(int, char**, mozilla::BootstrapConfig const&amp;)+732) (BuildId: b7f2fa3022d4cbfee57cded75955f0ca02f5193d)
#09 pc 0000000002f8a4a4  /data/app/com~sanitized/lib/arm64/libxul.so (XRE_main(int, char**, mozilla::BootstrapConfig const&amp;)+124) (BuildId: b7f2fa3022d4cbfee57cded75955f0ca02f5193d)
#10 pc 0000000002f8c5dc  /data/app/com~sanitized/lib/arm64/libxul.so (GeckoStart+68) (BuildId: b7f2fa3022d4cbfee57cded75955f0ca02f5193d)
#11 pc 00000000000aae74  /data/app/com~sanitized/lib/arm64/libmozglue.so (Java_org_mozilla_gecko_mozglue_GeckoLoader_nativeRun+500) (BuildId: 39e0516fe27739ad20f0aeacb8decee25d7123c0)
#12 pc 0000000000143b50  /apex/com.android.runtime/lib64/libart.so (art_quick_generic_jni_trampoline+144) (BuildId: 696a9ee06663eab7dc720a88a3a44ae1)
</code></pre>
<p>thank you!</p>
</td></tr>

</tbody></table></div></div></div>
</body></html>