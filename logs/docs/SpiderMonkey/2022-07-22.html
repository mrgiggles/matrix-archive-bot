<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2022-07-22</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2022-07-22<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-07-21" class="nav-link"><span>prev</span></a>
<a href="2022-07-24" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Thu Jul 21 2022 21:44:19 GMT-0700 (Pacific Daylight Time)">04:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@ptomato:gnome.org">ptomato</span>&gt;</div></td><td class="msg-cell">what does a <code>!</code> prefix mean in an <code>EXPORTS</code> entry in a <a href="http://moz.build">moz.build</a> file?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Thu Jul 21 2022 21:45:14 GMT-0700 (Pacific Daylight Time)">04:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">it's a file inside object directory, instead of source directory</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Thu Jul 21 2022 21:45:20 GMT-0700 (Pacific Daylight Time)">04:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">usually it's used for generated files</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Thu Jul 21 2022 21:45:54 GMT-0700 (Pacific Daylight Time)">04:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@ptomato:gnome.org">ptomato</span>&gt;</div></td><td class="msg-cell">ah, ok</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Thu Jul 21 2022 21:46:00 GMT-0700 (Pacific Daylight Time)">04:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@ptomato:gnome.org">ptomato</span>&gt;</div></td><td class="msg-cell">thanks</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Thu Jul 21 2022 21:54:44 GMT-0700 (Pacific Daylight Time)">04:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@ptomato:gnome.org">ptomato</span>&gt;</div></td><td class="msg-cell">does anyone have any pointers on where to look for <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1776254">https://bugzilla.mozilla.org/show_bug.cgi?id=1776254</a> ? I find <a href="http://moz.build">moz.build</a> difficult to understand</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Thu Jul 21 2022 22:04:23 GMT-0700 (Pacific Daylight Time)">05:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><span class="nick-13">ptomato</span>: can you check 2 things?  one is whether you have <code>ProfilingCategoryList.h</code> in the object directory you've built the mozjs library.  and other is whether you have the same file in the installation of the mozjs library</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Thu Jul 21 2022 22:04:39 GMT-0700 (Pacific Daylight Time)">05:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">if it's only in the former, it means the install command doesn't handle the file</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Thu Jul 21 2022 22:04:40 GMT-0700 (Pacific Daylight Time)">05:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@ptomato:gnome.org">ptomato</span>&gt;</div></td><td class="msg-cell">yes and no</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Thu Jul 21 2022 22:04:52 GMT-0700 (Pacific Daylight Time)">05:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@ptomato:gnome.org">ptomato</span>&gt;</div></td><td class="msg-cell">yeah, it's not being installed</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Thu Jul 21 2022 22:05:45 GMT-0700 (Pacific Daylight Time)">05:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">then it's around <a href="https://searchfox.org/mozilla-central/rev/a352cc827575823676717d53766c39710b54201a/js/src/Makefile.in#107-109">Makefile.in</a></td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Thu Jul 21 2022 22:06:55 GMT-0700 (Pacific Daylight Time)">05:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">or this file <a href="https://searchfox.org/mozilla-central/rev/a352cc827575823676717d53766c39710b54201a/js/src/build/Makefile.in#58">Makefile.in</a></td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Thu Jul 21 2022 22:07:07 GMT-0700 (Pacific Daylight Time)">05:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><p><a href="https://searchfox.org/mozilla-central/rev/a352cc827575823676717d53766c39710b54201a/js/src/build/Makefile.in#34-35,58-59">https://searchfox.org/mozilla-central/rev/a352cc827575823676717d53766c39710b54201a/js/src/build/Makefile.in#34-35,58-59</a></p>
<pre><code>######################################################
# BEGIN SpiderMonkey header installation
...
install::
	$(call py_action,process_install_manifest,$(if $(filter copy,$(NSDISTMODE)),--no-symlinks )--track install_dist_include.track --no-symlinks $(DESTDIR)$(includedir)/$(JS_LIBRARY_NAME) $(DEPTH)/_build_manifests/install/dist_include)
</code></pre>
</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Thu Jul 21 2022 22:07:54 GMT-0700 (Pacific Daylight Time)">05:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><p>this line might be more related <a href="https://searchfox.org/mozilla-central/rev/a352cc827575823676717d53766c39710b54201a/js/src/build/Makefile.in#31-32">https://searchfox.org/mozilla-central/rev/a352cc827575823676717d53766c39710b54201a/js/src/build/Makefile.in#31-32</a></p>
<pre><code>install:: ../js-config.h
	$(SYSINSTALL) $^ $(DESTDIR)$(includedir)/$(JS_LIBRARY_NAME)
</code></pre>
</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Thu Jul 21 2022 22:08:02 GMT-0700 (Pacific Daylight Time)">05:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">it's also auto-generated public header</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Fri Jul 22 2022 06:54:00 GMT-0700 (Pacific Daylight Time)">13:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@ptomato:gnome.org">ptomato</span>&gt;</div></td><td class="msg-cell">thanks!! that seems like exactly it</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Fri Jul 22 2022 07:22:18 GMT-0700 (Pacific Daylight Time)">14:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@bthrall:mozilla.org">Bryan Thrall [:bthrall]</span>&gt;</div></td><td class="msg-cell">TIL, there is <code>$HOME/.moz-phab-config</code> where you can set <code>patch.create_bookmark = False</code></td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Fri Jul 22 2022 10:10:21 GMT-0700 (Pacific Daylight Time)">17:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">Is there any actual documentation explaining why you would want to provide a parent runtime for a new context? Or explaining what is max bytes and nursery bytes, etc?</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Fri Jul 22 2022 10:10:47 GMT-0700 (Pacific Daylight Time)">17:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">How is the spidermonkey documentation? afaik there is only source code that you can view via searchfox</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Fri Jul 22 2022 10:20:26 GMT-0700 (Pacific Daylight Time)">17:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Is there any actual documentation explaining why you would want to provide a parent runtime for a new context? Or explaining what is max bytes and nursery bytes, etc?</blockquote></mx-reply>IIRC the point of this is that you can have multiple runtimes in a single process that share some data, to reduce memory usage.</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Fri Jul 22 2022 11:17:55 GMT-0700 (Pacific Daylight Time)">18:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">I'm mainly deciding whether to utilize SpiderMonkey or V8 where I'm considering documentation as an aspect</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Fri Jul 22 2022 11:27:24 GMT-0700 (Pacific Daylight Time)">18:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><span class="nick-13">davidj361</span>: the documentation for embedders is not great. Your main entry point would be <a href="https://spidermonkey.dev/">https://spidermonkey.dev/</a> which will point you to <a href="https://github.com/mozilla-spidermonkey/spidermonkey-embedding-examples">Examples and Documentation</a>. Usually the best we have for actual JSAPI documentation is found <a href="https://searchfox.org/mozilla-central/search?q=%5BSMDOC%5D&amp;path=js%2F">tagged with SMDOC in the source</a></td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Fri Jul 22 2022 11:28:45 GMT-0700 (Pacific Daylight Time)">18:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">as for parent runtimes, I don't see a useful SMDOC for it. It ought to be at <a href="https://searchfox.org/mozilla-central/source/js/public/Context.h#13-46">https://searchfox.org/mozilla-central/source/js/public/Context.h#13-46</a> but it isn't. I would normally use searchfox to find users of that API and see what they're doing.</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Fri Jul 22 2022 11:28:51 GMT-0700 (Pacific Daylight Time)">18:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@wes:mozilla.org">wes</span>&gt;</div></td><td class="msg-cell">In particular - you can share interned strings in a runtime, and you can't share them across runtimes. This can be a huge win in some cases. Also, you can move objects across contexts in a runtime, but not across separate runtimes. (Note - my spidermonkey embedding experience is a bit out of date but extensive)</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Fri Jul 22 2022 11:29:36 GMT-0700 (Pacific Daylight Time)">18:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">mccr8 is right, it's for some small amount of sharing. There's no additional functionality you get from having a parent runtime.</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Fri Jul 22 2022 11:30:06 GMT-0700 (Pacific Daylight Time)">18:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">and wes is an old-timer, who comes from back before JSContext and JSRuntime were 1:1. You can no longer touch the same objects in different contexts.</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Fri Jul 22 2022 11:32:47 GMT-0700 (Pacific Daylight Time)">18:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I don't actually know which engine is better for any particular use case. My impression is that our documentation is worse, our GC integration is a bit harder to use but both of them are a pain, and our "support" on Matrix is better. Even though it's best-effort and unofficial and pretty variable in practice.</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Fri Jul 22 2022 11:35:29 GMT-0700 (Pacific Daylight Time)">18:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@wes:mozilla.org">wes</span>&gt;</div></td><td class="msg-cell">Oh! Thanks sfink. You actually just changed the architecture on my new project. :)</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Fri Jul 22 2022 11:45:18 GMT-0700 (Pacific Daylight Time)">18:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">Heh. Yeah, your options for communicating between contexts (==threads, now) are JSON, structured clone, or for plain data, <code>SharedArrayBuffer</code>s.</td></tr>

</tbody></table></div></div></div>
</body></html>