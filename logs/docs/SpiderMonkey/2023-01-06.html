<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2023-01-06</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2023-01-06<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2023-01-05" class="nav-link"><span>prev</span></a>
<a href="2023-01-07" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Thu Jan 05 2023 23:47:57 GMT-0800 (Pacific Standard Time)">07:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell">is this something we could do or should we close this bug <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1249175">https://bugzilla.mozilla.org/show_bug.cgi?id=1249175</a> ?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Thu Jan 05 2023 23:52:38 GMT-0800 (Pacific Standard Time)">07:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell">asking because I came across <code>DebuggerObject::forceLexicalInitializationByName</code> (<a href="https://searchfox.org/mozilla-central/rev/4ebfb48f7e82251145afa4a822f970931dd06c68/js/src/debugger/Object.cpp#2382">https://searchfox.org/mozilla-central/rev/4ebfb48f7e82251145afa4a822f970931dd06c68/js/src/debugger/Object.cpp#2382</a>), and I was wondering if that could be extended somehow to allow to "re-declare" let/const  from the webconsole (<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1257088">https://bugzilla.mozilla.org/show_bug.cgi?id=1257088</a>).<br>It looks like <code>forceLexicalInitializationByName</code> was added to tackle a similar issue (<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1246215">https://bugzilla.mozilla.org/show_bug.cgi?id=1246215</a>), but the provided value seems quite low in the end, without the ability to actually re-declare variables</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Fri Jan 06 2023 00:11:18 GMT-0800 (Pacific Standard Time)">08:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-14">nchevobbe</span>: see also bug 1580891. I think that's the best way to do this, have a special parse mode for console/REPL use</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Fri Jan 06 2023 00:11:19 GMT-0800 (Pacific Standard Time)">08:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1580891">https://bugzil.la/1580891</a> — NEW (nobody) — Console expressions should allow let/const variables and classes to be redeclared</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Fri Jan 06 2023 00:12:04 GMT-0800 (Pacific Standard Time)">08:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell">yeah, I found it after I posted the message and saw we had similar discussion already a couple months ago ^^</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Fri Jan 06 2023 00:16:52 GMT-0800 (Pacific Standard Time)">08:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">yeah it would be nice to fix this</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Fri Jan 06 2023 05:37:49 GMT-0800 (Pacific Standard Time)">13:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@niedziolka_michal:mozilla.org">niedziolka_michal</span>&gt;</div></td><td class="msg-cell">Do you guys know how any effective way of triggering garbage collection in SpiderMonkey? I am trying to make interactive example for WeakRef in MDN. When I push very large array into weakly referenced object, I can quickly reach 5GB of memory usage without actual collection. On the other hand, when I push smaller array or simply let objects be created and not placed anywhere, I get GC after 10-120 seconds. I am looking for some action, because of which article reader won't have to wait 2 minutes to see the result.</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Fri Jan 06 2023 05:40:21 GMT-0800 (Pacific Standard Time)">13:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">If you create a <code>JSClass</code> with a parent class through <code>JS_InitClass</code> and the parent class has reserved slots, do you have to ensure the reserved slots exclusive to the child class don't overlap?</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Fri Jan 06 2023 05:46:56 GMT-0800 (Pacific Standard Time)">13:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">Redfire</span>: do you need reserved slots for both the prototype and the instance object?</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Fri Jan 06 2023 05:47:59 GMT-0800 (Pacific Standard Time)">13:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">(bug 1808171 landed a few days ago and changed <code>JS_InitClass</code> to make it much easier to use different JSClasses for prototype and instance objects.. unfortunately that's Nightly-only still)</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Fri Jan 06 2023 05:48:00 GMT-0800 (Pacific Standard Time)">13:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1808171">https://bugzil.la/1808171</a> — RESOLVED (jandem) — Add a protoClass argument to JS_InitClass</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Fri Jan 06 2023 06:01:29 GMT-0800 (Pacific Standard Time)">14:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">Just the instance</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Fri Jan 06 2023 06:06:36 GMT-0800 (Pacific Standard Time)">14:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">Also, given I'm still on SM 107, it'll probably be a while before I get that change anyways
</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Fri Jan 06 2023 06:13:57 GMT-0800 (Pacific Standard Time)">14:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">jonco</span>: ^ do you have any tips for inducing a GC in a content script for purpose of writing an MDN demo?</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Fri Jan 06 2023 06:17:15 GMT-0800 (Pacific Standard Time)">14:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">We don't have APIs to trigger a GC because it's generally a bad idea to do this</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Fri Jan 06 2023 06:17:36 GMT-0800 (Pacific Standard Time)">14:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">You can trigger one manually with about:memory of course</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Fri Jan 06 2023 06:18:34 GMT-0800 (Pacific Standard Time)">14:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">niedziolka_michal</span>: "When I push very large array into weakly referenced object, I can quickly reach 5GB of memory usage without actual collection" - that sounds bad, can you share your code that does this?</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Fri Jan 06 2023 06:19:07 GMT-0800 (Pacific Standard Time)">14:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">We trigger GC based on allocated memory so if that's happening it's a bug</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Fri Jan 06 2023 06:28:01 GMT-0800 (Pacific Standard Time)">14:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@niedziolka_michal:mozilla.org">niedziolka_michal</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">jonco</span>: <a href="https://codepen.io/NiedziolkaMichal/pen/yLqVqyj">https://codepen.io/NiedziolkaMichal/pen/yLqVqyj</a></td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Fri Jan 06 2023 06:28:24 GMT-0800 (Pacific Standard Time)">14:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@niedziolka_michal:mozilla.org">niedziolka_michal</span>&gt;</div></td><td class="msg-cell">Sometimes I get "Uncaught out of memory" before object in WeakRef is collected</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Fri Jan 06 2023 06:29:36 GMT-0800 (Pacific Standard Time)">14:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">Redfire</span>: the strategy then usually is to just leave the reserved slots set to UndefinedValue() (the default) for the prototype object. When you access the slot, you can check it it's undefined and throw an exception about the prototype being invalid</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Fri Jan 06 2023 06:30:04 GMT-0800 (Pacific Standard Time)">14:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">it's a bit of a pain and the spec now prefers plain objects for the prototype for that reason</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Fri Jan 06 2023 06:31:19 GMT-0800 (Pacific Standard Time)">14:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">We're not talking about the same thing I think </td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Fri Jan 06 2023 06:31:36 GMT-0800 (Pacific Standard Time)">14:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">I meant the <code>parentProto</code> argument in <code>JS_InitClass</code></td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Fri Jan 06 2023 06:32:47 GMT-0800 (Pacific Standard Time)">14:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">Redfire</span>: that's the object that's used as the prototype for the newly created prototype object. It can be any object</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Fri Jan 06 2023 06:37:30 GMT-0800 (Pacific Standard Time)">14:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">oh, so it's not the same as what the <code>extends</code> keyword does for classes?</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Fri Jan 06 2023 06:38:31 GMT-0800 (Pacific Standard Time)">14:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">niedziolka_michal</span>: I expect GC is being triggered by the array allocation, but since the target of the weak ref is live there it's not being collected</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Fri Jan 06 2023 06:39:41 GMT-0800 (Pacific Standard Time)">14:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">niedziolka_michal</span>: In this case we would need a GC to happen after the end of the current job to collect this.  See the first note here: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakRef#notes_on_weakrefs">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakRef#notes_on_weakrefs</a></td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Fri Jan 06 2023 06:40:15 GMT-0800 (Pacific Standard Time)">14:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">Redfire</span>: the <code>parentProto</code> object will be on the proto chain of your instances: <code>instance =&gt; prototype (created by JS_InitClass) =&gt; parentProto</code>, so it is like inheriting from it</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Fri Jan 06 2023 06:41:01 GMT-0800 (Pacific Standard Time)">14:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">oh, I never realised the term prototype chain was literal 🤦</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Fri Jan 06 2023 06:41:18 GMT-0800 (Pacific Standard Time)">14:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">For some reason, I thought inheritance just shoved it on its own prototype</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Fri Jan 06 2023 06:41:33 GMT-0800 (Pacific Standard Time)">14:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">that explains how <code>HasOwnProperty</code> works then</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Fri Jan 06 2023 06:42:10 GMT-0800 (Pacific Standard Time)">14:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">oh yeah</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Fri Jan 06 2023 06:49:43 GMT-0800 (Pacific Standard Time)">14:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@niedziolka_michal:mozilla.org">niedziolka_michal</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">jonco</span>: Yeah I suppose that's the case. There are about 150 iterations before garbage collection is forced and then sometimes object is correctly released and sometimes Out of memory is thrown.</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Fri Jan 06 2023 06:50:07 GMT-0800 (Pacific Standard Time)">14:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">If you continually allocate memory out of memory will occur at some point</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Fri Jan 06 2023 06:50:45 GMT-0800 (Pacific Standard Time)">14:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">Sorry I don't suppose this helps with your original question</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Fri Jan 06 2023 07:03:47 GMT-0800 (Pacific Standard Time)">15:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@niedziolka_michal:mozilla.org">niedziolka_michal</span>&gt;</div></td><td class="msg-cell">Yeah. I think I will just go with simple creation of array with 5000 elements, without assigning it to anything. That surprisingly seems just as likely to trigger GC as other stuff that I have tried</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Fri Jan 06 2023 07:09:07 GMT-0800 (Pacific Standard Time)">15:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">niedziolka_michal</span>: this is likely to work differently between browsers so is not great for example code</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Fri Jan 06 2023 07:11:39 GMT-0800 (Pacific Standard Time)">15:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@niedziolka_michal:mozilla.org">niedziolka_michal</span>&gt;</div></td><td class="msg-cell">If you can think of some code which could show the readers that object held by WeakRef is indeed garbage collected, that I would appreciate it</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Fri Jan 06 2023 07:12:04 GMT-0800 (Pacific Standard Time)">15:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@niedziolka_michal:mozilla.org">niedziolka_michal</span>&gt;</div></td><td class="msg-cell">Array thing works quite similarly in V8, but I didn't test it on webkit yet</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Fri Jan 06 2023 07:12:51 GMT-0800 (Pacific Standard Time)">15:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">OK, forcing GC by allocating objects should work, but doing it before the deref() will work better</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Fri Jan 06 2023 07:13:29 GMT-0800 (Pacific Standard Time)">15:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">just allocate 'enough' memory and don't assign it to anything</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Fri Jan 06 2023 07:15:08 GMT-0800 (Pacific Standard Time)">15:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">you shouldn't need repeat it with setInterval, but it will need to happen in a separate job so you'll need to use setTimeout or equivalent to get that</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Fri Jan 06 2023 07:16:03 GMT-0800 (Pacific Standard Time)">15:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">'enough' will depend on the size of everything allocated by the page and on the browser but you should be able to pick a suitable value</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Fri Jan 06 2023 07:18:25 GMT-0800 (Pacific Standard Time)">15:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@niedziolka_michal:mozilla.org">niedziolka_michal</span>&gt;</div></td><td class="msg-cell">This should be fine?</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Fri Jan 06 2023 07:21:15 GMT-0800 (Pacific Standard Time)">15:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">Yes</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Fri Jan 06 2023 07:23:15 GMT-0800 (Pacific Standard Time)">15:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">Please comment not to do this in production code :)</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Fri Jan 06 2023 07:24:52 GMT-0800 (Pacific Standard Time)">15:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@niedziolka_michal:mozilla.org">niedziolka_michal</span>&gt;</div></td><td class="msg-cell">Alright, I will</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Fri Jan 06 2023 07:24:54 GMT-0800 (Pacific Standard Time)">15:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@niedziolka_michal:mozilla.org">niedziolka_michal</span>&gt;</div></td><td class="msg-cell">Thanks a lot for help</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Fri Jan 06 2023 07:36:37 GMT-0800 (Pacific Standard Time)">15:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">jonco</span>: I can't make any assumptions about whether GrayOrBlackBit bit is set if BlackBit is set, even if I know a GC isn't active, can I?</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Fri Jan 06 2023 07:37:03 GMT-0800 (Pacific Standard Time)">15:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell">It looks like the "extra state" is used for incremental marking, but nothing cleans it up into a canonical mark bit value after, right?</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Fri Jan 06 2023 07:37:21 GMT-0800 (Pacific Standard Time)">15:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell">(I'm trying to figure out if I can steal a bit for cycle collection...)</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Fri Jan 06 2023 07:38:26 GMT-0800 (Pacific Standard Time)">15:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">mccr8: If something got marked gray and then gray unmarking marked it black then the GrayOrBlack bit will be set</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Fri Jan 06 2023 07:38:59 GMT-0800 (Pacific Standard Time)">15:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">this can happen after GC obviously</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Fri Jan 06 2023 07:39:02 GMT-0800 (Pacific Standard Time)">15:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell">Ah, that makes sense.</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Fri Jan 06 2023 07:40:17 GMT-0800 (Pacific Standard Time)">15:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">jonco</span>: and white objects are those that have been allocated since the last GC?</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Fri Jan 06 2023 07:40:27 GMT-0800 (Pacific Standard Time)">15:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">yes</td></tr>

</tbody></table></div></div></div>
</body></html>