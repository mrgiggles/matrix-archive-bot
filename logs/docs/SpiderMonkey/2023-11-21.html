<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2023-11-21</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2023-11-21<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2023-11-20" class="nav-link"><span>prev</span></a>
<a href="2023-11-22" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search SpiderMonkey">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Mon Nov 20 2023 16:35:57 GMT-0800 (Pacific Standard Time)">00:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@smaug:mozilla.org">smaug</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">sfink</span>: Does SM allocate functions and objects etc by default from nursery or is nursery limited to some subset?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Mon Nov 20 2023 16:41:23 GMT-0800 (Pacific Standard Time)">00:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@smaug:mozilla.org">smaug</span>&gt;</div></td><td class="msg-cell">hmm, maybe it had something to do with finalization. Trying to recall the setup.  DOM objects using nursery need to use JSCLASS_SKIP_NURSERY_FINALIZE class flag.</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Mon Nov 20 2023 17:06:44 GMT-0800 (Pacific Standard Time)">01:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">smaug</span>: Yeah, see <a href="https://searchfox.org/mozilla-central/source/js/src/gc/AllocKind.h#54-56">here</a></td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Mon Nov 20 2023 17:08:42 GMT-0800 (Pacific Standard Time)">01:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@smaug:mozilla.org">smaug</span>&gt;</div></td><td class="msg-cell">ah, and the define below seems to hint that functions and objects are nursery allocated</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Mon Nov 20 2023 17:08:55 GMT-0800 (Pacific Standard Time)">01:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@smaug:mozilla.org">smaug</span>&gt;</div></td><td class="msg-cell">but interestingly scope, as an example, isn't</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Mon Nov 20 2023 17:09:18 GMT-0800 (Pacific Standard Time)">01:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Objects, strings, and bigints can be nursery allocated</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Mon Nov 20 2023 17:09:18 GMT-0800 (Pacific Standard Time)">01:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Other GC things are always tenured</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Mon Nov 20 2023 17:09:21 GMT-0800 (Pacific Standard Time)">01:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">(Functions are objects)</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Mon Nov 20 2023 17:10:27 GMT-0800 (Pacific Standard Time)">01:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@smaug:mozilla.org">smaug</span>&gt;</div></td><td class="msg-cell">sure</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Mon Nov 20 2023 17:12:11 GMT-0800 (Pacific Standard Time)">01:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@smaug:mozilla.org">smaug</span>&gt;</div></td><td class="msg-cell">just trying to figure out if I could release some memory sooner by using nursery wrappers more often with DOM objects and also clearing some native-DOM -&gt; JS edges when the relevant global is going away</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Mon Nov 20 2023 17:13:39 GMT-0800 (Pacific Standard Time)">01:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@smaug:mozilla.org">smaug</span>&gt;</div></td><td class="msg-cell">interestingly based on Android results, that makes basically no difference in sp3 score. </td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Mon Nov 20 2023 17:14:20 GMT-0800 (Pacific Standard Time)">01:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@smaug:mozilla.org">smaug</span>&gt;</div></td><td class="msg-cell">though Windows might behave differently</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Mon Nov 20 2023 18:26:34 GMT-0800 (Pacific Standard Time)">02:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jlink:mozilla.org">jlink</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> iain: your discussion of finding the hash value reminded me that I'm constantly confused about the JSString layout, so I thought I'd <a href="https://docs.google.com/spreadsheets/d/1r4t6lfqLpk8dpTul_vEfMSOAEl5Zg1rFe0AMywUPu4s/edit#gid=0">draw it out</a> so I could hopefully keep it straight.</blockquote></mx-reply>All of the string talk from a a couple weeks ago got me thinking about <a href="https://www.youtube.com/watch?v=kPR8h4-qZdk">this talk</a> that I watched a while back regarding what Facebook does (or did) for their strings. I'm particularly impressed with how they elegantly support 23-byte inline strings in 24-byte string object. (This is discussed starting around the 7:50 mark in the video.)</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Mon Nov 20 2023 18:34:30 GMT-0800 (Pacific Standard Time)">02:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jlink:mozilla.org">jlink</span>&gt;</div></td><td class="msg-cell">Is this similar at all to what we have? I'm not familiar enough with our string classes yet to know if there are any ideas there that we could (and don't) use.</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Mon Nov 20 2023 18:36:32 GMT-0800 (Pacific Standard Time)">02:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jlink:mozilla.org">jlink</span>&gt;</div></td><td class="msg-cell">(I realize that there are some concepts that are supported by our JStrings, like ropes, that would not be needed for a general string class.)</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Mon Nov 20 2023 18:48:00 GMT-0800 (Pacific Standard Time)">02:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-13">jlink</span>: We do have a small string optimization. We always have at least 8 bytes in a string allocation that aren't the string itself (see <a href="https://searchfox.org/mozilla-central/source/js/src/vm/StringType.h#237-290">here</a> for what's in those bytes.)</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Mon Nov 20 2023 18:52:46 GMT-0800 (Pacific Standard Time)">02:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">The "draw it out" link in the message you quoted has a decent summary. Everything has length/flags. Ropes have a left pointer and a right pointer. Boring linear strings just have a data pointer. Dependent strings have a data pointer (pointing somewhere inside the data for another string) and a base pointer (pointing to the string that owns that data). External strings have a data pointer that we didn't allocate ourselves. Extensible strings have a data pointer and a capacity. Inline strings have 16 bytes of inline data. Fat inline strings have 24 bytes of inline data.</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Mon Nov 20 2023 18:53:31 GMT-0800 (Pacific Standard Time)">02:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Atoms end with a hash field. The specific layout of atoms is being changed in bug 1865502.</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Mon Nov 20 2023 18:53:33 GMT-0800 (Pacific Standard Time)">02:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1865502">https://bugzil.la/1865502</a> â€” NEW (nobody) â€” Align hash fields in all atom subtypes</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Mon Nov 20 2023 21:57:26 GMT-0800 (Pacific Standard Time)">05:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jlink:mozilla.org">jlink</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> The "draw it out" link in the message you quoted has a decent summary. Everything has length/flags. Ropes have a left pointer and a right pointer. Boring linear strings just have a data pointer. Dependent strings have a data pointer (pointing somewhere inside the data for another string) and a base pointer (pointing to the string that owns that data). External strings have a data pointer that we didn't allocate ourselves. Extensible strings have a data pointer and a capacity. Inline strings have 16 bytes of inline data. Fat inline strings have 24 bytes of inline data.</blockquote></mx-reply>Cool, thanks for the pointer to that bug. I was aware that we do SSO, I just wasn't sure if any of the ideas/tricks that they used to get 23 bytes of inline string out of a 24 byte multi-purpose string object could be used in our strings to squeeze any more characters out. (It seems like, after the above change, we will get 20 inline string bytes out of a 32 inline atom object so their string has much better utilization.) We of course, however, have so many additional things to support that I doubt we could come close to that, but that doesn't mean that there <em>couldn't</em> be <em>something</em> that we could do to squeeze out an extra byte or two.</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Mon Nov 20 2023 22:12:23 GMT-0800 (Pacific Standard Time)">06:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">Would you consider adding an "ExternalLatin1String"?</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Mon Nov 20 2023 22:13:50 GMT-0800 (Pacific Standard Time)">06:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">there's a patch in bug 1576076.  it's not added because there's no consumer yet</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Mon Nov 20 2023 22:13:51 GMT-0800 (Pacific Standard Time)">06:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1576076">https://bugzil.la/1576076</a> â€” NEW (nobody) â€” Latin1 strings: Add a Latin1 flavor of JSExternalString</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Mon Nov 20 2023 22:16:32 GMT-0800 (Pacific Standard Time)">06:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">if you need it, I'm happy to resurrect the patch</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Mon Nov 20 2023 22:24:14 GMT-0800 (Pacific Standard Time)">06:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">I was looking to add it for some slight ascii optimisations on my part ðŸ˜…</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Mon Nov 20 2023 22:24:28 GMT-0800 (Pacific Standard Time)">06:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">because text encoding is a colouring and rust uses utf-8</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Mon Nov 20 2023 22:25:54 GMT-0800 (Pacific Standard Time)">06:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">okay, I'll look into the patch this week</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Tue Nov 21 2023 07:04:49 GMT-0800 (Pacific Standard Time)">15:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@jrmuizel:mozilla.org">jrmuizel</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">iain</span>: could we allocate Map storage the same way we allocate Array storage?</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Tue Nov 21 2023 07:17:53 GMT-0800 (Pacific Standard Time)">15:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">I have a question about module resolution hooks.

How can I determine which module sent the resolution request.

For instance, a imports b,b imports c.  When I get the request for c, how do I know it came from b?</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Tue Nov 21 2023 07:21:29 GMT-0800 (Pacific Standard Time)">15:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">I would suggest using <code>SetModulePrivate</code> to give it a path (for example), and then reading that private data through the second arg of your resolve hook</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Tue Nov 21 2023 07:31:22 GMT-0800 (Pacific Standard Time)">15:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I would suggest using <code>SetModulePrivate</code> to give it a path (for example), and then reading that private data through the second arg of your resolve hook</blockquote></mx-reply>I tried that, and sometimes I get undefined values for the second arg.</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Tue Nov 21 2023 07:33:22 GMT-0800 (Pacific Standard Time)">15:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">Are you sure you're using <code>SetModulePrivate</code> on <em>all</em> your modules?</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Tue Nov 21 2023 07:33:53 GMT-0800 (Pacific Standard Time)">15:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">Maybe not on the top level module.</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Tue Nov 21 2023 08:43:52 GMT-0800 (Pacific Standard Time)">16:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-14">jrmuizel</span>: Array storage is baked into every native object. An object is (roughly) a shape pointer, a pointer to the slots (for named properties) and a pointer to the elements (for integer-indexed properties). The only thing that distinguishes an Array from a normal object is some magic involving the <code>length</code> field.</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Tue Nov 21 2023 08:45:24 GMT-0800 (Pacific Standard Time)">16:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">We can't reuse the elements storage in a Map to store the contents of the hashtable, because we still need that storage to be available if somebody does something like <code>map[0] = "hello"</code>.</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Tue Nov 21 2023 10:11:15 GMT-0800 (Pacific Standard Time)">18:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><span class="nick-13">jlink</span>: that was an interesting talk. We do overlap a fair bit. We have not only an empty string, but a whole bunch of short shared strings. Our max length is under 2^32, so our length only requires 4 bytes though we also use a full 4 bytes for flags + other optimizations (smallish integer-valued strings cache their integral values in 16 bits of that). We used to have the \0 storage problem, but jandem successfully ripped it out a while back so we don't have to pay for that anymore. COW is unnecessary since our strings are immutable. (And that means we can also freely share substrings by using dependent strings, especially since we never \0 terminate anymore so we don't have to worry about dependent strings mangling their bases.)</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Tue Nov 21 2023 10:11:41 GMT-0800 (Pacific Standard Time)">18:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">But it's true that we can only store 16 bytes in a 24 byte string, or 24 bytes in a 32 byte string.</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Tue Nov 21 2023 10:14:14 GMT-0800 (Pacific Standard Time)">18:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">and I don't see a fundamental reason why we couldn't improve that efficiency. Getting 21 bytes in a 24 byte string would be pretty straightforward, I think? When combined with other existing optimizations, I can't predict how much it would gain, but it's worth considering.</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Tue Nov 21 2023 12:49:30 GMT-0800 (Pacific Standard Time)">20:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Outside of testing code, <a href="https://searchfox.org/mozilla-central/source/__GENERATED__/dom/bindings/HTMLAllCollectionBinding.cpp#1208-1219">this</a> is the only class that uses JSCLASS_EMULATES_UNDEFINED, and the only use of that class is in a call to CreateProxyObject <a href="https://searchfox.org/mozilla-central/source/__GENERATED__/dom/bindings/HTMLAllCollectionBinding.cpp#1285">here</a>. Does that mean that <a href="https://searchfox.org/mozilla-central/source/js/src/jit/MacroAssembler-inl.h#561-563">this code</a> (checking whether a non-proxy object emulates undefined) is dead code in production?</blockquote></mx-reply>Do you have a bug/patch where you're planning on removing this branch? (am looking at fuse optimization in this area, and would build atop if you did)</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Tue Nov 21 2023 12:52:30 GMT-0800 (Pacific Standard Time)">20:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">mgaudet</span>: <a href="https://phabricator.services.mozilla.com/D172450">This</a> is the only patch I've written. I figured that your fuse work would replace it all anyway.</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Tue Nov 21 2023 12:54:08 GMT-0800 (Pacific Standard Time)">20:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">:P ok. Fair enough. Let's see what happens :D </td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Tue Nov 21 2023 14:10:28 GMT-0800 (Pacific Standard Time)">22:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">TIL: if you put <code>static_assert</code> inside a false <code>if constexpr (...)</code> clause, it will be checked and break the build. :-( Back to <code>#ifdef</code> for me...</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Tue Nov 21 2023 14:21:48 GMT-0800 (Pacific Standard Time)">22:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">arai</span>: While working through your (very detailed and helpful - thank you!) feedback on my waitAsync patches, I came up with an idea that might significantly simplify the handling of timeouts. I wrote up a <a href="https://docs.google.com/document/d/1JRmYTPVDozVwFoRjAVKVevsgoNyXSdh2uWGbXkqDRdk/edit?usp=sharing">document</a> to describe it. It is based on the observable behaviour of the microtask queue, which you know much more about that I do. Can you take a look and let me know if you can see any big problems with my idea?</td></tr>

</tbody></table></div></div></div>
</body></html>