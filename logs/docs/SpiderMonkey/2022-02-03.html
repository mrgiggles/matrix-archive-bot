<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2022-02-03</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2022-02-03<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-02-02" class="nav-link"><span>prev</span></a>
<a href="2022-02-04" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Feb 02 2022 23:00:39 GMT-0800 (Pacific Standard Time)">07:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell">^ all my comments were probably not the best place for these messages, but they were about me being delighted</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Feb 02 2022 23:03:15 GMT-0800 (Pacific Standard Time)">07:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I don't really understand what you are saying. Core dumps?</blockquote></mx-reply>afaiu, any error thrown that isn't caught, causes a crash and the crash, if not handled properly can lead to some things undesirable or not depending on how the program is being run</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Thu Feb 03 2022 00:34:10 GMT-0800 (Pacific Standard Time)">08:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">bthrall</span>: hi and welcome! ðŸ‘‹</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Thu Feb 03 2022 00:53:08 GMT-0800 (Pacific Standard Time)">08:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">hi <span class="nick-2">bthrall</span> !</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Thu Feb 03 2022 01:16:11 GMT-0800 (Pacific Standard Time)">09:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bthrall:mozilla.org">bthrall</span>&gt;</div></td><td class="msg-cell">Hi!</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Thu Feb 03 2022 03:38:51 GMT-0800 (Pacific Standard Time)">11:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sudipto64:mozilla.org">sudipto64</span>&gt;</div></td><td class="msg-cell">Is there any way to get the id [Like tinyid in 1.6] for each class property in getproperty or setproperty function ?</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Thu Feb 03 2022 04:22:05 GMT-0800 (Pacific Standard Time)">12:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">sudipto64</span>: you mean in a getter or setter function?</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Thu Feb 03 2022 04:23:13 GMT-0800 (Pacific Standard Time)">12:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sudipto64:mozilla.org">sudipto64</span>&gt;</div></td><td class="msg-cell">yes </td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Thu Feb 03 2022 04:24:47 GMT-0800 (Pacific Standard Time)">12:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sudipto64:mozilla.org">sudipto64</span>&gt;</div></td><td class="msg-cell">for example : JS_PSG("prop", MyClassPropGetter, JSPROP_ENUMERATE) ..In MyClassPropGetter I want id ,so that I can identify which property it is</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Thu Feb 03 2022 04:26:07 GMT-0800 (Pacific Standard Time)">12:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">you could use <code>CallArgs::callee</code> (<code>CallArgsFromVp</code>, <code>args.callee()</code>) to get the callee function, then get the function name from that maybe</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Thu Feb 03 2022 04:26:25 GMT-0800 (Pacific Standard Time)">12:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">but new-style getters/setters can be redefined on other objects or with different property names, so it's not as precise</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Thu Feb 03 2022 04:29:38 GMT-0800 (Pacific Standard Time)">12:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">it would be simpler and more idiomatic to use different functions for the different properties</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Thu Feb 03 2022 04:31:04 GMT-0800 (Pacific Standard Time)">12:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sudipto64:mozilla.org">sudipto64</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> it might be simpler and more idiomatic to use different functions for the different properties</blockquote></mx-reply>this way I'm doing now ..if I get the id then trim it to one function ..that's why I was looking for this</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Thu Feb 03 2022 04:33:10 GMT-0800 (Pacific Standard Time)">12:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">sudipto64</span>: you mean forward multiple properties to a shared function?</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Thu Feb 03 2022 04:37:14 GMT-0800 (Pacific Standard Time)">12:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sudipto64:mozilla.org">sudipto64</span>&gt;</div></td><td class="msg-cell">yes ..</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Thu Feb 03 2022 04:38:05 GMT-0800 (Pacific Standard Time)">12:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">You can just define multiple C++ functions that call a single shared function with some kind of id as a parameter</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Thu Feb 03 2022 04:39:18 GMT-0800 (Pacific Standard Time)">12:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">yeah I'd use <code>MyClassFooGetter</code>, <code>MyClassBarGetter</code> and have them both call a shared function with an enum argument you pass from the callers</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Thu Feb 03 2022 04:48:22 GMT-0800 (Pacific Standard Time)">12:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sudipto64:mozilla.org">sudipto64</span>&gt;</div></td><td class="msg-cell">myobj.prop; I'll use like this ..</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Thu Feb 03 2022 04:49:24 GMT-0800 (Pacific Standard Time)">12:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sudipto64:mozilla.org">sudipto64</span>&gt;</div></td><td class="msg-cell">Now if I need to branch out other functions how I know which property it is ?</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Thu Feb 03 2022 04:49:30 GMT-0800 (Pacific Standard Time)">12:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sudipto64:mozilla.org">sudipto64</span>&gt;</div></td><td class="msg-cell">any suggestion ?</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Thu Feb 03 2022 05:01:07 GMT-0800 (Pacific Standard Time)">13:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">sudipto64</span>: use <code>MyClassPropGetter</code> only for "prop", then do something like <code>MyClassPropGetter(..) { return MyClassGetter(..., Property::Prop); }</code></td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Thu Feb 03 2022 05:02:52 GMT-0800 (Pacific Standard Time)">13:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sudipto64:mozilla.org">sudipto64</span>&gt;</div></td><td class="msg-cell">ok thanks..</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Thu Feb 03 2022 08:19:49 GMT-0800 (Pacific Standard Time)">16:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@aosmond:mozilla.org">aosmond</span>&gt;</div></td><td class="msg-cell">so for implementing OffscreenCanvasRenderingContext2D, I subclassed CanvasRenderingContext2D and provided the necessary variations. turns out this is tripping rooting hazards. however some of the hazards seem to be in existing code. any suggestions on why this doesn't trip a rooting hazard today, but could if one subclasses CanvasRenderingContext2D? <a href="https://searchfox.org/mozilla-central/rev/8b46752d1e583b2f817c451f93ba515fb865554d/dom/canvas/CanvasRenderingContext2D.cpp#1544">https://searchfox.org/mozilla-central/rev/8b46752d1e583b2f817c451f93ba515fb865554d/dom/canvas/CanvasRenderingContext2D.cpp#1544</a> <a href="https://searchfox.org/mozilla-central/source/__GENERATED__/dom/bindings/CanvasRenderingContext2DBinding.cpp#7399">https://searchfox.org/mozilla-central/source/__GENERATED__/dom/bindings/CanvasRenderingContext2DBinding.cpp#7399</a></td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Thu Feb 03 2022 08:20:51 GMT-0800 (Pacific Standard Time)">16:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@aosmond:mozilla.org">aosmond</span>&gt;</div></td><td class="msg-cell">this try contains my latest attempts to fix it, thinking it wasn't a good idea to use the GetWrapperMaybeDead from CanvasRenderingContext2D when the object was actually OffscreenCanvasRenderingContext2D, but that just multiplied the rooting hazards :) <a href="https://treeherder.mozilla.org/jobs?repo=try&amp;revision=7832e768ed99b06d028aa571ab5ecdb5cf385b0f">https://treeherder.mozilla.org/jobs?repo=try&amp;revision=7832e768ed99b06d028aa571ab5ecdb5cf385b0f</a></td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Thu Feb 03 2022 08:24:41 GMT-0800 (Pacific Standard Time)">16:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-5">aosmond</span>: have a link to the push where you first got a rooting hazard?</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Thu Feb 03 2022 08:26:06 GMT-0800 (Pacific Standard Time)">16:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@aosmond:mozilla.org">aosmond</span>&gt;</div></td><td class="msg-cell"><a href="https://treeherder.mozilla.org/logviewer?job_id=366505998&amp;repo=autoland&amp;lineNumber=102048">https://treeherder.mozilla.org/logviewer?job_id=366505998&amp;repo=autoland&amp;lineNumber=102048</a></td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Thu Feb 03 2022 08:26:19 GMT-0800 (Pacific Standard Time)">16:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@aosmond:mozilla.org">aosmond</span>&gt;</div></td><td class="msg-cell">that should match what is in phabricator more or less</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Thu Feb 03 2022 08:26:27 GMT-0800 (Pacific Standard Time)">16:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@aosmond:mozilla.org">aosmond</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1746750#c1">https://bugzilla.mozilla.org/show_bug.cgi?id=1746750#c1</a></td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Thu Feb 03 2022 08:27:19 GMT-0800 (Pacific Standard Time)">16:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@aosmond:mozilla.org">aosmond</span>&gt;</div></td><td class="msg-cell">I expect it is part 3 that introduces it through the subclass</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Thu Feb 03 2022 08:29:46 GMT-0800 (Pacific Standard Time)">16:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@aosmond:mozilla.org">aosmond</span>&gt;</div></td><td class="msg-cell">I haven't tried, but I wonder if making both objects top level cycle collected objects, and splitting out the code I want into a helper subclass without the cycle bits would help</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Thu Feb 03 2022 08:30:06 GMT-0800 (Pacific Standard Time)">16:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@aosmond:mozilla.org">aosmond</span>&gt;</div></td><td class="msg-cell">it doesn't seem to be a common pattern (what I am doing)</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Thu Feb 03 2022 08:34:42 GMT-0800 (Pacific Standard Time)">16:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">it thinks <code>BindingJSObjectMallocBytes(mozilla::dom::CanvasRenderingContext2D*)</code> can GC - <a href="https://paste.mozilla.org/AMzdQB2Y">https://paste.mozilla.org/AMzdQB2Y</a></td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Thu Feb 03 2022 08:35:12 GMT-0800 (Pacific Standard Time)">16:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">jonco</span>, <span class="nick-12">sfink</span> : ^</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Thu Feb 03 2022 08:39:23 GMT-0800 (Pacific Standard Time)">16:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">That GetWidth is a webidl function. I'll have to figure out the rules around what that allows, but I wouldn't expect that to be JS-implementable or anything. It seems like it's failing to resolve the virtual method to all possibilities once you subclass it.</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Thu Feb 03 2022 08:39:50 GMT-0800 (Pacific Standard Time)">16:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I'll need to look at this more closely, but right now it seems like a bug in the hazard analysis.</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Thu Feb 03 2022 08:39:55 GMT-0800 (Pacific Standard Time)">16:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@aosmond:mozilla.org">aosmond</span>&gt;</div></td><td class="msg-cell">if that's all it is, I can easily work around that and add internal methods :)</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Thu Feb 03 2022 08:40:20 GMT-0800 (Pacific Standard Time)">16:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">it's hard to say whether that's all it is; often resolving something like this reveals the next, then the next, ... :-(</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Thu Feb 03 2022 08:40:47 GMT-0800 (Pacific Standard Time)">16:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">in a meeting now, but I'll take a look right after</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Thu Feb 03 2022 08:40:51 GMT-0800 (Pacific Standard Time)">16:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@aosmond:mozilla.org">aosmond</span>&gt;</div></td><td class="msg-cell">okay, well I'll try that and see what try spits out</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Thu Feb 03 2022 08:41:05 GMT-0800 (Pacific Standard Time)">16:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">yeah, it'll be useful to me to know the outcome of that too</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Thu Feb 03 2022 10:14:45 GMT-0800 (Pacific Standard Time)">18:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@aosmond:mozilla.org">aosmond</span>&gt;</div></td><td class="msg-cell">looks like it was the virtual method, thanks everyone for the assist! -- <a href="https://treeherder.mozilla.org/jobs?repo=try&amp;revision=589c9be132180791b97a3698c1e2106beaeddff3">https://treeherder.mozilla.org/jobs?repo=try&amp;revision=589c9be132180791b97a3698c1e2106beaeddff3</a></td></tr>

</tbody></table></div></div></div>
</body></html>