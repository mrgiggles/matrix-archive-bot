<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2024-07-07</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2024-07-07<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2024-07-05" class="nav-link"><span>prev</span></a>
<a href="2024-07-08" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search SpiderMonkey">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Sun Jul 07 2024 02:27:12 GMT-0700 (Pacific Daylight Time)">09:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@debadree25:mozilla.org">debadree25</span>&gt;</div></td><td class="msg-cell">hello everyone I am working on implementing the <a href="https://github.com/tc39/proposal-explicit-resource-management">https://github.com/tc39/proposal-explicit-resource-management</a> proposal now tldr: the proposal introduces syntax like <code>{ using x = xyz }</code> wherein the xyz object will have a <code>@@dispose</code> method in it and that would be called when the execution is leaving the scope containing the using declaration. Now we can definitely throw errors during this operation and in order to handle the case where a scope has multiple using declaration the proposal add a new error type <code>SuppressedError</code> suppressed error basically links together all the errors that may happen during the disposals in a linked list fashion. For example we have the code <code>{ using x = a; using y = b }</code> wherein disposing x throws error 1 and y error 2 on executing this code we will get SuppressedError thrown instead which will have two properties <code>error</code> which is the error that is suppressing some other error and <code>suppressed</code> which is the error that was suppressed in our example the values would be 1 and 2 for <code>error</code> and <code>suppressed</code> respectively. Now after this long introduction my question: What would expect SuppressedError's stack trace to be?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Sun Jul 07 2024 02:29:12 GMT-0700 (Pacific Daylight Time)">09:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@debadree25:mozilla.org">debadree25</span>&gt;</div></td><td class="msg-cell">the present idea in mind is to have the stack trace pointing to the end of the scope where the disposables were being disposed and additionally print out the error that suppressed the other error as well (and maybe continue printing out all the suppressed errors until we hit the end of the chain too?)</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Sun Jul 07 2024 04:45:44 GMT-0700 (Pacific Daylight Time)">11:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">So, this would be almost the same thing as the stack trace for the parent frame of <code>@@dispose</code> method call.<br>The end of the scope is also pointed by C++'s stack allocated class instance's destructor's backtrace. On the other hand, Python's <code>with</code>'s <code>__exit__</code> call's parent frame points the <code>with</code> line, instead of the end of the <code>with</code> block. <a href="https://pastebin.mozilla.org/f7eG41mi">https://pastebin.mozilla.org/f7eG41mi</a></td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Sun Jul 07 2024 04:50:53 GMT-0700 (Pacific Daylight Time)">11:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><a href="https://github.com/tc39/proposal-explicit-resource-management?tab=readme-ov-file#prior-art">https://github.com/tc39/proposal-explicit-resource-management?tab=readme-ov-file#prior-art</a> says C# has the <code>using</code> declaration.  it would be nice to look into that as well</td></tr>

</tbody></table></div></div></div>
</body></html>