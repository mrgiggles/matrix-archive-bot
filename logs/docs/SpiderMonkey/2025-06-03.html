<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2025-06-03</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2025-06-03<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2025-06-02" class="nav-link"><span>prev</span></a>
<a href="2025-06-04" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search SpiderMonkey">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Jun 03 2025 04:04:42 GMT-0700 (Pacific Daylight Time)">11:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@calixte:mozilla.org">calixte</span>&gt;</div></td><td class="msg-cell">for pdf.js it would be very interesting to have a feature like: <a href="https://github.com/tc39/proposal-structs">https://github.com/tc39/proposal-structs</a>
For now we just have one worker to parse the pdf and the rendering is done in the main thread, but we've some plans to make the rendering in different workers and then we'll have to share some data across them</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Jun 03 2025 04:11:30 GMT-0700 (Pacific Daylight Time)">11:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@calixte:mozilla.org">calixte</span>&gt;</div></td><td class="msg-cell">is it something we've on our roadmap ?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Jun 03 2025 07:22:49 GMT-0700 (Pacific Daylight Time)">14:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">It's still a relatively early proposal; while google is doing lots of prototyping, and we've thought a lot about it, it's certainly not coming soon. It's good to hear from you about your support for this (I'm going to take not on our tracking for this)

Iain is away today, but he can say more when he returns, but our general feeling is that this might actually make more sense in WASM (and certainly the capability probably should be done initially through wasm exposure). 

What's the pdf.js story with wasm? If we supported something like this through shared wasm-gc objects, could you imagine that sufficing for pdf.js? </td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue Jun 03 2025 07:23:02 GMT-0700 (Pacific Daylight Time)">14:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">calixte</span>: (oops, see above)</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Tue Jun 03 2025 09:07:20 GMT-0700 (Pacific Daylight Time)">16:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@calixte:mozilla.org">calixte</span>&gt;</div></td><td class="msg-cell">for now we just use wasm to handle color profiles (qcms) and jpeg2000 images decoding (openjpeg)
all the pdf parsing is done in a worker in pure js: we extract drawing instructions, images, fonts, ... and send that stuff in the main thread in order to be drawn on a canvas
as said our plan is to have several worker in order to render a page in using tiles, so we'll have share some read-only stuff: images (as Bitmap), fonts (metrics, utf-8 mapping, ...) </td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Tue Jun 03 2025 09:08:26 GMT-0700 (Pacific Daylight Time)">16:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@calixte:mozilla.org">calixte</span>&gt;</div></td><td class="msg-cell">so for example with images, if an image is on several tiles, we'll have to either clone it or use it in worker then send it to the next one, ...</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Tue Jun 03 2025 09:09:47 GMT-0700 (Pacific Daylight Time)">16:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@calixte:mozilla.org">calixte</span>&gt;</div></td><td class="msg-cell">as far as I know, bitmaps don't exist in the wasm space</td></tr>

</tbody></table></div></div></div>
</body></html>