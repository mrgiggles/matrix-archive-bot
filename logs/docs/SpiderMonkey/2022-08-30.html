<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2022-08-30</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2022-08-30<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-08-29" class="nav-link"><span>prev</span></a>
<a href="2022-08-31" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search SpiderMonkey">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Aug 30 2022 06:26:18 GMT-0700 (Pacific Daylight Time)">13:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@lgoodacre:matrix.org">liam_g</span>&gt;</div></td><td class="msg-cell">If I have two JS::Heap objects A and B which both point to the same thing, and if I know that A will always outlive B, do I need to run JS::TraceEdge() on both of them, or can I run it only on A?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Aug 30 2022 07:17:06 GMT-0700 (Pacific Daylight Time)">14:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> If I have two JS::Heap objects A and B which both point to the same thing, and if I know that A will always outlive B, do I need to run JS::TraceEdge() on both of them, or can I run it only on A?</blockquote></mx-reply>You generally need to run on both of them. The GC is also able to move objects around in memory and the TraceEdge code is involved in making sure all pointers are updated.</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Aug 30 2022 07:18:04 GMT-0700 (Pacific Daylight Time)">14:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">Things are moved either because they are promoted out of the nursery into the tenured heap (old generation), or the GC does a compaction to reduce fragmentation.</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue Aug 30 2022 08:12:08 GMT-0700 (Pacific Daylight Time)">15:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">Does SpiderMonkey have any agnostic backend support for binding C++ code? I wanted to use this but it doesn't seem to support SpiderMonkey: <a href="https://github.com/Chobolabs/jsbind">https://github.com/Chobolabs/jsbind</a></td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Tue Aug 30 2022 10:45:41 GMT-0700 (Pacific Daylight Time)">17:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-13">davidj361</span>: It looks like that is an abstraction layer providing a common C++ interface to multiple JS backends. I'm not aware of any similar project that supports SpiderMonkey, but we have a C++ API that could probably be used to add SpiderMonkey support to that project (or a similar project).</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Tue Aug 30 2022 10:58:23 GMT-0700 (Pacific Daylight Time)">17:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usva.techdev:mozilla.org">usva.techdev</span>&gt;</div></td><td class="msg-cell">Hello Everyone I'm trying to create a yocto recipe to bubild spidermonkey 68.0.2 because I cannot use a c++17 compiler... but at the moment of running configure I got some errors. If running inside a container from docker... If I run the configure command as follows outside yocto it runs correclty but if I run it inside yocto it marks the errors below:

this is configure command I'm running:

../configure --disable-jemalloc --enable-posix-nspr-emulation --enable-unaligned-private-values --with-system-zlib --with-intl-api --enable-debug --enable-optimize --with-clang-path=/usr/bin/clang --with-libclang-path=/usr/lib/llvm-10/lib

this are the errors returned from yocto warrrior build

|     'Failed to create virtualenv: %s' % self.virtualenv_root)
| Exception: Failed to create virtualenv: qemu-x86/build/tmp/work/core2-64-poky-linux/mozjs/68.2-r0/firefox-68.2.0/js/src/_build/_virtualenvs/init
| WARNING: qemu-x86/build/tmp/work/core2-64-poky-linux/mozjs/68.2-r0/temp/<a href="http://run.do">run.do</a>_configure.6599:1 exit 1 from '../configure --disable-jemalloc --enable-posix-nspr-emulation --enable-unaligned-private-values --with-system-zlib --with-intl-api --enable-debug --enable-optimize --with-clang-path=/usr/bin/clang --with-libclang-path=/usr/lib/llvm-10/lib --x-includes=no --x-libraries=no'
| ERROR: Function failed: do_configure (log file is located at build/tmp/work/core2-64-poky-linux/mozjs/68.2-r0/temp/<a href="http://log.do">log.do</a>_configure.6599)
ERROR: Task (recipes-scriptingservice/mozjs/mozjs_68.2.bb:do_configure) failed with exit code '1'
</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Tue Aug 30 2022 11:49:37 GMT-0700 (Pacific Daylight Time)">18:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usva.techdev:mozilla.org">usva.techdev</span>&gt;</div></td><td class="msg-cell">Which is the latest C++14 officially community supported/released version of spiderMonkey?</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Tue Aug 30 2022 12:52:55 GMT-0700 (Pacific Daylight Time)">19:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Which is the latest C++14 officially community supported/released version of spiderMonkey?</blockquote></mx-reply>I would go with the latest esr version, esr = extended support release</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Tue Aug 30 2022 12:53:34 GMT-0700 (Pacific Daylight Time)">19:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">which is esr 102 I think</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Tue Aug 30 2022 13:36:13 GMT-0700 (Pacific Daylight Time)">20:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">68 was probably the last ESR version targeting C++14, but it isn't actively supported. Depending on what headers you use, it may be possible to compile the spidermonkey library as C++17, but your project as C++14</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Tue Aug 30 2022 13:37:08 GMT-0700 (Pacific Daylight Time)">20:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">The "failed to create virtualenv" error sounds like an issue between Python and yocto and might need to be debugged seperately</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Tue Aug 30 2022 15:14:42 GMT-0700 (Pacific Daylight Time)">22:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usva.techdev:mozilla.org">usva.techdev</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> The "failed to create virtualenv" error sounds like an issue between Python and yocto and might need to be debugged seperately</blockquote></mx-reply>how can I debug this issue? any hint?</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Tue Aug 30 2022 15:15:00 GMT-0700 (Pacific Daylight Time)">22:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usva.techdev:mozilla.org">usva.techdev</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> 68 was probably the last ESR version targeting C++14, but it isn't actively supported. Depending on what headers you use, it may be possible to compile the spidermonkey library as C++17, but your project as C++14</blockquote></mx-reply>thanks this is helpful</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Tue Aug 30 2022 15:30:29 GMT-0700 (Pacific Daylight Time)">22:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">See if a simple script that just runs python virtualenv works right</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Tue Aug 30 2022 15:34:15 GMT-0700 (Pacific Daylight Time)">22:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usva.techdev:mozilla.org">usva.techdev</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> See if a simple script that just runs python virtualenv works right</blockquote></mx-reply>actually if I run the ../configure command with the options I wrote from the command line it works and there is no problem. it gets configured correctly the problem happens when I run the recipe with bitbake something happens that makes it crash.... which version of python should I be using for the ../configure command in spider monkey?</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Tue Aug 30 2022 15:35:17 GMT-0700 (Pacific Daylight Time)">22:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">I'd suggest searching for yocto and virtualenv. I saw some pages earlier talking about special setup for bitbake</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Tue Aug 30 2022 15:35:35 GMT-0700 (Pacific Daylight Time)">22:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">I think for 68, it was a mix of python 2 and 3</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Tue Aug 30 2022 15:36:07 GMT-0700 (Pacific Daylight Time)">22:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">I believe all the python 2 stuff is now gone in more recent esr like 102</td></tr>

</tbody></table></div></div></div>
</body></html>