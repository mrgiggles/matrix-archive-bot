<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2020-10-12</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2020-10-12<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2020-10-10" class="nav-link"><span>prev</span></a>
<a href="2020-10-13" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search SpiderMonkey">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Sun Oct 11 2020 21:03:29 GMT-0700 (Pacific Daylight Time)">04:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@waldo:mozilla.org">Waldo</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">decoder</span>: Now that <code>--enable-undefined-sanitizer</code> exists and takes a comma-separated list of sanitizers, is there any reason for the one-off command line arguments for signed and unsigned overflow sanitizers to exist any more?  Seems like no to me.  (Although, <code>--enable-undefined-sanitizer</code> is maybe not a good UI, because there's no way to say "give me the default sanitizers, but add and remove these particular sanitizers".)</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Sun Oct 11 2020 22:08:04 GMT-0700 (Pacific Daylight Time)">05:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">Waldo</span>: --enable-undefined-sanitizer was particularly made to allow us to enable these sanitizers progressively in the ASan build. I believe you can specify =foo,bar to enable specific ones</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Sun Oct 11 2020 22:08:36 GMT-0700 (Pacific Daylight Time)">05:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell">i dont have a strong opinion about the signed and unsigned overflow sanitizers, other than the unsigned one not being undefined behavior. </td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Sun Oct 11 2020 22:10:29 GMT-0700 (Pacific Daylight Time)">05:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@waldo:mozilla.org">Waldo</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">decoder</span>: You can specify <code>foo,bar</code>, but the default list of sanitizers seems to be randomly encoded <a href="https://searchfox.org/mozilla-central/source/build/moz.configure/toolchain.configure#1542">https://searchfox.org/mozilla-central/source/build/moz.configure/toolchain.configure#1542</a> and I don't see that it can be specifically invoked to then add/subtract from it.</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Sun Oct 11 2020 22:10:55 GMT-0700 (Pacific Daylight Time)">05:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">Waldo</span>: it is not randomly encoded, that is the supported one</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Sun Oct 11 2020 22:11:06 GMT-0700 (Pacific Daylight Time)">05:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell">(supported by us)</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Sun Oct 11 2020 22:11:20 GMT-0700 (Pacific Daylight Time)">05:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@waldo:mozilla.org">Waldo</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">decoder</span>: If I read the current code correctly, the two one-off sanitizers' handling is identical to what you'd get with <code>--enable-undefined-sanitizer=signed-overflow,unsigned-overflow</code>.  Which seems like a good reason to get rid of the one-offs.</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Sun Oct 11 2020 22:11:22 GMT-0700 (Pacific Daylight Time)">05:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell">we dont support all flags for ubsan</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Sun Oct 11 2020 22:12:01 GMT-0700 (Pacific Daylight Time)">05:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@waldo:mozilla.org">Waldo</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">decoder</span>: No, I mean someone who wants the supported ones, but then wants to experiment with additional ones, has no stable way to do it.  They have to copy the list of defaults and add their own atop.</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Sun Oct 11 2020 22:12:38 GMT-0700 (Pacific Daylight Time)">05:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell">yes, there is no good way to do that in our build system without adding yet another configure flag</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Sun Oct 11 2020 22:12:44 GMT-0700 (Pacific Daylight Time)">05:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@waldo:mozilla.org">Waldo</span>&gt;</div></td><td class="msg-cell">And so for example as clang adds more sanitizers, it's not possible to just say "ooh, let's try out this foobar sanitizer as well as teh defaults and see what happens".</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Sun Oct 11 2020 22:12:47 GMT-0700 (Pacific Daylight Time)">05:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell">and it would require parsing and merging stuff</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Sun Oct 11 2020 22:13:33 GMT-0700 (Pacific Daylight Time)">05:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@waldo:mozilla.org">Waldo</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">decoder</span>: Maybe we could say if you don't specify any, you get the defaults; but if you pass in <code>--enable-undefined-sanitizer=defaults,signed-overflow</code> or something, you get the defaults <em>plus</em> the extra options.</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Sun Oct 11 2020 22:14:16 GMT-0700 (Pacific Daylight Time)">05:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@waldo:mozilla.org">Waldo</span>&gt;</div></td><td class="msg-cell">This doesn't seem like a hard problem to solve, basically -- and it'd mean I wouldn't have a random list of entries (going out of date over time) added to my build-options.</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Sun Oct 11 2020 22:15:05 GMT-0700 (Pacific Daylight Time)">05:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell">if we can implement that "defaults" part easily, sure.</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Sun Oct 11 2020 22:15:34 GMT-0700 (Pacific Daylight Time)">05:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell">essentially parsing and expanding that I guess</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Sun Oct 11 2020 22:16:10 GMT-0700 (Pacific Daylight Time)">05:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@waldo:mozilla.org">Waldo</span>&gt;</div></td><td class="msg-cell">Okay.  If I remove the existing options, am I going to break tinderboxen or anything?  Or should I add the defaults thing, then leave removal to a separate bug or something?  (I'm not terribly sure how easily I could make the one-off options just feed into the defaults.)</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Sun Oct 11 2020 22:16:32 GMT-0700 (Pacific Daylight Time)">05:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell">why would you want to do that?</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Sun Oct 11 2020 22:16:38 GMT-0700 (Pacific Daylight Time)">05:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell">please dont break backward compatibility</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Sun Oct 11 2020 22:17:14 GMT-0700 (Pacific Daylight Time)">05:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@waldo:mozilla.org">Waldo</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">decoder</span>: Have you looked at how the one-off integer sanitizers and <code>--enable-undefined-sanitizer</code> are coded up?  It's basically the exact same code repeated three times.</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Sun Oct 11 2020 22:17:52 GMT-0700 (Pacific Daylight Time)">05:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell">make it so <code>--enable-undefined-sanitizer</code> is equal to <code>--enable-undefined-sanitizer=defaults</code> and then defaults expands to what we have in <code>default_checks</code> right now. then the jobs should be happy</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Sun Oct 11 2020 22:18:20 GMT-0700 (Pacific Daylight Time)">05:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell">id tackle the integer sanitizers in another bug, I dont remember what logic is tied to that. there are suppression lists in use for those and we havent used this code for a whole while</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Sun Oct 11 2020 22:18:32 GMT-0700 (Pacific Daylight Time)">05:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell">the <code>--enable-undefined-sanitizer</code> code is used in CI</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Sun Oct 11 2020 22:19:09 GMT-0700 (Pacific Daylight Time)">05:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@waldo:mozilla.org">Waldo</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">decoder</span>: As to why I'm investigating, for some unclear reason my local clang setup, when I build with any of these in place, is complaining at the final link step about undefined references to particular ubsan symbols.  And figuring out the problem, required looking at all three places to see if any one of them was doing a right thing, that the others should have done.  (It doesn't appear they do different things.)</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Sun Oct 11 2020 22:19:31 GMT-0700 (Pacific Daylight Time)">05:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell">with the mozbuild clang?</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Sun Oct 11 2020 22:20:17 GMT-0700 (Pacific Daylight Time)">05:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@waldo:mozilla.org">Waldo</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">decoder</span>: <a href="https://paste.mozilla.org/6mLqjg11">https://paste.mozilla.org/6mLqjg11</a> is I believe a minimized mozconfig that was hitting the undefined symbols.</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Sun Oct 11 2020 22:21:17 GMT-0700 (Pacific Daylight Time)">05:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@waldo:mozilla.org">Waldo</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">decoder</span>: The custom CC/CXX/LLVM* refer to a clang tip that's maybe within the last month or two old.  Otherwise nothing special about it.</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Sun Oct 11 2020 22:58:31 GMT-0700 (Pacific Daylight Time)">05:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell">I'll look at the mozconfig in a few</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Sun Oct 11 2020 23:02:33 GMT-0700 (Pacific Daylight Time)">06:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@decoder:mozilla.org">decoder</span>&gt;</div></td><td class="msg-cell">Waldo: I think you need to add back at least the disable-jemalloc flag but other than that I don't see anything that sticks out immediately. Please try the mozbuild clang to ensure it isn't some sort of regression from that.</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Sun Oct 11 2020 23:03:16 GMT-0700 (Pacific Daylight Time)">06:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@waldo:mozilla.org">Waldo</span>&gt;</div></td><td class="msg-cell">Will give a look soonish, hopefully.</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Sun Oct 11 2020 23:03:45 GMT-0700 (Pacific Daylight Time)">06:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@waldo:mozilla.org">Waldo</span>&gt;</div></td><td class="msg-cell">Odds are it's a problem with my home-built clang, but danged if I can see how, as I can compile programs that sanitize stuff using the compiler directly.</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Sun Oct 11 2020 23:04:06 GMT-0700 (Pacific Daylight Time)">06:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@waldo:mozilla.org">Waldo</span>&gt;</div></td><td class="msg-cell">Hence why I was grunging through the build stuff to see how it implemented sanitizer support.</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Mon Oct 12 2020 06:00:05 GMT-0700 (Pacific Daylight Time)">13:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell"><span class="nick-10">jandem</span>: The test case should have the <del>red</del> green light to be tested on Apple AArch64.</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Mon Oct 12 2020 06:06:43 GMT-0700 (Pacific Daylight Time)">13:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">nbp</span>: great. Probably easiest to get everything landed and then we can run jsapi-tests on the device </td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Mon Oct 12 2020 06:07:06 GMT-0700 (Pacific Daylight Time)">13:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@nbp:mozilla.org">nbp</span>&gt;</div></td><td class="msg-cell">either is good to me!</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Mon Oct 12 2020 06:44:50 GMT-0700 (Pacific Daylight Time)">13:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">I think I might move the postscript from my tc39 emails to somewhere static and link to it, rather than having the massive list of links</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Mon Oct 12 2020 06:44:59 GMT-0700 (Pacific Daylight Time)">13:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell"><span class="nick-10">jandem</span>: do you think the website would be a good place?</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Mon Oct 12 2020 06:46:03 GMT-0700 (Pacific Daylight Time)">13:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-10">yulia</span>: you mean like a blog post per meeting? I think that would be great </td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Mon Oct 12 2020 06:46:12 GMT-0700 (Pacific Daylight Time)">13:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">Oh, thats also a good idea</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Mon Oct 12 2020 06:49:23 GMT-0700 (Pacific Daylight Time)">13:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">Should I just start doing that?</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Mon Oct 12 2020 06:49:33 GMT-0700 (Pacific Daylight Time)">13:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">In fact, we can migrate the tc39 updates to the blog</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Mon Oct 12 2020 07:06:08 GMT-0700 (Pacific Daylight Time)">14:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-10">yulia</span>: yes, makes a lot of sense to have it on there I think</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Mon Oct 12 2020 07:06:37 GMT-0700 (Pacific Daylight Time)">14:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">Ok, ill find some time to do that</td></tr>

</tbody></table></div></div></div>
</body></html>