<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2023-12-06</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2023-12-06<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2023-12-05" class="nav-link"><span>prev</span></a>
<a href="2023-12-07" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Dec 06 2023 06:04:45 GMT-0800 (Pacific Standard Time)">14:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@vladyslavy:mozilla.org">vladyslavy</span>&gt;</div></td><td class="msg-cell">Hello everyone, I'm a user of spidermonkey 102.12.0.
I'm faced with the fact that the engine creates helper threads and performs some of the work in separate threads (for example, GC). 
But due to some specifics, I am limited in creating threads and I need all the logic to be in the main thread. 
Is it possible to achieve this through the public API of the Spidermonkey engine? I will be grateful for your help.

PS: I found the js::DisableExtraThreads function, but unfortunately it is in the non-public part of the engine. </td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Dec 06 2023 06:17:24 GMT-0800 (Pacific Standard Time)">14:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">yeah <code>DisableExtraThreads</code> is what you'd want, but I don't think there's a way to achieve this with the public API</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Dec 06 2023 06:18:11 GMT-0800 (Pacific Standard Time)">14:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">there are flags to disable some of the off-thread tasks like Ion compilation, but probably not for all of them</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Dec 06 2023 06:24:07 GMT-0800 (Pacific Standard Time)">14:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@vladyslavy:mozilla.org">vladyslavy</span>&gt;</div></td><td class="msg-cell">Maybe I can do a trick with <code>SetHelperThreadTaskCallback</code>?<br>For example, set a callback that immediately runs <code>RunHelperThreadTask</code>. But it crashes because of a mutex ordering violation, is there any way I can avoid it?</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Dec 06 2023 07:44:30 GMT-0800 (Pacific Standard Time)">15:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">I think that's unlikely to work well. I'd suggest adding a public API for <code>js::DisableExtraThreads</code> in your copy of SM 102</td></tr>

</tbody></table></div></div></div>
</body></html>