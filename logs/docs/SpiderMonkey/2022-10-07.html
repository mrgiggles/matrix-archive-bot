<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2022-10-07</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2022-10-07<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-10-06" class="nav-link"><span>prev</span></a>
<a href="2022-10-10" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search SpiderMonkey">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Fri Oct 07 2022 06:42:00 GMT-0700 (Pacific Daylight Time)">13:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@pslack:mozilla.org">pslack</span>&gt;</div></td><td class="msg-cell">Hello folks, I am getting an error cloning mercurial, I am following instructions from this site <a href="https://wiki.mozilla.org/JavaScript:New_to_SpiderMonkey">https://wiki.mozilla.org/JavaScript:New_to_SpiderMonkey</a>. .. the clone dies at the end :  hg clone <a href="https://hg.mozilla.org/mozilla-central">https://hg.mozilla.org/mozilla-central</a> spidermonkey
applying clone bundle from <a href="https://hg.cdn.mozilla.net/mozilla-central/517d690052a2c3b4011b937aa9d0220e52f754e6.zstd-max.hg">https://hg.cdn.mozilla.net/mozilla-central/517d690052a2c3b4011b937aa9d0220e52f754e6.zstd-max.hg</a>
adding changesets
adding manifests                                                                                                                                                                                       
adding file changes                                                                                                                                                                                    
transaction abort!                                                                                                                                                                                     
rollback completed
abort: stream ended unexpectedly  (got 16010 bytes, expected 32768)</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Fri Oct 07 2022 07:22:11 GMT-0700 (Pacific Daylight Time)">14:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">pslack</span>: I'd suggest asking the #introduction channel. That is a general issue and someone may have better workarounds there. I have seen that in the past with slow network/disk but I'm not sure what the normal fix is..</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Fri Oct 07 2022 07:30:31 GMT-0700 (Pacific Daylight Time)">14:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@pslack:mozilla.org">pslack</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-6">pslack</span>: I'd suggest asking the #introduction channel. That is a general issue and someone may have better workarounds there. I have seen that in the past with slow network/disk but I'm not sure what the normal fix is..</blockquote></mx-reply>Hi , thanks for your response, my connection is 1.2 Gbs up and down .. I tried verbose it gave a little more info: .. (sent 2 HTTP requests and 450 bytes; received 5269 bytes in responses)<br>abort: stream ended unexpectedly  (got 15850 bytes, expected 32768) .. I'll post to the other channel.</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Fri Oct 07 2022 07:32:48 GMT-0700 (Pacific Daylight Time)">14:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">Ah, I think that error comes up for a few odd reasons. The other channel hopefully has seen it recently and has ideas</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Fri Oct 07 2022 08:39:33 GMT-0700 (Pacific Daylight Time)">15:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@puucee:mozilla.org">puucee</span>&gt;</div></td><td class="msg-cell">Hello. I was redirected here from Mozilla general.</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Fri Oct 07 2022 08:40:08 GMT-0700 (Pacific Daylight Time)">15:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@puucee:mozilla.org">puucee</span>&gt;</div></td><td class="msg-cell">I'm trying to find Array.indexOf implementation in Firefox from mozilla source code. Is this the right function? <a href="https://hg.mozilla.org/mozilla-central/file/tip/js/src/builtin/Array.cpp#l4197">https://hg.mozilla.org/mozilla-central/file/tip/js/src/builtin/Array.cpp#l4197</a></td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Fri Oct 07 2022 08:41:46 GMT-0700 (Pacific Daylight Time)">15:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@ms2ger:igalia.com">Ms2ger 游눌游눌游눌</span>&gt;</div></td><td class="msg-cell">Yes</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Fri Oct 07 2022 08:42:07 GMT-0700 (Pacific Daylight Time)">15:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@ms2ger:igalia.com">Ms2ger 游눌游눌游눌</span>&gt;</div></td><td class="msg-cell">That was easy, wan't it :)</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Fri Oct 07 2022 08:43:01 GMT-0700 (Pacific Daylight Time)">15:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@puucee:mozilla.org">puucee</span>&gt;</div></td><td class="msg-cell">apparently it was, the codebase was just pretty big and i was feeling lost :P. Thanks </td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Fri Oct 07 2022 08:47:01 GMT-0700 (Pacific Daylight Time)">15:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@puucee:mozilla.org">puucee</span>&gt;</div></td><td class="msg-cell">There was debate in our workplace today whether it makes any difference to just iterate two arrays in nested loops or using Array.indexOf to find the first occurence of start of search sequence "subarray" (apparently the reason was  optimization - things like does it leverage processor string commands or sse) and even though it doesn't really matter for everyday use it's interesting question</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Fri Oct 07 2022 08:55:20 GMT-0700 (Pacific Daylight Time)">15:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">In general a builtin will be faster. Often for the reason that Clang on average optimizes C++ between than a web browser optimizes JS (since we optimize JS on client, we can't spend too much time in the JITs).</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Fri Oct 07 2022 08:55:58 GMT-0700 (Pacific Daylight Time)">15:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@tcampbell:mozilla.org">tcampbell</span>&gt;</div></td><td class="msg-cell">Whether things like SSE are used varies across different builtins, browsers, and time (these types of optimizations may get added or removed).</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Fri Oct 07 2022 11:29:05 GMT-0700 (Pacific Daylight Time)">18:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell"><p>Is there an easy way to pass a RootedValue as a HandleObject?</p>
<p>I'd like to avoid declaring an extra variable if possible:</p>
<pre><code>JS::RootedValue testVecVal; // This stores a Uint8_Array
    JS::RootedObject testVecObj(testVecVal.toObjectOrNull());
    JS::DetachArrayBuffer(ctx, testVecObj);

</code></pre>
</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Fri Oct 07 2022 11:30:49 GMT-0700 (Pacific Daylight Time)">18:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">kfjvj</span>: No, you have to re-root.</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Fri Oct 07 2022 11:32:42 GMT-0700 (Pacific Daylight Time)">18:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">( I realize I missed the context parameter in the testVecObj constructor)</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Fri Oct 07 2022 11:33:41 GMT-0700 (Pacific Daylight Time)">18:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Under the covers a Handle&lt;Foo&gt; is a pointer to a Rooted&lt;Foo&gt;, which is just a Foo stored in a location the GC knows about. So HandleObject is a pointer to a JSObject*, and RootedValue is a Value, and you can't point a JSObject** at a Value.</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Fri Oct 07 2022 11:34:47 GMT-0700 (Pacific Daylight Time)">18:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">Got it, I guess I'm stuck declaring a billion variables.</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Fri Oct 07 2022 11:35:58 GMT-0700 (Pacific Daylight Time)">18:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell">Not a huge deal, though.</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Fri Oct 07 2022 11:40:14 GMT-0700 (Pacific Daylight Time)">18:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">sometimes spidermonkey APIs have overloads so they can accept both HandleObject and HandleValue</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Fri Oct 07 2022 11:42:54 GMT-0700 (Pacific Daylight Time)">18:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> sometimes spidermonkey APIs have overloads so they can accept both HandleObject and HandleValue</blockquote></mx-reply>Looks like buffer detaching isn't one of those.  It makes sense, since it's dealing with memory management.</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Fri Oct 07 2022 12:26:14 GMT-0700 (Pacific Daylight Time)">19:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">kfjvj</span>:  out of curiosity, why would you be detaching a large number of Uint8Arrays?</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Fri Oct 07 2022 14:57:40 GMT-0700 (Pacific Daylight Time)">21:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@kfjvj:mozilla.org">kfjvj</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-15">kfjvj</span>:  out of curiosity, why would you be detaching a large number of Uint8Arrays?</blockquote></mx-reply>I'm not detatching a large number of Uint8Arrays.  I'm just exaggerating to complain about the fact that I have to declare an extra variable instead of using an expression.</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Fri Oct 07 2022 14:58:43 GMT-0700 (Pacific Daylight Time)">21:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">the bits, they are different</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Fri Oct 07 2022 14:58:58 GMT-0700 (Pacific Daylight Time)">21:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">(between <code>JSObject*</code> and <code>JS::Value</code>)</td></tr>

</tbody></table></div></div></div>
</body></html>