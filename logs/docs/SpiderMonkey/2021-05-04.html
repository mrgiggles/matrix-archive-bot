<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2021-05-04</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2021-05-04<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2021-05-03" class="nav-link"><span>prev</span></a>
<a href="2021-05-05" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue May 04 2021 04:05:04 GMT-0700 (Pacific Daylight Time)">11:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">wohoo</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue May 04 2021 04:05:17 GMT-0700 (Pacific Daylight Time)">11:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">new logo is up :DD</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue May 04 2021 04:12:14 GMT-0700 (Pacific Daylight Time)">11:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@dehrenberg:igalia.com">littledan</span>&gt;</div></td><td class="msg-cell">Awesome!</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue May 04 2021 04:33:04 GMT-0700 (Pacific Daylight Time)">11:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">I think we are ready with the website too</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Tue May 04 2021 05:03:27 GMT-0700 (Pacific Daylight Time)">12:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><span class="nick-10">jandem</span>: ping</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Tue May 04 2021 05:03:55 GMT-0700 (Pacific Daylight Time)">12:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">almost there</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Tue May 04 2021 08:14:28 GMT-0700 (Pacific Daylight Time)">15:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">confession: Posted my <a href="https://www.mgaudet.ca/technical/2021/5/4/implementing-private-fields-for-javascript">much delayed Private Field implementation blog post</a></td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Tue May 04 2021 08:16:06 GMT-0700 (Pacific Daylight Time)">15:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">where is the document that outreachy people have been using for getting started? over in <a href="https://phabricator.services.mozilla.com/D113598">https://phabricator.services.mozilla.com/D113598</a> I'm trying to figure out how we had people building with <code>--disable-optimize</code>.</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Tue May 04 2021 08:19:05 GMT-0700 (Pacific Daylight Time)">15:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">sfink</span>: this is what we had been sending people <a href="https://docs.google.com/document/d/16tQqxYKXiwORe95UdlhGD2u8zDg3OH0UmSBMRy7F33U/preview">https://docs.google.com/document/d/16tQqxYKXiwORe95UdlhGD2u8zDg3OH0UmSBMRy7F33U/preview</a></td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Tue May 04 2021 08:19:16 GMT-0700 (Pacific Daylight Time)">15:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">(and was linked on the project page I think) </td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Tue May 04 2021 08:20:07 GMT-0700 (Pacific Daylight Time)">15:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">Huh. I see only <code>--enable-optimize</code> there, and that's the default.</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Tue May 04 2021 08:20:27 GMT-0700 (Pacific Daylight Time)">15:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I could ask the people it's happened to.</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Tue May 04 2021 08:42:53 GMT-0700 (Pacific Daylight Time)">15:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">I think our old read-the-docs build instructions suggested <code>--enable-debug --disable-optimize</code>, and Ted just changed it last week</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Tue May 04 2021 08:44:16 GMT-0700 (Pacific Daylight Time)">15:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><a href="https://phabricator.services.mozilla.com/D113597">https://phabricator.services.mozilla.com/D113597</a></td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Tue May 04 2021 08:45:51 GMT-0700 (Pacific Daylight Time)">15:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">Hi! I have a couple of questions about the ArrayPushDense builtin. Is this the right room to ask?</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Tue May 04 2021 08:47:17 GMT-0700 (Pacific Daylight Time)">15:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-7">Shankara Pailoor</span>: Yep!</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Tue May 04 2021 08:48:42 GMT-0700 (Pacific Daylight Time)">15:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">Is it possible for the builtin to invoke a callback?</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Tue May 04 2021 08:49:22 GMT-0700 (Pacific Daylight Time)">15:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">I ran an analysis which generated a path which might be spurious but I am not quite sure</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Tue May 04 2021 08:50:51 GMT-0700 (Pacific Daylight Time)">15:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">ArrayPushDense-&gt;array_push-&gt;SetLengthProperty-&gt;SetProperty-&gt;NativeSetProperty-&gt;SetExistingProperty-&gt;CallSetter-&gt;InternalCall
</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Tue May 04 2021 08:51:58 GMT-0700 (Pacific Daylight Time)">15:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">I tried to construct some examples to trigger the path but I haven't so far</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Tue May 04 2021 08:52:36 GMT-0700 (Pacific Daylight Time)">15:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell"><ol>
<li>The object cannot be an array and 2) It cannot have the Indexed property. So I tried to create an object var v = {} and set v.<strong>proto</strong> to be an array</li>
</ol>
</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Tue May 04 2021 08:52:43 GMT-0700 (Pacific Daylight Time)">15:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">That's spurious, because the <code>length</code> property of an array is not configurable</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Tue May 04 2021 08:54:33 GMT-0700 (Pacific Daylight Time)">15:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">oh I see</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Tue May 04 2021 08:54:55 GMT-0700 (Pacific Daylight Time)">15:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">by not configurable do you mean it cannot be overridden?</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Tue May 04 2021 08:55:31 GMT-0700 (Pacific Daylight Time)">15:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Yes. In particular it can't be replaced with a setter.</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Tue May 04 2021 08:55:34 GMT-0700 (Pacific Daylight Time)">15:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">i'm a bit new to JS as well</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Tue May 04 2021 08:55:42 GMT-0700 (Pacific Daylight Time)">15:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">oh i see</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Tue May 04 2021 08:56:37 GMT-0700 (Pacific Daylight Time)">15:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">If you try <code>Object.defineProperty([], "length", { set(x) {/*replacement code*/} })</code>, you'll get <code>TypeError: can't redefine non-configurable property "length"</code></td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Tue May 04 2021 08:57:51 GMT-0700 (Pacific Daylight Time)">15:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">oh great! ty </td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Tue May 04 2021 08:58:40 GMT-0700 (Pacific Daylight Time)">15:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">More about property attributes <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty">here</a></td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Tue May 04 2021 09:01:21 GMT-0700 (Pacific Daylight Time)">16:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">One other question. Are all callbacks triggered by "CallJSNative"</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Tue May 04 2021 09:04:38 GMT-0700 (Pacific Daylight Time)">16:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">No. For example, calls made from JIT code won't go through <code>CallJSNative</code></td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Tue May 04 2021 09:05:55 GMT-0700 (Pacific Daylight Time)">16:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">oh so could callbacks made through builtins not go through CallJSNative?</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Tue May 04 2021 09:08:54 GMT-0700 (Pacific Daylight Time)">16:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Correct. Many builtins are implemented in self-hosted JS: for example, <a href="https://searchfox.org/mozilla-central/source/js/src/builtin/Array.js#197-226">Array#forEach</a></td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Tue May 04 2021 09:09:55 GMT-0700 (Pacific Daylight Time)">16:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">And sometimes from JIT code we call specialized version via e.g. <code>callWithABI</code></td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Tue May 04 2021 09:10:26 GMT-0700 (Pacific Daylight Time)">16:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Or we just inline a builtin completely, like <a href="http://Function.call">Function.call</a> or Function.apply</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Tue May 04 2021 09:13:20 GMT-0700 (Pacific Daylight Time)">16:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">There's a big list of builtins that get special handling <a href="https://searchfox.org/mozilla-central/rev/185ab5e4f4e01341e009cd4633d1275ffe4d4c8b/js/src/jit/CacheIR.cpp#8703">here</a></td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Tue May 04 2021 09:14:29 GMT-0700 (Pacific Daylight Time)">16:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">oh i see thanks a lot</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Tue May 04 2021 09:15:33 GMT-0700 (Pacific Daylight Time)">16:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">iain</span>: regarding that call path I posted before is it true that length cannot be overriden for non-arrays?</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Tue May 04 2021 09:16:38 GMT-0700 (Pacific Daylight Time)">16:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell"><a href="https://searchfox.org/mozilla-central/source/js/src/builtin/Array.cpp#2281">https://searchfox.org/mozilla-central/source/js/src/builtin/Array.cpp#2281</a></td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Tue May 04 2021 09:16:58 GMT-0700 (Pacific Daylight Time)">16:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><a href="https://searchfox.org/mozilla-central/search?q=js_self_hosted_fn&amp;path=&amp;case=false&amp;regexp=false">Here's a searchfox query</a> that I think should turn up most self-hosted builtins</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Tue May 04 2021 09:17:24 GMT-0700 (Pacific Daylight Time)">16:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Although you might also have to look for JS_SELF_HOSTED_SYM_FN; off the top of my head I don't know the difference</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Tue May 04 2021 09:24:22 GMT-0700 (Pacific Daylight Time)">16:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">It is possible to call Array.push on non-arrays: for example, <code><a href="http://Array.prototype.push.call">Array.prototype.push.call</a>({notAnArray: true}, pushedValue)</code></td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Tue May 04 2021 09:25:10 GMT-0700 (Pacific Daylight Time)">16:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">But non-arrays can't make it to ArrayPushDense</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Tue May 04 2021 09:25:54 GMT-0700 (Pacific Daylight Time)">16:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Due to a long chain of logic that terminates <a href="https://searchfox.org/mozilla-central/source/js/src/jit/CacheIR.cpp#5147-5148">here</a></td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Tue May 04 2021 09:27:04 GMT-0700 (Pacific Daylight Time)">16:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">oh ok. So if I do something like <code>var p = {}, p.__proto__ = arr</code> // arr is some array, and then call p.push(1)</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Tue May 04 2021 09:28:14 GMT-0700 (Pacific Daylight Time)">16:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">(If you wrap text in backticks (`) it won't eat up your underscores)</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Tue May 04 2021 09:28:40 GMT-0700 (Pacific Daylight Time)">16:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">ty</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Tue May 04 2021 09:28:57 GMT-0700 (Pacific Daylight Time)">16:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">that should trigger ArrayPushDense right</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Tue May 04 2021 09:29:05 GMT-0700 (Pacific Daylight Time)">16:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><a href="http://Function.call">Function.call</a> lets you do that directly (see <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call">here</a>)</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Tue May 04 2021 09:29:31 GMT-0700 (Pacific Daylight Time)">16:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">(For some reason chat keeps thinking that <code><a href="http://Function.call">Function.call</a></code> is a link despite my best efforts)</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Tue May 04 2021 09:30:15 GMT-0700 (Pacific Daylight Time)">16:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">By "directly" I mean you don't have to change the prototype, you can just call the function with a different <code>this</code></td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Tue May 04 2021 09:31:26 GMT-0700 (Pacific Daylight Time)">16:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">but if I do the former I find it goes through ArrayPushDense but it sounds like that is correct</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Tue May 04 2021 09:31:32 GMT-0700 (Pacific Daylight Time)">16:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Try <code>var x = {length:0}; <a href="http://Array.prototype.push.call">Array.prototype.push.call</a>(x, 5)</code></td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Tue May 04 2021 09:33:00 GMT-0700 (Pacific Daylight Time)">16:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Through <code>ArrayPushDense</code>, or through <code>js::array_push</code>?</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Tue May 04 2021 09:33:18 GMT-0700 (Pacific Daylight Time)">16:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">through array_push</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Tue May 04 2021 09:33:21 GMT-0700 (Pacific Daylight Time)">16:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">as well</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Tue May 04 2021 09:33:34 GMT-0700 (Pacific Daylight Time)">16:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">wait let me double check</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Tue May 04 2021 09:34:02 GMT-0700 (Pacific Daylight Time)">16:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">my apologies i think just through <code>js::array_push</code></td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Tue May 04 2021 09:37:28 GMT-0700 (Pacific Daylight Time)">16:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><p>Note that it <em>is</em> possible to call arbitrary code via <code>js::array_push</code>:</p>
<pre><code>js&gt; var x = {}
js&gt; Object.defineProperty(x, "length", {set(x) { print("Length is " + x); this.length_ = x}, get() { return this.length_; }})
({})
js&gt; Array.prototype.push.call(x,5)
Length is 1
1
</code></pre>
</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Tue May 04 2021 09:39:27 GMT-0700 (Pacific Daylight Time)">16:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">do you know which MIR instruction this push would correspond to?</td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Tue May 04 2021 09:40:03 GMT-0700 (Pacific Daylight Time)">16:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">It's not a path we optimize, so it would just be some sort of call</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Tue May 04 2021 09:40:50 GMT-0700 (Pacific Daylight Time)">16:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">oh got it</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Tue May 04 2021 09:42:50 GMT-0700 (Pacific Daylight Time)">16:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Yeah, just verified that it's an MCall</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Tue May 04 2021 09:43:39 GMT-0700 (Pacific Daylight Time)">16:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Lowers to <code>CallNative</code>, because we know that it's going to call Array#push</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Tue May 04 2021 09:46:52 GMT-0700 (Pacific Daylight Time)">16:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">At this point it is probably worthwhile to ask: what is the big picture of what you're trying to accomplish here? There may be better approaches</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Tue May 04 2021 09:47:01 GMT-0700 (Pacific Daylight Time)">16:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">thanks</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Tue May 04 2021 09:47:04 GMT-0700 (Pacific Daylight Time)">16:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">sure</td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Tue May 04 2021 09:49:06 GMT-0700 (Pacific Daylight Time)">16:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">I remember reading about this IonMonkey vulnerability due to a bug in the alias analysis. I believe the bug was in the alias refinement of ArraySlice as the annotations said the only aliases that could be produced were between objects of a specific kind. however, that instruction actually invoked a callback which introduced an alias not captured by the annotations</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Tue May 04 2021 09:49:31 GMT-0700 (Pacific Daylight Time)">16:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">I was trying to write an analysis to see if there were any other such cases</td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Tue May 04 2021 09:50:02 GMT-0700 (Pacific Daylight Time)">16:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">specifically, were there instructions which said the alias set could be refined but in fact could invoke a callback </td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Tue May 04 2021 09:50:18 GMT-0700 (Pacific Daylight Time)">16:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">the array push dense was one possible case but with your help it turned out it isn't one</td></tr>
  <tr class="msg" id="L72"><td class="ts-cell"><a class="ts" href="#L72" alt="Tue May 04 2021 09:51:52 GMT-0700 (Pacific Daylight Time)">16:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">I'm a PL researcher at UT Austin</td></tr>
  <tr class="msg" id="L73"><td class="ts-cell"><a class="ts" href="#L73" alt="Tue May 04 2021 09:51:54 GMT-0700 (Pacific Daylight Time)">16:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@tjr:mozilla.org">tjr</span>&gt;</div></td><td class="msg-cell">(I'm not a spidermonkey dev, but I am kind of curious what you're using to develop your analysis. Is this CodeQL?)</td></tr>
  <tr class="msg" id="L74"><td class="ts-cell"><a class="ts" href="#L74" alt="Tue May 04 2021 09:52:06 GMT-0700 (Pacific Daylight Time)">16:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">no LLVM</td></tr>
  <tr class="msg" id="L75"><td class="ts-cell"><a class="ts" href="#L75" alt="Tue May 04 2021 09:53:14 GMT-0700 (Pacific Daylight Time)">16:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">If it were easy to write a static analysis for that, we would probably have already done so 😛</td></tr>
  <tr class="msg" id="L76"><td class="ts-cell"><a class="ts" href="#L76" alt="Tue May 04 2021 09:53:33 GMT-0700 (Pacific Daylight Time)">16:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">We did add runtime assertions, though: <a href="https://searchfox.org/mozilla-central/source/js/src/jit/CodeGenerator.cpp#328-345">https://searchfox.org/mozilla-central/source/js/src/jit/CodeGenerator.cpp#328-345</a></td></tr>
  <tr class="msg" id="L77"><td class="ts-cell"><a class="ts" href="#L77" alt="Tue May 04 2021 09:55:01 GMT-0700 (Pacific Daylight Time)">16:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">The default alias set aliases everything. In debug builds, if instructions have a non-default alias set but call into C++, then we set a flag saying that we don't expect user code to be invoked, and clear the flag when the call returns</td></tr>
  <tr class="msg" id="L78"><td class="ts-cell"><a class="ts" href="#L78" alt="Tue May 04 2021 09:56:06 GMT-0700 (Pacific Daylight Time)">16:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">(Technically there are two ways of calling into C++, but one of them (callWithABI) is already not allowed to call arbitrary JS, so we only have to protect the latter (callVM))</td></tr>
  <tr class="msg" id="L79"><td class="ts-cell"><a class="ts" href="#L79" alt="Tue May 04 2021 09:56:26 GMT-0700 (Pacific Daylight Time)">16:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@tjr:mozilla.org">tjr</span>&gt;</div></td><td class="msg-cell">Right on. Good luck, and please do be aware of our <a href="https://blog.mozilla.org/attack-and-defense/2019/11/14/adding-codeql-and-clang-to-our-bug-bounty-program/">Static Analysis Bounty</a> =)</td></tr>
  <tr class="msg" id="L80"><td class="ts-cell"><a class="ts" href="#L80" alt="Tue May 04 2021 09:57:23 GMT-0700 (Pacific Daylight Time)">16:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">tjr</span>: thanks!</td></tr>
  <tr class="msg" id="L81"><td class="ts-cell"><a class="ts" href="#L81" alt="Tue May 04 2021 09:59:04 GMT-0700 (Pacific Daylight Time)">16:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">iain</span>: Right now I'm just seeing if there are other instructions which have a similar kind of vulnerability to the ArraySlice case. In that case, the call back was invoked from CallSelfHostedFunction (which eventually calls CallJSNative)</td></tr>
  <tr class="msg" id="L82"><td class="ts-cell"><a class="ts" href="#L82" alt="Tue May 04 2021 09:59:44 GMT-0700 (Pacific Daylight Time)">16:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">that's why I thought CallJSNative was the entry point to calling user defined callbacks</td></tr>
  <tr class="msg" id="L83"><td class="ts-cell"><a class="ts" href="#L83" alt="Tue May 04 2021 10:02:34 GMT-0700 (Pacific Daylight Time)">17:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@spailoor:matrix.org">Shankara Pailoor</span>&gt;</div></td><td class="msg-cell">Were there similar bugs you encountered?</td></tr>
  <tr class="msg" id="L84"><td class="ts-cell"><a class="ts" href="#L84" alt="Tue May 04 2021 10:08:29 GMT-0700 (Pacific Daylight Time)">17:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">I believe we turned up some non-exploitable weirdness in bug 1607670</td></tr>
  <tr class="msg" id="L85"><td class="ts-cell"><a class="ts" href="#L85" alt="Tue May 04 2021 10:08:35 GMT-0700 (Pacific Daylight Time)">17:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1607670">https://bugzil.la/1607670</a> — RESOLVED (jandem) — Figure out what to do with CreateThis</td></tr>
  <tr class="msg" id="L86"><td class="ts-cell"><a class="ts" href="#L86" alt="Tue May 04 2021 12:21:36 GMT-0700 (Pacific Daylight Time)">19:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">I have a vague recollection that there's a process for getting added to release notes these days. Anyone know what I'm half-remembering? </td></tr>
  <tr class="msg" id="L87"><td class="ts-cell"><a class="ts" href="#L87" alt="Tue May 04 2021 12:30:45 GMT-0700 (Pacific Daylight Time)">19:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">I have a similarly vague recollection. I can't find anything in my email search. I suggest asking one of the rotating release owners like RyanVM.</td></tr>
  <tr class="msg" id="L88"><td class="ts-cell"><a class="ts" href="#L88" alt="Tue May 04 2021 12:34:26 GMT-0700 (Pacific Daylight Time)">19:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">for the developers release notes <em>the keyword</em> dev-doc-needed should be enough</td></tr>
  <tr class="msg" id="L89"><td class="ts-cell"><a class="ts" href="#L89" alt="Tue May 04 2021 12:35:03 GMT-0700 (Pacific Daylight Time)">19:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">the "real" release notes have a tracking flag called relnote-firefox</td></tr>
  <tr class="msg" id="L90"><td class="ts-cell"><a class="ts" href="#L90" alt="Tue May 04 2021 12:36:36 GMT-0700 (Pacific Daylight Time)">19:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">Ahh- ok. So you've taken care of that for me for fields and methods. Thanks <span class="nick-15">evilpie</span> !</td></tr>

</tbody></table></div></div></div>
</body></html>