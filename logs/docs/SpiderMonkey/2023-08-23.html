<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2023-08-23</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2023-08-23<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2023-08-22" class="nav-link"><span>prev</span></a>
<a href="2023-08-25" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search SpiderMonkey">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Aug 22 2023 18:26:56 GMT-0700 (Pacific Daylight Time)">01:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@smaug:mozilla.org">smaug</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">jonco</span>: FYI some weird <a href="https://treeherder.mozilla.org/perfherder/comparesubtest?originalProject=try&amp;newProject=try&amp;newRevision=e3de12548b25bf18d952d40ed83ac02fd3e21eaf&amp;originalSignature=4586009&amp;newSignature=4586009&amp;framework=13&amp;application=firefox&amp;originalRevision=5173e6287816ace74cb8e34812b0145719d5b98a&amp;page=1&amp;showOnlyConfident=1">results</a> I got from larger nursery + forced minor GC.  Just testing out how different kinds of tweaks affect the numbers.</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Aug 23 2023 06:20:00 GMT-0700 (Pacific Daylight Time)">13:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@lgoodacre:matrix.org">liam_g</span>&gt;</div></td><td class="msg-cell">If I do JSON.stringify() on an object with circular references, it throws an error. But if I do console.log() on that object, most browsers do something clever to read past the circular reference and present it somehow. I'd like to take a look at the source code for this. Can anyone tell me which file(s) to look at?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Aug 23 2023 07:20:51 GMT-0700 (Pacific Daylight Time)">14:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> If I do JSON.stringify() on an object with circular references, it throws an error. But if I do console.log() on that object, most browsers do something clever to read past the circular reference and present it somehow. I'd like to take a look at the source code for this. Can anyone tell me which file(s) to look at?</blockquote></mx-reply>we don't use JSON to serialize the logged object, but some other kind of serialization, only retrieving the "direct children properties", which in turn can be expaded again if you click on it, which also return serialized objects</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Aug 23 2023 07:23:09 GMT-0700 (Pacific Daylight Time)">14:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell">we're using what we call object actors to handle this (<a href="https://searchfox.org/mozilla-central/source/devtools/server/actors/object.js">https://searchfox.org/mozilla-central/source/devtools/server/actors/object.js</a>) and various helpers to handle serializations and properties iteration (in <a href="https://searchfox.org/mozilla-central/source/devtools/server/actors/object">https://searchfox.org/mozilla-central/source/devtools/server/actors/object</a>). 
</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Aug 23 2023 07:26:08 GMT-0700 (Pacific Daylight Time)">14:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell">this is for DevTools console by the way, then we have a set of helpers that take the serialize data and turn it into dom elements to be displayed.
We also have something directly in c++ to print to stdout which can be found here: <a href="https://searchfox.org/mozilla-central/source/dom/console/Console.cpp#2686">https://searchfox.org/mozilla-central/source/dom/console/Console.cpp#2686</a></td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Aug 23 2023 07:26:27 GMT-0700 (Pacific Daylight Time)">14:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@nchevobbe:mozilla.org">nchevobbe</span>&gt;</div></td><td class="msg-cell">hop this helps</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Aug 23 2023 08:37:46 GMT-0700 (Pacific Daylight Time)">15:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@lgoodacre:matrix.org">liam_g</span>&gt;</div></td><td class="msg-cell">Very helpful, thank you!</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Aug 23 2023 10:16:25 GMT-0700 (Pacific Daylight Time)">17:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">liam_g</span>: do you want this for display or for serialization/deserialization? If it is for the latter, you might want structured cloning instead. It will handle circular references, though it does not handle many other things (eg prototypes) so it totally depends on your needs.</td></tr>

</tbody></table></div></div></div>
</body></html>