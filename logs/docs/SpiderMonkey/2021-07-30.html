<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2021-07-30</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2021-07-30<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2021-07-29" class="nav-link"><span>prev</span></a>
<a href="2021-07-31" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search SpiderMonkey">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Fri Jul 30 2021 02:23:45 GMT-0700 (Pacific Daylight Time)">09:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@fke:mozilla.org">fke</span>&gt;</div></td><td class="msg-cell">Hi there! Does spidermonkey have an option for bounds checks instead of using guard pages (which I assume it uses judging from execution speed) to sandbox the WebAssembly linear memory?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Fri Jul 30 2021 02:33:08 GMT-0700 (Pacific Daylight Time)">09:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">fke</span>: there's an option to disable 'huge memory' on 64-bit platforms, in the browser that's the <code>javascript.options.wasm_disable_huge_memory = true</code> hidden pref</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Fri Jul 30 2021 02:33:37 GMT-0700 (Pacific Daylight Time)">09:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">just curious, why do you want bounds checks?</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Fri Jul 30 2021 02:34:39 GMT-0700 (Pacific Daylight Time)">09:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@fke:mozilla.org">fke</span>&gt;</div></td><td class="msg-cell">Honestly I was just curious as I am comparing Wasm runtimes and compilers and saw that V8 has an option to disable the utilization of guard pages</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Fri Jul 30 2021 02:35:25 GMT-0700 (Pacific Daylight Time)">09:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">ah right</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Fri Jul 30 2021 02:35:55 GMT-0700 (Pacific Daylight Time)">09:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">(note that there's also a <a href="https://matrix.to/#/#webassembly:mozilla.org">#webassembly:mozilla.org</a> room)</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Fri Jul 30 2021 02:36:18 GMT-0700 (Pacific Daylight Time)">09:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@fke:mozilla.org">fke</span>&gt;</div></td><td class="msg-cell">Perfect. Thank you!</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Fri Jul 30 2021 02:37:16 GMT-0700 (Pacific Daylight Time)">09:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@fke:mozilla.org">fke</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-12">fke</span>: there's an option to disable 'huge memory' on 64-bit platforms, in the browser that's the <code>javascript.options.wasm_disable_huge_memory = true</code> hidden pref</blockquote></mx-reply>Can this be set when using the spidermonkey js command line shell?</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Fri Jul 30 2021 02:38:22 GMT-0700 (Pacific Daylight Time)">09:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">fke</span>: <code>--disable-wasm-huge-memory</code></td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Fri Jul 30 2021 02:40:19 GMT-0700 (Pacific Daylight Time)">09:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@fke:mozilla.org">fke</span>&gt;</div></td><td class="msg-cell">Works like a charm</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Fri Jul 30 2021 02:56:40 GMT-0700 (Pacific Daylight Time)">09:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@l11d:mozilla.org">l11d</span>&gt;</div></td><td class="msg-cell">when changing the order of 2 MIR instructions (no intersecting aliasset), is there anything I'd need to take into account regarding resume points? I currently see <code>Assertion failure: isLowered()</code> in LIRGeneratorShared::buildSnapshot for some testcases but can't really figure out why</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Fri Jul 30 2021 04:10:08 GMT-0700 (Pacific Daylight Time)">11:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">l11d: you also shouldn't move an instruction before any of its operands (uses), I can imagine that triggering this assertion</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Fri Jul 30 2021 05:58:45 GMT-0700 (Pacific Daylight Time)">12:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell"><p>Hmm, slight crashing issue:</p>
<pre><code>js::frontend::ModuleCompiler&lt;char16_t&gt;::compile(JSContext *) BytecodeCompiler.cpp:775
ParseModuleToStencilAndMaybeInstantiate&lt;char16_t&gt;(JSContext *,js::frontend::CompilationInput &amp;,JS::SourceText&lt;char16_t&gt; &amp;,mozilla::Variant&lt;mozilla::UniquePtr&lt;js::frontend::ExtensibleCompilationStencil,JS::DeletePolicy&lt;js::frontend::ExtensibleCompilationStencil&gt; &gt;,mozilla::UniquePtr&lt;js::frontend::CompilationStencil,JS::DeletePolicy&lt;js::frontend::CompilationStencil&gt; &gt;,js::frontend::CompilationGCOutput *&gt; &amp;) BytecodeCompiler.cpp:886
CompileModuleImpl&lt;char16_t&gt;(JSContext *,const JS::ReadOnlyCompileOptions &amp;,JS::SourceText&lt;char16_t&gt; &amp;) BytecodeCompiler.cpp:983
js::frontend::CompileModule(JSContext *,const JS::ReadOnlyCompileOptions &amp;,JS::SourceText&lt;char16_t&gt; &amp;) BytecodeCompiler.cpp:995
CompileModuleHelper&lt;char16_t&gt;(JSContext *,const JS::ReadOnlyCompileOptions &amp;,JS::SourceText&lt;char16_t&gt; &amp;) Modules.cpp:107
JS::CompileModule(JSContext *,const JS::ReadOnlyCompileOptions &amp;,JS::SourceText&lt;char16_t&gt; &amp;) Modules.cpp:113
runtime::modules::compile_module(mozjs_sys::generated::root::JSContext *,str,Option&lt;std::path::Path*&gt;,str) modules.rs:49
modules::assert::assert::init_assert(mozjs_sys::generated::root::JSContext *,IonObject) assert.rs:81
modules::init_modules(mozjs_sys::generated::root::JSContext *,IonObject) lib.rs:22
cli::evaluate::eval_module(std::path::Path *) evaluate.rs:95
cli::commands::run::run(str) run.rs:17
cli::main() main.rs:97
core::ops::function::FnOnce::call_once&lt;fn(),tuple&lt;&gt;&gt;(void (*)()) function.rs:227
std::sys_common::backtrace::__rust_begin_short_backtrace&lt;fn(),tuple&lt;&gt;&gt;(void (*)()) backtrace.rs:125
std::rt::lang_start::{{closure}}&lt;tuple&lt;&gt;&gt;(std::rt::lang_start::closure-0 *) rt.rs:49
std::rt::lang_start_internal() rt.rs:34
std::rt::lang_start&lt;tuple&lt;&gt;&gt;(void (*)(),long long,unsigned char **) rt.rs:48
main 0x00007ff6e0c74b16
__scrt_common_main_seh() 0x00007ff6e26c3e4c
BaseThreadInitThunk 0x00007ff931377c24
RtlUserThreadStart 0x00007ff932aad721
</code></pre>
</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Fri Jul 30 2021 05:59:03 GMT-0700 (Pacific Daylight Time)">12:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell"><pre><code class="language-cpp">  MOZ_ASSERT_IF(!cx-&gt;isHelperThreadContext(), !cx-&gt;isExceptionPending());
</code></pre>
<p>this is the line specifically</p>
</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Fri Jul 30 2021 05:59:20 GMT-0700 (Pacific Daylight Time)">12:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">Any idea what could have caused it?</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Fri Jul 30 2021 06:02:13 GMT-0700 (Pacific Daylight Time)">13:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">do you have a pending exception on the context when you call <code>CompileModule</code>?</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Fri Jul 30 2021 06:02:35 GMT-0700 (Pacific Daylight Time)">13:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">I <em>shouldn't</em></td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Fri Jul 30 2021 06:02:57 GMT-0700 (Pacific Daylight Time)">13:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell">but there's only one place it could have occurred</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Fri Jul 30 2021 06:05:19 GMT-0700 (Pacific Daylight Time)">13:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@redfire75369:mozilla.org">Redfire</span>&gt;</div></td><td class="msg-cell"><pre><code class="language-rs">                rooted!(in(cx) let console = JS_NewPlainObject(cx));
		return JS_DefineFunctions(cx, console.handle().into(), METHODS.as_ptr())
			&amp;&amp; global.define(cx, String::from("console"), ObjectValue(console.get()), 0);
</code></pre>
</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Fri Jul 30 2021 06:22:11 GMT-0700 (Pacific Daylight Time)">13:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@l11d:mozilla.org">l11d</span>&gt;</div></td><td class="msg-cell"><p><span class="nick-10">jandem</span>: I'm taking care of def/use dependencies already, it feels like my issue is related to resume points.<br>When I have MIR code:<br><code>23:loadfixedslot (22:unbox (14:phi))</code><br><code>24:newplainobject (21:constant shape at ...)</code></p>
<p>and newplainobject-&gt;dependency()-&gt;dump() is:<br><code>resumepoint mode=After [omitting unrelated] loadfixedslot23 newplainobject24</code></p>
<p>would it be valid to reorder loadfixedslot and newplainobject? Maybe there some kind of ordering requirement w.r<br>.t. the resume point operands?</p>
</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Fri Jul 30 2021 06:28:54 GMT-0700 (Pacific Daylight Time)">13:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">l11d</span>: when you say "I'm taking care of def/use dependencies", does that include resume point uses? If in your example the <code>newplainobject</code> has a resume point that captures the <code>loadfixedslot</code> we can't reorder them</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Fri Jul 30 2021 06:31:04 GMT-0700 (Pacific Daylight Time)">13:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@l11d:mozilla.org">l11d</span>&gt;</div></td><td class="msg-cell">aaaah okay well this might just be the gist of it. with def/use dependencies I was referring to the operands of loadfixedslot and newplainobject. many thanks</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Fri Jul 30 2021 07:16:19 GMT-0700 (Pacific Daylight Time)">14:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">evilpie</span>: the Promise bug is very strange. the content of CSS file also affects the behavior :/   still trying to figure out the minimal testcase</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Fri Jul 30 2021 07:33:49 GMT-0700 (Pacific Daylight Time)">14:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">okay, figured out the minimal testcase.  it seems to be just timing issue or some complicate dependency</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Fri Jul 30 2021 07:33:57 GMT-0700 (Pacific Daylight Time)">14:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">and the minimal testcase is simple</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Fri Jul 30 2021 07:34:05 GMT-0700 (Pacific Daylight Time)">14:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">(fwiw, the context is bug 1723124</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Fri Jul 30 2021 07:34:06 GMT-0700 (Pacific Daylight Time)">14:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1723124">https://bugzil.la/1723124</a> — UNCONFIRMED (nobody) — Promise .then not called when .bind used</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Fri Jul 30 2021 07:57:15 GMT-0700 (Pacific Daylight Time)">14:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">the problem is that the behavior differs between browsers :/</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Fri Jul 30 2021 08:01:20 GMT-0700 (Pacific Daylight Time)">15:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@rhunt:mozilla.org">Ryan Hunt</span>&gt;</div></td><td class="msg-cell">Does anyone have a M1 machine that they could use to try to reproduce bug 1720650?</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Fri Jul 30 2021 08:01:22 GMT-0700 (Pacific Daylight Time)">15:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1720650">https://bugzil.la/1720650</a> — NEW (nobody) — [ARM64 M1]Zoom video is rendered incorrectly</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Fri Jul 30 2021 08:03:31 GMT-0700 (Pacific Daylight Time)">15:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">arai</span>: good work figuring this out</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Fri Jul 30 2021 08:03:50 GMT-0700 (Pacific Daylight Time)">15:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">so they are actually changing <code>bind</code> it's just another native</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Fri Jul 30 2021 08:04:32 GMT-0700 (Pacific Daylight Time)">15:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">yeah, and it should be an issue with the resulting function's realm, promise job's realm, and HostEnqueuePromiseJob's requirement</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Fri Jul 30 2021 08:04:52 GMT-0700 (Pacific Daylight Time)">15:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">now checking the spec</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Fri Jul 30 2021 08:42:59 GMT-0700 (Pacific Daylight Time)">15:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">looks like a bug around realm handling in EnqueuePromiseReactionJob with bound function</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Fri Jul 30 2021 08:43:27 GMT-0700 (Pacific Daylight Time)">15:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">we don't handle bound function there</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Fri Jul 30 2021 08:57:21 GMT-0700 (Pacific Daylight Time)">15:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">what should be the recommended migration path for embedders who use private slots?</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Fri Jul 30 2021 08:57:24 GMT-0700 (Pacific Daylight Time)">15:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">(re. <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1719457">https://bugzilla.mozilla.org/show_bug.cgi?id=1719457</a>)</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Fri Jul 30 2021 08:57:52 GMT-0700 (Pacific Daylight Time)">15:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">is it a matter of reserving a slot and sticking a <code>JS::PrivateValue</code> in there?</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Fri Jul 30 2021 09:12:51 GMT-0700 (Pacific Daylight Time)">16:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-13">ptomato</span>: yes, just use a reserved slot instead </td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Fri Jul 30 2021 09:14:36 GMT-0700 (Pacific Daylight Time)">16:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">seems to increase the boilerplate in embedder code, is there any chance that JSAPI could include a function that takes care of this boilerplate?</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Fri Jul 30 2021 09:37:02 GMT-0700 (Pacific Daylight Time)">16:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell"><p><span class="nick-13">ptomato</span>: it's not that much more boilerplate though:<br>JSCLASS_HAS_PRIVATE &gt; JSCLASS_HAS_RESERVED_SLOTS(1)<br>JS_SetPrivate &gt; JS_SetReservedSlot(0)<br>JS_GetPrivate &gt; JS_GetReservedSlot(0)</p>
<p>still, it will be a pita to rewrite all the current code for the objects that use both private and reserved slots (e.g. global object)</p>
</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Fri Jul 30 2021 09:38:16 GMT-0700 (Pacific Daylight Time)">16:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell">no wait</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Fri Jul 30 2021 09:38:58 GMT-0700 (Pacific Daylight Time)">16:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell">ReservedSlot uses JS object while SetPrivate accepts a plain pointer (so a native object could be used directly)</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Fri Jul 30 2021 09:41:07 GMT-0700 (Pacific Daylight Time)">16:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">right, you have to wrap all the pointers in <code>JS::PrivateValue(priv)</code> and unwrap them with <code>toPrivate()</code></td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Fri Jul 30 2021 09:41:18 GMT-0700 (Pacific Daylight Time)">16:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell">yikes</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Fri Jul 30 2021 09:42:30 GMT-0700 (Pacific Daylight Time)">16:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell">doable, but annoying =)</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Fri Jul 30 2021 10:56:59 GMT-0700 (Pacific Daylight Time)">17:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-13">ptomato</span>: there's a [helper function](<a href="https://searchfox.org/mozilla-central/rev/2aa97aea1085cf1363582725407c514833ad47e4/js/public/Object.h#114">https://searchfox.org/mozilla-central/rev/2aa97aea1085cf1363582725407c514833ad47e4/js/public/Object.h#114</a>) for getting a pointer out. We could add more of that </td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Fri Jul 30 2021 10:57:55 GMT-0700 (Pacific Daylight Time)">17:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">oh, that looks like what I was looking for</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Fri Jul 30 2021 10:59:52 GMT-0700 (Pacific Daylight Time)">17:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">sorry for the breakage. Private slots were a pain internally though and redundant with reserved slots </td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Fri Jul 30 2021 11:00:31 GMT-0700 (Pacific Daylight Time)">18:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">I actually assumed they were already reserved slots under the hood! :-)</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Fri Jul 30 2021 11:04:16 GMT-0700 (Pacific Daylight Time)">18:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">not really, it was implemented with a PrivateValue under the hood but still pretty different :) </td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Fri Jul 30 2021 11:12:15 GMT-0700 (Pacific Daylight Time)">18:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1723066">https://bugzil.la/1723066</a> — NEW (nobody) — Some pages' dynamic content doesn't load with dom.script_loader.full_parse = true</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Fri Jul 30 2021 14:29:14 GMT-0700 (Pacific Daylight Time)">21:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">confession: Away for a week, starting now-ish. </td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Fri Jul 30 2021 14:29:17 GMT-0700 (Pacific Daylight Time)">21:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell">Seen! Your update will eventually appear on <a href="https://robotzilla.github.io/histoire">https://robotzilla.github.io/histoire</a></td></tr>

</tbody></table></div></div></div>
</body></html>