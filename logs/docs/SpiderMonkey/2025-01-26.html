<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2025-01-26</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2025-01-26<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2025-01-25" class="nav-link"><span>prev</span></a>
<a href="2025-01-27" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Sat Jan 25 2025 16:47:06 GMT-0800 (Pacific Standard Time)">00:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@leftmostcat:matrix.org">leftmostcat (UTC-8)</span>&gt;</div></td><td class="msg-cell">It's Saturday, so if anyone responds before Monday I'll be mad at you. I'm taking a peek at <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1916432">https://bugzilla.mozilla.org/show_bug.cgi?id=1916432</a> and, if I understand correctly, the idea is that some number of MIR ops correspond directly to LIR ops and, instead of managing the correspondence by hand, the LIR op can be generated automatically. (I'm assuming MIR and LIR are mid- and low-level intermediate representations, respectively.)

I found js/src/jit/{M,L}IROps.yaml; what I'm missing is understanding how to find MIR ops that would be candidates for automated LIR generation and whether modifications would be needed outside those files.</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Sun Jan 26 2025 09:03:20 GMT-0800 (Pacific Standard Time)">17:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">leftmostcat (UTC-8)</span>: It's currently 4am Monday in Australia, so I'm going to go ahead and answer your question despite being in Canada.</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Sun Jan 26 2025 09:03:58 GMT-0800 (Pacific Standard Time)">17:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@leftmostcat:matrix.org">leftmostcat (UTC-8)</span>&gt;</div></td><td class="msg-cell">Got me on the details, dang. üòÅ</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Sun Jan 26 2025 09:04:44 GMT-0800 (Pacific Standard Time)">17:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">In addition to the files you've already found, the key files are <a href="https://searchfox.org/mozilla-central/source/js/src/jit/GenerateLIRFiles.py#281">GenerateLIRFiles.py</a> and <a href="https://searchfox.org/mozilla-central/source/js/src/jit/Lowering.cpp">Lowering.cpp</a>.</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Sun Jan 26 2025 09:06:04 GMT-0800 (Pacific Standard Time)">17:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><a href="https://searchfox.org/mozilla-central/source/js/src/jit/GenerateMIRFiles.py">GenerateMIRFiles.py</a> may also be relevant.</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Sun Jan 26 2025 09:10:11 GMT-0800 (Pacific Standard Time)">17:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Basically, there's a bunch of fairly mechanical boilerplate that needs to exist for every op. <code>MIROps.yaml</code> contains the information that we need to generate boilerplate for less complicated MIR ops. <code>LIROps.yaml</code> does the same for LIR ops. There are a bunch of complicated ops (many of which predate this system) that don't fit in, in which case we just write them by hand. In some cases, the op is simple enough that we actually have enough information in the MIR description to generate all the LIR boilerplate too.</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Sun Jan 26 2025 09:10:58 GMT-0800 (Pacific Standard Time)">17:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@leftmostcat:matrix.org">leftmostcat (UTC-8)</span>&gt;</div></td><td class="msg-cell">Great, thank you. I'll dig through it. :)</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Sun Jan 26 2025 09:11:05 GMT-0800 (Pacific Standard Time)">17:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Debadree did an initial implementation <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1916359">here</a></td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Sun Jan 26 2025 09:13:06 GMT-0800 (Pacific Standard Time)">17:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">Off the top of my head, I don't remember the exact criteria that a LIR op needs to meet to be eligible. But step 1 would be to look at the GenerateLIRFiles code and figure out what it can generate. Then I guess step 2 would be to look at LIR ops in LIROps.yaml to see if any of them could be generated now if we tagged them, and step 3 would be to see if there are any simple improvements we could make to the GenerateLIRFiles code to support more ops.</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Sun Jan 26 2025 09:14:56 GMT-0800 (Pacific Standard Time)">17:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@debadree25:mozilla.org">debadree25</span>&gt;</div></td><td class="msg-cell">generally what i saw is if the MIR and LIR op have same name they would be 1-1 and lot of the ops are same name </td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Sun Jan 26 2025 09:15:21 GMT-0800 (Pacific Standard Time)">17:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@debadree25:mozilla.org">debadree25</span>&gt;</div></td><td class="msg-cell">so easy win there just need to be careful they may have same name but different params </td></tr>

</tbody></table></div></div></div>
</body></html>