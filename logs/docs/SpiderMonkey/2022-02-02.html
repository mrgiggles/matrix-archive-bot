<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2022-02-02</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2022-02-02<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-02-01" class="nav-link"><span>prev</span></a>
<a href="2022-02-03" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Feb 02 2022 00:12:49 GMT-0800 (Pacific Standard Time)">08:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><span class="nick-10">yulia</span>: now I'm looking into module cache and esm-ification, and testing bug 1432901 patch.  how can I test the 3rd patch there (the cert decoder)?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Feb 02 2022 00:12:51 GMT-0800 (Pacific Standard Time)">08:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1432901">https://bugzil.la/1432901</a> — NEW (ystartsev) — Prototype loading ES6 Module as JSM</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Feb 02 2022 00:49:31 GMT-0800 (Pacific Standard Time)">08:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">There is a page. let me dig up my notes</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Feb 02 2022 00:50:14 GMT-0800 (Pacific Standard Time)">08:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">thank you!</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Feb 02 2022 01:12:00 GMT-0800 (Pacific Standard Time)">09:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">arai</span>: the content page is about:certificate, just looking for the devtools page. The patch for 1432901 isn't plugged in, i can send you a diff on how to do that: you would change the extensions imported by that page to .mjs</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Feb 02 2022 01:13:10 GMT-0800 (Pacific Standard Time)">09:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">is it "js" extensions in <code>certviewer.html</code> file ?</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Feb 02 2022 01:13:22 GMT-0800 (Pacific Standard Time)">09:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">yes</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Feb 02 2022 01:13:27 GMT-0800 (Pacific Standard Time)">09:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">~in the jsm~ sorry i may be misremebering this</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed Feb 02 2022 01:13:44 GMT-0800 (Pacific Standard Time)">09:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">for devtools, it is loaded by all devtools eagerly -- but the test panel is this one:</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed Feb 02 2022 01:15:07 GMT-0800 (Pacific Standard Time)">09:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">yeah, I don't see "jsm" occurrence in the directory</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed Feb 02 2022 01:15:21 GMT-0800 (Pacific Standard Time)">09:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">one important thing: that patch predates the work to split out the module loader as a reusable piece, and it also doesn't fully implement the module loading algorithm -- it doesn't eagerly fetch all of the modules</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed Feb 02 2022 01:15:48 GMT-0800 (Pacific Standard Time)">09:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">it reuses the mozjscomponentloader fetching, so if your caching work is done there -- you will see a change</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed Feb 02 2022 01:16:11 GMT-0800 (Pacific Standard Time)">09:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">on the other hand, if your caching work was done in dom/script/ -- then that hasn't been migrated yet</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed Feb 02 2022 01:16:24 GMT-0800 (Pacific Standard Time)">09:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">and you might not see the caching take effect with this patch</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed Feb 02 2022 01:16:43 GMT-0800 (Pacific Standard Time)">09:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">likely won't rather</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Wed Feb 02 2022 01:16:47 GMT-0800 (Pacific Standard Time)">09:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">the module cache isn't yet implemented.  now I'm preparing the StartupCache/ScriptPreloader code</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Wed Feb 02 2022 01:16:57 GMT-0800 (Pacific Standard Time)">09:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">Ah, i see. ok</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Wed Feb 02 2022 01:17:01 GMT-0800 (Pacific Standard Time)">09:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">and checking how it should behave</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Wed Feb 02 2022 01:17:17 GMT-0800 (Pacific Standard Time)">09:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">ok, then this should work as a place to test. this patch is very provisional</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Wed Feb 02 2022 01:17:36 GMT-0800 (Pacific Standard Time)">09:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">we will keep the loading behavior from the mozjscomponent loader</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Wed Feb 02 2022 01:18:35 GMT-0800 (Pacific Standard Time)">09:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">the module cache thing needs to be integrated into the new <code>mozJSComponentLoader::ObjectForLocationES6</code> function in your patch, just in the same way as regular script cache done in <code>mozJSComponentLoader::ObjectForLocation</code>, right?</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Wed Feb 02 2022 01:19:31 GMT-0800 (Pacific Standard Time)">09:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">yes, that is exactly right</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Wed Feb 02 2022 01:19:51 GMT-0800 (Pacific Standard Time)">09:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">devtools code is here: <a href="https://searchfox.org/mozilla-central/source/devtools/shared/webconsole/network-helper.js#86">https://searchfox.org/mozilla-central/source/devtools/shared/webconsole/network-helper.js#86</a></td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Wed Feb 02 2022 01:20:01 GMT-0800 (Pacific Standard Time)">09:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">it should work by just changing the extension</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Wed Feb 02 2022 01:20:11 GMT-0800 (Pacific Standard Time)">09:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">ah</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Wed Feb 02 2022 01:20:24 GMT-0800 (Pacific Standard Time)">09:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">thank you!  will try that</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Wed Feb 02 2022 01:21:02 GMT-0800 (Pacific Standard Time)">09:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">devtools is using the component loader, the about:certificate is a standard content page -- they share the same code so certdecoder was written to be both a jsm and an iify</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Wed Feb 02 2022 01:21:38 GMT-0800 (Pacific Standard Time)">09:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">the patch updates it so that certdecoder as a regular module</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Wed Feb 02 2022 01:22:06 GMT-0800 (Pacific Standard Time)">09:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">(sorry, haven't had tea yet this morning)</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Wed Feb 02 2022 01:31:09 GMT-0800 (Pacific Standard Time)">09:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">yeah, I see the code gets called :)</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Wed Feb 02 2022 01:31:26 GMT-0800 (Pacific Standard Time)">09:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">will try integrating cache there</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Wed Feb 02 2022 12:27:18 GMT-0800 (Pacific Standard Time)">20:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@mccr8:mozilla.org">mccr8</span>&gt;</div></td><td class="msg-cell">This is a writeup of a Chromium exploit found in the wild last year by Google TAG. The TLDR seems to be that they use a special pending exception value when throwing an exception in builtin code, and in some case they forgot to clear it, so the special value got thrown back to content. The magic exception value somehow is also a magic value for their Maps code, so it can be used to corrupt the map. <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1263462">https://bugs.chromium.org/p/chromium/issues/detail?id=1263462</a></td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Wed Feb 02 2022 15:36:13 GMT-0800 (Pacific Standard Time)">23:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> will try integrating cache there</blockquote></mx-reply>got the ES module cache working in <code>mozJSComponentLoader::ObjectForLocation</code>  :)</td></tr>

</tbody></table></div></div></div>
</body></html>