<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2022-07-24</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2022-07-24<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-07-22" class="nav-link"><span>prev</span></a>
<a href="2022-07-25" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Sun Jul 24 2022 00:33:38 GMT-0700 (Pacific Daylight Time)">07:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@zirak:mozilla.org">zirak</span>&gt;</div></td><td class="msg-cell"><p>Hey hey!<br>While looking around at some test262 failures I noticed the <a href="https://test262.report/features/legacy-regexp/annexB/built-ins/RegExp/legacy-accessors/lastParen/prop-desc.js?engines=chakra%2Cjavascriptcore%2Cspidermonkey%2Cv8%2Cxs%2Cqjs%2Cengine262">legacy RegExp accessors</a><br>At first I only had Spidermonkey selected, so it seemed like a relatively easy fix with some public web impact, and then I saw the other engines and how only JSC implements them "correctly"</p>
<p>Is this something that's legacy so just not interesting because of its web impact? Or am I missing a larger issue? Or is it just fine to fix, just generally uninteresting so nobody has come around to it yet?</p>
<p>Thanks!</p>
</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Sun Jul 24 2022 00:37:37 GMT-0700 (Pacific Daylight Time)">07:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@zirak:mozilla.org">zirak</span>&gt;</div></td><td class="msg-cell">Over in <a href="https://matrix.to/#/#introduction:mozilla.org">#introduction:mozilla.org</a> arai mentioned how the web impact might okayish given that JSC is implementing it differently, but that it's something to be verified. How can I progress from here? Just changing the descriptor flags is relatively easy, anything else?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Sun Jul 24 2022 00:50:38 GMT-0700 (Pacific Daylight Time)">07:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">in general, to modify some behavior, the first step is to check how many website depends on the behavior (so, breaks when it's modified), by adding telemetry</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Sun Jul 24 2022 00:51:54 GMT-0700 (Pacific Daylight Time)">07:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">so, for this case, add telemetry to the functions that behaves differently if you modify the behavior, and see how many times it gets hit</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Sun Jul 24 2022 00:53:24 GMT-0700 (Pacific Daylight Time)">07:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">and once the result says there's almost no case that gets affected, then the next step is to modify the behavior as nightly-only. so, modify the behavior on Nightly build, but keep the behavior on other builds, and see if you get bug reports for website breakage</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Sun Jul 24 2022 00:53:49 GMT-0700 (Pacific Daylight Time)">07:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">and if you don't get bug reports for a while, then it's safe to modify the behavior on all builds</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Sun Jul 24 2022 00:54:30 GMT-0700 (Pacific Daylight Time)">07:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">in this case, the telemetry step might be unnecessary</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Sun Jul 24 2022 00:55:34 GMT-0700 (Pacific Daylight Time)">07:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">but if there are some cases that gets affected, then the next step is to add warning message on Nightly, to notify the developers</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Sun Jul 24 2022 00:58:04 GMT-0700 (Pacific Daylight Time)">07:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">also, have you checked the related code?  there might be some comments that explains the history around the behavior</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Sun Jul 24 2022 02:37:05 GMT-0700 (Pacific Daylight Time)">09:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">To add telemetry, <a href="https://searchfox.org/mozilla-central/rev/9d28a7ce5812f6ccc06a6674a10c75becda4ff3d/js/src/vm/Runtime.h#219-223">js::Metrics</a> would be what you want</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Sun Jul 24 2022 05:15:30 GMT-0700 (Pacific Daylight Time)">12:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">are we failing that test because the configurable/enumerable attributes are wrong?</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Sun Jul 24 2022 05:16:17 GMT-0700 (Pacific Daylight Time)">12:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">yes</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Sun Jul 24 2022 05:16:19 GMT-0700 (Pacific Daylight Time)">12:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">(this is bug 1306461, it wasn't properly standardized before and now we should probably change our implementation to match the stage 3 proposal)</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Sun Jul 24 2022 05:16:20 GMT-0700 (Pacific Daylight Time)">12:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1306461">https://bugzil.la/1306461</a> — NEW (nobody) — Normalise and partially disable RegExp legacy features</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Sun Jul 24 2022 07:32:58 GMT-0700 (Pacific Daylight Time)">14:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell"><p>hey everyone!<br>Small question regarding native modules (ESR91): it is possible to create one without having to emulate them with ModuleInstantiate and code like this?</p>
<pre><code>const object_to_export = my_internal_native_loader('smth');
export default object_to_export ;
</code></pre>
</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Sun Jul 24 2022 07:33:32 GMT-0700 (Pacific Daylight Time)">14:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell">i.e. is it possible to define module and it's exports in native land?</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Sun Jul 24 2022 07:57:04 GMT-0700 (Pacific Daylight Time)">14:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">I don't think there's such public API (or even private API)</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Sun Jul 24 2022 07:59:39 GMT-0700 (Pacific Daylight Time)">14:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell">that's a shame</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Sun Jul 24 2022 07:59:44 GMT-0700 (Pacific Daylight Time)">14:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell">thanks anyway :)</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Sun Jul 24 2022 08:02:44 GMT-0700 (Pacific Daylight Time)">15:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">in m-c, the all Module implementation is moved to native from self-hosted code (<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1774454">bug 1774454</a> and followups), and it might help defining such API</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Sun Jul 24 2022 08:02:45 GMT-0700 (Pacific Daylight Time)">15:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell"><a href="https://bugzil.la/1774454">https://bugzil.la/1774454</a> — RESOLVED (jonco) — Replace self-hosted module implementation with C++</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Sun Jul 24 2022 08:47:15 GMT-0700 (Pacific Daylight Time)">15:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> in m-c, the all Module implementation is moved to native from self-hosted code (<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1774454">bug 1774454</a> and followups), and it might help defining such API</blockquote></mx-reply>I doubt that it will backported to esr91 anyway xD</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Sun Jul 24 2022 08:49:24 GMT-0700 (Pacific Daylight Time)">15:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell">and it seems that it missed esr102 as well</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Sun Jul 24 2022 08:59:58 GMT-0700 (Pacific Daylight Time)">15:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">to my understanding, it's still before the point of defining the semantics and interface</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Sun Jul 24 2022 09:12:55 GMT-0700 (Pacific Daylight Time)">16:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">and I guess it depends on <a href="https://github.com/tc39/ecma262/issues/395">built-in modules</a> or something (is there any web API proposals?) requires native implementation, in addition to the current script-based implementation</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Sun Jul 24 2022 14:56:40 GMT-0700 (Pacific Daylight Time)">21:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@ptomato:gnome.org">ptomato</span>&gt;</div></td><td class="msg-cell">it seems that embedded spidermonkey 91esr can't be built on Fedora 36 due to a different directory structure in the virtualenv than expected - is there an OS dependency here? the build still works on earlier versions of the OS</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Sun Jul 24 2022 14:57:49 GMT-0700 (Pacific Daylight Time)">21:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@ptomato:gnome.org">ptomato</span>&gt;</div></td><td class="msg-cell">it expects <code>$objdir/_virtualenvs/common/bin/python</code> and the actual location is <code>$objdir/_virtualenvs/common/local/bin/python</code></td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Sun Jul 24 2022 14:58:28 GMT-0700 (Pacific Daylight Time)">21:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@ptomato:gnome.org">ptomato</span>&gt;</div></td><td class="msg-cell">(however, just changing the expected location in <code>VirtualenvHelper.bin_path</code> leads to other errors)</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Sun Jul 24 2022 14:59:34 GMT-0700 (Pacific Daylight Time)">21:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@ptomato:gnome.org">ptomato</span>&gt;</div></td><td class="msg-cell">102esr works fine, I see that there has been significant refactoring of this part of the build system in between 91 and 102, but I'm not familiar enough with what affects what, to be able to point to a particular commit that could be backported</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Sun Jul 24 2022 14:59:44 GMT-0700 (Pacific Daylight Time)">21:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@ptomato:gnome.org">ptomato</span>&gt;</div></td><td class="msg-cell">does this seem familiar to anyone? any pointers?</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Sun Jul 24 2022 15:00:05 GMT-0700 (Pacific Daylight Time)">22:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@ptomato:gnome.org">ptomato</span>&gt;</div></td><td class="msg-cell">(if the answer is "you need to downgrade such-and-such in the OS" that would be fine too)</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Sun Jul 24 2022 16:17:15 GMT-0700 (Pacific Daylight Time)">23:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@ptomato:gnome.org">ptomato</span>&gt;</div></td><td class="msg-cell">^ I found that using python3.9 instead of python3.10 fixes the problem. I'm not sure where to look to solve it, or even if it would be worth solving since the problem has been refactored away in 102esr</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Sun Jul 24 2022 16:17:25 GMT-0700 (Pacific Daylight Time)">23:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@ptomato:gnome.org">ptomato</span>&gt;</div></td><td class="msg-cell">for now, I can work around it by using python3.9</td></tr>

</tbody></table></div></div></div>
</body></html>