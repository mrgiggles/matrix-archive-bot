<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2024-08-28</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2024-08-28<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2024-08-27" class="nav-link"><span>prev</span></a>
<a href="2024-08-29" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Aug 27 2024 23:42:09 GMT-0700 (Pacific Daylight Time)">06:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@debadree25:mozilla.org">debadree25</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-12">debadree25</span>: You can use <code>IONFLAGS=scripts</code> to see which scripts are being Ion compiled, and IONFLAGS=logs + <a href="https://searchfox.org/mozilla-central/source/js/src/devtools/iongraph/README.md">iongraph</a> to dump out a visualization of what Ion is doing</blockquote></mx-reply>in the graph generated by iongraph i see something like <code>resumepoint 72 71 70 69 68 67 66 65 64</code> what do these mean? as in instructions numbered &lt;the numbers given&gt; can resume from here?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Aug 27 2024 23:46:34 GMT-0700 (Pacific Daylight Time)">06:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">They are the numbers of the instructions that the resume point captures. When we resume in baseline interpreter, the value of the first instruction will be at the top of the stack, and the last value is at the bottom of the stack. (Note that "the stack" here also includes locals, <code>this</code>, the environment chain, and so on.)</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Aug 27 2024 23:49:22 GMT-0700 (Pacific Daylight Time)">06:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">When we bail out we tear apart the Ion stack frame and rebuild it into a baseline interpreter frame (or potentially multiple blinterp frames, if inlining is involved). A resume point tells us where to find all the values that will be in the blinterp frame if we bail out at that point.</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Aug 28 2024 00:00:14 GMT-0700 (Pacific Daylight Time)">07:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@debadree25:mozilla.org">debadree25</span>&gt;</div></td><td class="msg-cell">so its like a pointer to the stack values</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Aug 28 2024 01:26:30 GMT-0700 (Pacific Daylight Time)">08:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@gerard-majax:mozilla.org">gerard-majax</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> But I don't see any evidence here that JS is meaningfully involved in your performance problem.</blockquote></mx-reply>thanks, that's enough for me :)</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Aug 28 2024 08:47:29 GMT-0700 (Pacific Daylight Time)">15:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">sfink</span>: ping</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Aug 28 2024 09:19:49 GMT-0700 (Pacific Daylight Time)">16:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@jon4t4n:mozilla.org">jon4t4n</span>&gt;</div></td><td class="msg-cell">Is there a way of re-requesting a review from only one person in Phabricator? Does removing and re-adding them do the trick?</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Aug 28 2024 09:27:43 GMT-0700 (Pacific Daylight Time)">16:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">It depends on whether it's accepted or not. If it's accepted, then do "Plan Changes" and if there are other reviewers you no longer need, remove them. If it's not yet accepted (Needs Review), then you can remove the reviewer and re-add them as a blocking reviewer.</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed Aug 28 2024 09:27:53 GMT-0700 (Pacific Daylight Time)">16:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">or at least, I think that's the way it works. I'm not certain.</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed Aug 28 2024 14:14:48 GMT-0700 (Pacific Daylight Time)">21:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@yury:mozilla.org">yury</span>&gt;</div></td><td class="msg-cell">What is happening with promises reactions(?) during js::DestroyContext() ? Everything just disappears or there was some finalization phase before?</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed Aug 28 2024 14:22:29 GMT-0700 (Pacific Daylight Time)">21:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">We run a shutdown GC <a href="https://searchfox.org/mozilla-central/source/js/src/vm/Runtime.cpp#256">here</a> that might clean them up?</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed Aug 28 2024 14:38:37 GMT-0700 (Pacific Daylight Time)">21:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@yury:mozilla.org">yury</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> We run a shutdown GC <a href="https://searchfox.org/mozilla-central/source/js/src/vm/Runtime.cpp#256">here</a> that might clean them up?</blockquote></mx-reply>Okay, so looks like PromiseObject has no finalizers, nothing will invoke any (chain) reaction</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed Aug 28 2024 14:43:58 GMT-0700 (Pacific Daylight Time)">21:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell">What do you want to have happen?</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed Aug 28 2024 15:01:33 GMT-0700 (Pacific Daylight Time)">22:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@yury:mozilla.org">yury</span>&gt;</div></td><td class="msg-cell">More what I don't want to. Trying to figure out if I can have promise and still have debugger attached to its realm, during shutdown</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed Aug 28 2024 15:14:24 GMT-0700 (Pacific Daylight Time)">22:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@iain:mozilla.org">iain</span>&gt;</div></td><td class="msg-cell"><span class="nick-14">yury</span>: <a href="https://searchfox.org/mozilla-central/source/js/src/debugger/Debugger.cpp#4080-4091">This code</a> (and <a href="https://searchfox.org/mozilla-central/source/js/src/debugger/Debugger.cpp#5149-5169">this code</a> that it calls?) seems like it might be relevant. We call it during the sweep phase before we've finalized anything to detach the debugger from the global.</td></tr>

</tbody></table></div></div></div>
</body></html>