<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2022-08-02</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2022-08-02<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-08-01" class="nav-link"><span>prev</span></a>
<a href="2022-08-03" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Aug 02 2022 01:31:40 GMT-0700 (Pacific Daylight Time)">08:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> uhm, but how could it be provided as argument for the hook if the module has not been resolved yet?</blockquote></mx-reply>It's the private value for the importing module</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Aug 02 2022 02:01:52 GMT-0700 (Pacific Daylight Time)">09:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">when is the hook called and when is the value supposed to be set?  is the parameter supposed to be provided for the first hook call?  or only for subsequent calls?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Aug 02 2022 03:47:55 GMT-0700 (Pacific Daylight Time)">10:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">arai</span>: it's for the importer not the imported module - e.g. if module A imports module B then the hook is called with A's private and the specifier for B</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue Aug 02 2022 03:48:42 GMT-0700 (Pacific Daylight Time)">10:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">this isn't very clear</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Tue Aug 02 2022 03:49:31 GMT-0700 (Pacific Daylight Time)">10:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">okay, makes sense. can you add comments to public types/functions?</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Tue Aug 02 2022 03:49:43 GMT-0700 (Pacific Daylight Time)">10:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">yeah sure</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Tue Aug 02 2022 06:40:09 GMT-0700 (Pacific Daylight Time)">13:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@l11d:mozilla.org">l11d</span>&gt;</div></td><td class="msg-cell">if I execute the following statement once <code>Object(... new Float32Array(X));</code>: can/should this trigger the jitter depending on the value of X?</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Tue Aug 02 2022 06:47:15 GMT-0700 (Pacific Daylight Time)">13:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><p><span class="nick-4">l11d</span>: yes:</p>
<pre><code>M1MacBook:unified mgaudet$ IONFLAGS=scripts,bl-scripts ./mach run 
 0:00.31 /Users/mgaudet/unified/obj-debug-shell-aarch64-apple-darwin21.4.0/dist/bin/js
found tag: scripts
found tag: bl-scripts
js&gt;  function f(X) { Object(... new Float32Array(X)) } 
js&gt; f(10000)                                            
[BaselineScripts] Baseline compiling script typein:1:11 (3af9f5768060)
[BaselineScripts] Created BaselineScript 1090a9f00 (raw 1b88122ca900) for typein:1:11
[BaselineScripts] Baseline compiling script self-hosted:419:26 (3af9f5768330)
[BaselineScripts] Created BaselineScript 1093b2c00 (raw 1b88122cb400) for self-hosted:419:26
[IonScripts] Warp Compiling script typein:1:11 (3af9f5768060) (warmup-counter=1650,)
js&gt; 
</code></pre>
</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Tue Aug 02 2022 06:48:53 GMT-0700 (Pacific Daylight Time)">13:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@l11d:mozilla.org">l11d</span>&gt;</div></td><td class="msg-cell">this is interesting, thanks. so I guess having just the execution count for each line isn't really an indicator whether jitting took places</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Tue Aug 02 2022 06:49:51 GMT-0700 (Pacific Daylight Time)">13:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">Yeah; some source lines expand to quite a bit of bytecode (<code>dis(f)</code> above is 139 bytecodes long)</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Tue Aug 02 2022 06:50:44 GMT-0700 (Pacific Daylight Time)">13:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">and as you might expect from the semantics of spread, some syntax has internal loops, which are sufficient to trigger JIT compilation.</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Tue Aug 02 2022 06:52:25 GMT-0700 (Pacific Daylight Time)">13:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@l11d:mozilla.org">l11d</span>&gt;</div></td><td class="msg-cell">makes sense, thanks</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Tue Aug 02 2022 07:20:27 GMT-0700 (Pacific Daylight Time)">14:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">guys m running ../configure on Windows on spidermonkey start-shell.bat and I get this error:</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Tue Aug 02 2022 07:20:29 GMT-0700 (Pacific Daylight Time)">14:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">DEBUG: gmake: Looking for gmake
ERROR: Cannot find gmake</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Tue Aug 02 2022 07:20:37 GMT-0700 (Pacific Daylight Time)">14:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">how do I fix this gmake error</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Tue Aug 02 2022 07:28:07 GMT-0700 (Pacific Daylight Time)">14:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">Here's a bit more:</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Tue Aug 02 2022 07:28:08 GMT-0700 (Pacific Daylight Time)">14:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">checking for gmake... not found
DEBUG: gmake: Looking for mingw32-make
DEBUG: gmake: Looking for mozmake
DEBUG: gmake: Looking for make
DEBUG: gmake: Looking for gmake
ERROR: Cannot find gmake</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Tue Aug 02 2022 07:41:24 GMT-0700 (Pacific Daylight Time)">14:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">mozmake is supposed to be downloaded by either <code>./mach bootstrap</code> or <code>./mach build</code> (I don't remember which it was)</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Tue Aug 02 2022 07:42:01 GMT-0700 (Pacific Daylight Time)">14:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">if it works, iirc, it downloads into <code>~/.mozbuild/mozmake</code></td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Tue Aug 02 2022 07:58:03 GMT-0700 (Pacific Daylight Time)">14:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">how do you download mach?</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Tue Aug 02 2022 07:59:04 GMT-0700 (Pacific Daylight Time)">14:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ms2ger:igalia.com">Ms2ger ðŸ’‰ðŸ’‰</span>&gt;</div></td><td class="msg-cell">It's in the mozilla-central repository</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Tue Aug 02 2022 08:12:06 GMT-0700 (Pacific Daylight Time)">15:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">it's not in the gnome packages one?</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Tue Aug 02 2022 08:12:19 GMT-0700 (Pacific Daylight Time)">15:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">cuz i downloaded mozjs-91.5.0 from gnome</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Tue Aug 02 2022 08:12:34 GMT-0700 (Pacific Daylight Time)">15:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">actually nvm</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Tue Aug 02 2022 08:50:59 GMT-0700 (Pacific Daylight Time)">15:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">what does "./" mean in ./mach?</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Tue Aug 02 2022 08:51:33 GMT-0700 (Pacific Daylight Time)">15:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><code>.</code> is current directory, and <code>/</code> is directory separator</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Tue Aug 02 2022 08:51:46 GMT-0700 (Pacific Daylight Time)">15:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">so, it means <code>mach</code> file in current directory</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Tue Aug 02 2022 08:52:16 GMT-0700 (Pacific Daylight Time)">15:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">oh so why can't we just type mach</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Tue Aug 02 2022 08:52:26 GMT-0700 (Pacific Daylight Time)">15:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">./ looks like we're going back a directory</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Tue Aug 02 2022 08:52:46 GMT-0700 (Pacific Daylight Time)">15:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@l11d:mozilla.org">l11d</span>&gt;</div></td><td class="msg-cell">the parent directory is ..</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Tue Aug 02 2022 08:53:35 GMT-0700 (Pacific Daylight Time)">15:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">inside mozilla-build terminal, current directory is not in <code>PATH</code>, and if you type <code>mach</code>, it doesn't look for the file in current directory</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Tue Aug 02 2022 08:53:36 GMT-0700 (Pacific Daylight Time)">15:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@l11d:mozilla.org">l11d</span>&gt;</div></td><td class="msg-cell">you probably cannot do just <code>mach</code> because it not in your $PATH</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Tue Aug 02 2022 08:54:03 GMT-0700 (Pacific Daylight Time)">15:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">(this is different than windows command prompt where files in current directory can be executed without specifying the directory</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Tue Aug 02 2022 08:54:04 GMT-0700 (Pacific Daylight Time)">15:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">oh I see</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Tue Aug 02 2022 08:54:19 GMT-0700 (Pacific Daylight Time)">15:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">what does ./mach bootstrap install?</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Tue Aug 02 2022 08:54:28 GMT-0700 (Pacific Daylight Time)">15:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">does it install rust?</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Tue Aug 02 2022 08:54:56 GMT-0700 (Pacific Daylight Time)">15:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">clang, rust, cbindgen, and several other tools</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Tue Aug 02 2022 08:55:22 GMT-0700 (Pacific Daylight Time)">15:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">oh k is it possible to avoid installing clang since I already have it?</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Tue Aug 02 2022 08:55:37 GMT-0700 (Pacific Daylight Time)">15:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">it comes with Visual Studio</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Tue Aug 02 2022 08:55:51 GMT-0700 (Pacific Daylight Time)">15:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">I'm not sure if you can partially download tools</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Tue Aug 02 2022 08:56:00 GMT-0700 (Pacific Daylight Time)">15:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">right</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Tue Aug 02 2022 08:56:39 GMT-0700 (Pacific Daylight Time)">15:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">ok is it possible to call ../configure right after installing all the stuff thru bootstrap or do we have to set some environment variables?</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Tue Aug 02 2022 08:57:16 GMT-0700 (Pacific Daylight Time)">15:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">some tool might require explicit PATH</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Tue Aug 02 2022 08:57:36 GMT-0700 (Pacific Daylight Time)">15:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">ok</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Tue Aug 02 2022 08:57:46 GMT-0700 (Pacific Daylight Time)">15:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">I don't know the exact set of the tools.  try running configure and see if any error happens</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Tue Aug 02 2022 08:57:56 GMT-0700 (Pacific Daylight Time)">15:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">what about mozmake? would i have to set path for it?</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Tue Aug 02 2022 08:58:36 GMT-0700 (Pacific Daylight Time)">15:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">does bootstrap also download "gmake"?</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Tue Aug 02 2022 09:03:37 GMT-0700 (Pacific Daylight Time)">16:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">hmm, if you follow <a href="https://firefox-source-docs.mozilla.org/setup/windows_build.html">the document</a>, it will either setup everything automatically, or tell you when you need to do something manually.  but given you're already doing unusual thing, you'll need to figure out some details by your own</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Tue Aug 02 2022 09:04:11 GMT-0700 (Pacific Daylight Time)">16:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">how m i doing something unusual, just trying to build spidermonkey on windows :/</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Tue Aug 02 2022 09:12:10 GMT-0700 (Pacific Daylight Time)">16:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@l11d:mozilla.org">l11d</span>&gt;</div></td><td class="msg-cell">building on windows in not unusual whatsoever. its just that you want to build it while deviating from the intended/supported manner</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Tue Aug 02 2022 09:12:27 GMT-0700 (Pacific Daylight Time)">16:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell"><span class="nick-3">devscripter</span>: it's already quite unusual to build spidermonkey for embedding on any operating system, compared to building spidermonkey for firefox, so that's why</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Tue Aug 02 2022 09:13:57 GMT-0700 (Pacific Daylight Time)">16:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">but mozilla has pages dedicated to embedding Spidermonkey in C++ apps, it's just that I want to do it on Windows, and there aren't much details</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Tue Aug 02 2022 09:14:29 GMT-0700 (Pacific Daylight Time)">16:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> building on windows in not unusual whatsoever. its just that you want to build it while deviating from the intended/supported manner</blockquote></mx-reply>what do you mean deviating</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Tue Aug 02 2022 09:42:45 GMT-0700 (Pacific Daylight Time)">16:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">And what is the intended/supported manner?</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Tue Aug 02 2022 09:50:05 GMT-0700 (Pacific Daylight Time)">16:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">building it for firefox</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Tue Aug 02 2022 09:55:31 GMT-0700 (Pacific Daylight Time)">16:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">in term of setting up environment, cloning the mozilla-unified repository is supported way. <code>./mach bootstrap</code> expects mercurial or git checkout</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Tue Aug 02 2022 09:56:10 GMT-0700 (Pacific Daylight Time)">16:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">and iiuc, using source tarball is not supported by bootstrap</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Tue Aug 02 2022 10:02:52 GMT-0700 (Pacific Daylight Time)">17:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">what is the difference between SpiderMonkey and V8 regarding V8's isolates? Is SpiderMonkey basically doing and achieving the same thing as V8's isolates?</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Tue Aug 02 2022 10:04:16 GMT-0700 (Pacific Daylight Time)">17:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">it sounds like JSContext corresponds to it?</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Tue Aug 02 2022 10:04:52 GMT-0700 (Pacific Daylight Time)">17:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">V8 has isolates and contexts, you can multithread isolates but you cannot with contexts unless you lock and unlock the isolate</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Tue Aug 02 2022 10:05:12 GMT-0700 (Pacific Daylight Time)">17:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">so if i want 100 parallel JavaScripts running I would need 100 isolates</td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Tue Aug 02 2022 10:05:52 GMT-0700 (Pacific Daylight Time)">17:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">"An isolate is a VM instance with its own heap."</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Tue Aug 02 2022 10:07:58 GMT-0700 (Pacific Daylight Time)">17:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell"><code>JSContext</code> or <code>JSRuntime</code> would correspond to it</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Tue Aug 02 2022 10:08:40 GMT-0700 (Pacific Daylight Time)">17:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">I was thinking of <code>JSRuntime</code></td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Tue Aug 02 2022 10:09:08 GMT-0700 (Pacific Daylight Time)">17:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell"><span class="nick-13">davidj361</span>: do you use spidermonkey?</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Tue Aug 02 2022 10:09:29 GMT-0700 (Pacific Daylight Time)">17:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">I'm using both V8 and SpiderMonkey and comparing the engines</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Tue Aug 02 2022 10:09:40 GMT-0700 (Pacific Daylight Time)">17:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">both in a very rudimentary manner</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Tue Aug 02 2022 10:12:05 GMT-0700 (Pacific Daylight Time)">17:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">i've read the boilerplate code of both and some basic documentation but it's still confusing comparing the 2</td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Tue Aug 02 2022 10:13:21 GMT-0700 (Pacific Daylight Time)">17:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">you can have <code>JSRuntime</code> per each thread, to run JS code concurrently.  iiuc DOM Worker is implemented in this way</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Tue Aug 02 2022 10:14:57 GMT-0700 (Pacific Daylight Time)">17:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">also is it just me or is there not so much a hierarchy of classes in an OOP manner for SpiderMonkey API?</td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Tue Aug 02 2022 10:15:21 GMT-0700 (Pacific Daylight Time)">17:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">Usually it's all within a <code>JS::</code> namespace?</td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Tue Aug 02 2022 10:16:07 GMT-0700 (Pacific Daylight Time)">17:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I'm using both V8 and SpiderMonkey and comparing the engines</blockquote></mx-reply>are you on Windows?</td></tr>
  <tr class="msg" id="L72"><td class="ts-cell"><a class="ts" href="#L72" alt="Tue Aug 02 2022 10:16:15 GMT-0700 (Pacific Daylight Time)">17:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">ubuntu atm</td></tr>
  <tr class="msg" id="L73"><td class="ts-cell"><a class="ts" href="#L73" alt="Tue Aug 02 2022 10:16:34 GMT-0700 (Pacific Daylight Time)">17:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">yeah, most classes are opaque, and operation on them is done by public functions</td></tr>
  <tr class="msg" id="L74"><td class="ts-cell"><a class="ts" href="#L74" alt="Tue Aug 02 2022 10:16:37 GMT-0700 (Pacific Daylight Time)">17:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> ubuntu atm</blockquote></mx-reply>but did you manage to build spidermonkey on Windows?</td></tr>
  <tr class="msg" id="L75"><td class="ts-cell"><a class="ts" href="#L75" alt="Tue Aug 02 2022 10:16:55 GMT-0700 (Pacific Daylight Time)">17:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">no i haven't built it on Windows</td></tr>
  <tr class="msg" id="L76"><td class="ts-cell"><a class="ts" href="#L76" alt="Tue Aug 02 2022 10:16:59 GMT-0700 (Pacific Daylight Time)">17:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@sfink:mozilla.org">sfink</span>&gt;</div></td><td class="msg-cell">JSAPI started out as a C API. It has been gradually going in a more C++ direction, but it's still more a set of functions than OOP.</td></tr>
  <tr class="msg" id="L77"><td class="ts-cell"><a class="ts" href="#L77" alt="Tue Aug 02 2022 10:17:07 GMT-0700 (Pacific Daylight Time)">17:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> no i haven't built it on Windows</blockquote></mx-reply>dang it</td></tr>
  <tr class="msg" id="L78"><td class="ts-cell"><a class="ts" href="#L78" alt="Tue Aug 02 2022 10:17:22 GMT-0700 (Pacific Daylight Time)">17:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">are you trying to build developer libraries or the standalone engine?</td></tr>
  <tr class="msg" id="L79"><td class="ts-cell"><a class="ts" href="#L79" alt="Tue Aug 02 2022 10:18:10 GMT-0700 (Pacific Daylight Time)">17:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">I am trying to embed Spidermonkey in my C++ application on Windows thru Visual Studio <span class="nick-13">davidj361</span></td></tr>
  <tr class="msg" id="L80"><td class="ts-cell"><a class="ts" href="#L80" alt="Tue Aug 02 2022 10:18:42 GMT-0700 (Pacific Daylight Time)">17:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">cant do it, real pain</td></tr>
  <tr class="msg" id="L81"><td class="ts-cell"><a class="ts" href="#L81" alt="Tue Aug 02 2022 10:18:48 GMT-0700 (Pacific Daylight Time)">17:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">I would say follow this <a href="https://github.com/mozilla-spidermonkey/spidermonkey-embedding-examples/blob/esr91/docs/Building%20SpiderMonkey.md">https://github.com/mozilla-spidermonkey/spidermonkey-embedding-examples/blob/esr91/docs/Building%20SpiderMonkey.md</a></td></tr>
  <tr class="msg" id="L82"><td class="ts-cell"><a class="ts" href="#L82" alt="Tue Aug 02 2022 10:19:19 GMT-0700 (Pacific Daylight Time)">17:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">which is linux cli lol</td></tr>
  <tr class="msg" id="L83"><td class="ts-cell"><a class="ts" href="#L83" alt="Tue Aug 02 2022 10:19:34 GMT-0700 (Pacific Daylight Time)">17:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> which is linux cli lol</blockquote></mx-reply>yeah that's the problem</td></tr>
  <tr class="msg" id="L84"><td class="ts-cell"><a class="ts" href="#L84" alt="Tue Aug 02 2022 10:19:35 GMT-0700 (Pacific Daylight Time)">17:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">but i think you can achieve the same via <code>mach</code></td></tr>
  <tr class="msg" id="L85"><td class="ts-cell"><a class="ts" href="#L85" alt="Tue Aug 02 2022 10:19:57 GMT-0700 (Pacific Daylight Time)">17:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">dude you have no idea how much I tried, m literally crying right now</td></tr>
  <tr class="msg" id="L86"><td class="ts-cell"><a class="ts" href="#L86" alt="Tue Aug 02 2022 10:20:14 GMT-0700 (Pacific Daylight Time)">17:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">I never thought I would hate linux in my life as much as I do now</td></tr>
  <tr class="msg" id="L87"><td class="ts-cell"><a class="ts" href="#L87" alt="Tue Aug 02 2022 10:20:25 GMT-0700 (Pacific Daylight Time)">17:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell"><p>Various ways I've tried (all on clean checkout):<br>0. (same for all ways) Exec start-shell.bat from windows cmd</p>
<ol>
<li>Build by mach (based on <a href="https://firefox-source-docs.mozilla.org/setup/windows_build.html">https://firefox-source-docs.mozilla.org/setup/windows_build.html</a>):</li>
</ol>
<ul>
<li><code>export MOZBUILD_STATE_PATH=SOME_PATH</code></li>
<li><code>./mach bootstrap</code>: choose SM, opt out of telemetry and commiting</li>
<li><code>./mach build</code></li>
<li>fails with <code>FileNotFoundError: [WinError 2]</code> (full log will be attached in the next msg)</li>
</ul>
<ol start="2">
<li>Build from js/src (based on <a href="https://github.com/mozilla-spidermonkey/spidermonkey-embedding-examples/blob/esr91/docs/Building%20SpiderMonkey.md">https://github.com/mozilla-spidermonkey/spidermonkey-embedding-examples/blob/esr91/docs/Building%20SpiderMonkey.md</a>):</li>
</ol>
<ul>
<li><code>cd js/src</code></li>
<li><code>cp ./<a href="http://configure.in">configure.in</a> ./configure</code></li>
<li><code>chmod +x ./configure</code></li>
<li><code>mkdir _build</code></li>
<li><code>cd _build</code></li>
<li><code>../configure --enable-nspr-build --disable-jemalloc --disable-js-shell --disable-tests --target=i686-pc-mingw32 --host=i686-pc-mingw32</code></li>
<li>fails during <code>checking for host system type</code> (full log in the next msg)</li>
</ul>
</td></tr>
  <tr class="msg" id="L88"><td class="ts-cell"><a class="ts" href="#L88" alt="Tue Aug 02 2022 10:20:26 GMT-0700 (Pacific Daylight Time)">17:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">no offense</td></tr>
  <tr class="msg" id="L89"><td class="ts-cell"><a class="ts" href="#L89" alt="Tue Aug 02 2022 10:21:00 GMT-0700 (Pacific Daylight Time)">17:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">a forward from another message from a user I didn't want to ping</td></tr>
  <tr class="msg" id="L90"><td class="ts-cell"><a class="ts" href="#L90" alt="Tue Aug 02 2022 10:21:20 GMT-0700 (Pacific Daylight Time)">17:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">will I get the .lib and .h files this way?</td></tr>
  <tr class="msg" id="L91"><td class="ts-cell"><a class="ts" href="#L91" alt="Tue Aug 02 2022 10:21:33 GMT-0700 (Pacific Daylight Time)">17:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">dunno</td></tr>
  <tr class="msg" id="L92"><td class="ts-cell"><a class="ts" href="#L92" alt="Tue Aug 02 2022 10:23:26 GMT-0700 (Pacific Daylight Time)">17:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">lol then what will I get</td></tr>
  <tr class="msg" id="L93"><td class="ts-cell"><a class="ts" href="#L93" alt="Tue Aug 02 2022 10:23:48 GMT-0700 (Pacific Daylight Time)">17:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell">also I am using the gnome package</td></tr>
  <tr class="msg" id="L94"><td class="ts-cell"><a class="ts" href="#L94" alt="Tue Aug 02 2022 10:32:51 GMT-0700 (Pacific Daylight Time)">17:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">i mean it's a start where you could build stuff, but I haven't done it in Windows so I can't confirm you'll get .lib files. You'll definitely get .h files though.</td></tr>
  <tr class="msg" id="L95"><td class="ts-cell"><a class="ts" href="#L95" alt="Tue Aug 02 2022 10:36:36 GMT-0700 (Pacific Daylight Time)">17:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@devscripter:mozilla.org">devscripter</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> i mean it's a start where you could build stuff, but I haven't done it in Windows so I can't confirm you'll get .lib files. You'll definitely get .h files though.</blockquote></mx-reply>did you get .a files in linux tho?</td></tr>
  <tr class="msg" id="L96"><td class="ts-cell"><a class="ts" href="#L96" alt="Tue Aug 02 2022 10:46:13 GMT-0700 (Pacific Daylight Time)">17:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@davidj361:matrix.org">davidj361</span>&gt;</div></td><td class="msg-cell">all the developer libraries, i.e. .a and .so files I think, and the whole shebang</td></tr>
  <tr class="msg" id="L97"><td class="ts-cell"><a class="ts" href="#L97" alt="Tue Aug 02 2022 12:38:19 GMT-0700 (Pacific Daylight Time)">19:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> It's the private value for the importing module</blockquote></mx-reply>nice! this also solves the problem of resolving relative paths for modules! (I was struggling with it just yesterday)</td></tr>
  <tr class="msg" id="L98"><td class="ts-cell"><a class="ts" href="#L98" alt="Tue Aug 02 2022 12:40:05 GMT-0700 (Pacific Daylight Time)">19:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">jonco</span>: could you help me with another module related question, plz? How is embedding supposed to handle top level await? (or should it at all)</td></tr>
  <tr class="msg" id="L99"><td class="ts-cell"><a class="ts" href="#L99" alt="Tue Aug 02 2022 12:45:19 GMT-0700 (Pacific Daylight Time)">19:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@bthrall:mozilla.org">Bryan Thrall [:bthrall]</span>&gt;</div></td><td class="msg-cell">Looking at <a href="https://searchfox.org/mozilla-central/source/js/src/frontend/Parser.cpp#477,490">https://searchfox.org/mozilla-central/source/js/src/frontend/Parser.cpp#477,490</a><br>is there a significant difference between the JSContext from the <code>SharedContext</code> versus the <code>GeneralParser</code>'s member <code>cx_</code> (it gets from <a href="https://searchfox.org/mozilla-central/source/js/src/frontend/Parser.h#246">ParserSharedBase</a>?</td></tr>
  <tr class="msg" id="L100"><td class="ts-cell"><a class="ts" href="#L100" alt="Tue Aug 02 2022 12:48:00 GMT-0700 (Pacific Daylight Time)">19:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><span class="nick-7">Bryan Thrall [:bthrall]</span>: I kind of would hope not? Maybe assert they're equal, run the tests, and see if anything pops. But it seems very likely to me that they're always identitical</td></tr>
  <tr class="msg" id="L101"><td class="ts-cell"><a class="ts" href="#L101" alt="Tue Aug 02 2022 13:36:00 GMT-0700 (Pacific Daylight Time)">20:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-4">jonco</span>: could you help me with another module related question, plz? How is embedding supposed to handle top level await? (or should it at all)</blockquote></mx-reply><span class="nick-13">TheQwertiest</span>: dunno if this helps but here's our commit that enables toplevel await: <a href="https://gitlab.gnome.org/GNOME/gjs/-/commit/f39ceac2c5dee2e59924bda229bc256ff24a0418">https://gitlab.gnome.org/GNOME/gjs/-/commit/f39ceac2c5dee2e59924bda229bc256ff24a0418</a></td></tr>
  <tr class="msg" id="L102"><td class="ts-cell"><a class="ts" href="#L102" alt="Tue Aug 02 2022 13:36:08 GMT-0700 (Pacific Daylight Time)">20:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">not everything in that diff is relevant</td></tr>
  <tr class="msg" id="L103"><td class="ts-cell"><a class="ts" href="#L103" alt="Tue Aug 02 2022 13:38:04 GMT-0700 (Pacific Daylight Time)">20:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">you basically have to deal with the out parameter of JS::ModuleEvaluate which is a Promise, and keep your embedding alive until that Promise resolves</td></tr>
  <tr class="msg" id="L104"><td class="ts-cell"><a class="ts" href="#L104" alt="Tue Aug 02 2022 13:38:51 GMT-0700 (Pacific Daylight Time)">20:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">and switch from JS::FinishDynamicModuleImport_NoTLA to JS::FinishDynamicModuleImport (called with a Promise object instead of a status)</td></tr>
  <tr class="msg" id="L105"><td class="ts-cell"><a class="ts" href="#L105" alt="Tue Aug 02 2022 13:43:17 GMT-0700 (Pacific Daylight Time)">20:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@theqwertiest:mozilla.org">TheQwertiest</span>&gt;</div></td><td class="msg-cell">thanks! I'll take a look</td></tr>

</tbody></table></div></div></div>
</body></html>