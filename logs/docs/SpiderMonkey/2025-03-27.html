<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2025-03-27</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2025-03-27<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2025-03-26" class="nav-link"><span>prev</span></a>
<a href="2025-03-28" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Mar 26 2025 23:37:39 GMT-0700 (Pacific Daylight Time)">06:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sagu:mozilla.org">Samson</span>&gt;</div></td><td class="msg-cell"><p>Hm, I see.<br>Per <a href="https://github.com/mozilla-spidermonkey/spidermonkey-embedding-examples/blob/esr128/docs/GC%20Rooting%20Guide.md">https://github.com/mozilla-spidermonkey/spidermonkey-embedding-examples/blob/esr128/docs/GC%20Rooting%20Guide.md</a>:</p>
<blockquote>
<p>the whole point of a Handle is that it only reference pointers that the GC knows about so it can update them when they move</p>
</blockquote>
<p>As far as I understand this means GC updates ptr in handle, where exactly does this happen?</p>
</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Mar 26 2025 23:47:39 GMT-0700 (Pacific Daylight Time)">06:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">iiuc, here <a href="https://searchfox.org/mozilla-central/rev/a920f0f657f8f2d81ef53c581433942059863dd5/js/src/gc/Marking.cpp#698">TraceTaggedPtrEdge</a></td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Mar 26 2025 23:48:31 GMT-0700 (Pacific Daylight Time)">06:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@arai:mozilla.org">arai</span>&gt;</div></td><td class="msg-cell">and also in similar functions there</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Mar 26 2025 23:51:55 GMT-0700 (Pacific Daylight Time)">06:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell">also the <code>ptr</code> field in <code>Handle</code> isn't updated directly because that points to something stored in a root (such as <code>Rooted&lt;&gt;</code>). So the root gets updated and then all handles see the new value because they point to the root</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Thu Mar 27 2025 02:28:19 GMT-0700 (Pacific Daylight Time)">09:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jonco:mozilla.org">jonco</span>&gt;</div></td><td class="msg-cell">It's pretty hard to see where the updates happen in the code. The TraceTaggedPtrEdge is for Values and other tagged pointers. For JSObject* and other direct pointers it happens in a method on the tracer. For example for compacting that happens <a href="https://searchfox.org/mozilla-central/source/js/src/gc/Compacting.cpp#465-471">here</a>.</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Thu Mar 27 2025 05:55:16 GMT-0700 (Pacific Daylight Time)">12:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@padenot:mozilla.org">padenot</span>&gt;</div></td><td class="msg-cell">if I'm in the debugger, and I have, say, a <code>JSObject*</code>, is there a quick way to know what it is? e.g. a ToString() or the like ?</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Thu Mar 27 2025 05:59:16 GMT-0700 (Pacific Daylight Time)">12:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@jandem:mozilla.org">jandem</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">padenot</span>: <code>call obj-&gt;dump()</code>? is it a debug build?</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Thu Mar 27 2025 05:59:40 GMT-0700 (Pacific Daylight Time)">12:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@padenot:mozilla.org">padenot</span>&gt;</div></td><td class="msg-cell">it's probably what I'm looking for yeah</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Thu Mar 27 2025 05:59:45 GMT-0700 (Pacific Daylight Time)">12:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@padenot:mozilla.org">padenot</span>&gt;</div></td><td class="msg-cell">it's my build yes</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Thu Mar 27 2025 05:59:56 GMT-0700 (Pacific Daylight Time)">12:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@padenot:mozilla.org">padenot</span>&gt;</div></td><td class="msg-cell">hybrid debug + opt and some folders non-opt</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Thu Mar 27 2025 06:00:54 GMT-0700 (Pacific Daylight Time)">13:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@padenot:mozilla.org">padenot</span>&gt;</div></td><td class="msg-cell">yeah it's exactly what I needed, thanks!</td></tr>

</tbody></table></div></div></div>
</body></html>