<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>SpiderMonkey on 2021-07-16</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "SpiderMonkey";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">SpiderMonkey<br>2021-07-16<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2021-07-15" class="nav-link"><span>prev</span></a>
<a href="2021-07-18" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Fri Jul 16 2021 11:10:17 GMT-0700 (Pacific Daylight Time)">18:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@fitzgen:mozilla.org">fitzgen</span>&gt;</div></td><td class="msg-cell">hello y'all :)</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Fri Jul 16 2021 11:14:15 GMT-0700 (Pacific Daylight Time)">18:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@fitzgen:mozilla.org">fitzgen</span>&gt;</div></td><td class="msg-cell">I'm wondering: is there a way to create a <code>ModuleObject</code> from a collection of (native) functions via JSAPI? I'm not seeing anything in <code>js/public/Modules.h</code> or anywhere else, but maybe I'm missing something. Alternatively, what would be the best way to do accomplish this? create a new global with all the functions I want exported attached and synthesize some JS source code with <code>export foo = <a href="http://self.foo">self.foo</a>;</code> for each function I want to export?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Fri Jul 16 2021 12:59:55 GMT-0700 (Pacific Daylight Time)">19:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@evilpie:mozilla.org">evilpie</span>&gt;</div></td><td class="msg-cell">our structured cloning code is super complicated when serializing nested object :(</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Fri Jul 16 2021 13:01:15 GMT-0700 (Pacific Daylight Time)">20:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I'm wondering: is there a way to create a <code>ModuleObject</code> from a collection of (native) functions via JSAPI? I'm not seeing anything in <code>js/public/Modules.h</code> or anywhere else, but maybe I'm missing something. Alternatively, what would be the best way to do accomplish this? create a new global with all the functions I want exported attached and synthesize some JS source code with <code>export foo = <a href="http://self.foo">self.foo</a>;</code> for each function I want to export?</blockquote></mx-reply>I seem to recall this has come up before, and the answer at the time was no, we didn't have any JSAPI level code to do this. Having said that, you may get a better answer Monday</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Fri Jul 16 2021 13:03:17 GMT-0700 (Pacific Daylight Time)">20:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell"><blockquote>
<p>We don't have generic support for non-scripted modules right now (as far as I know..). The <code>ModuleObject</code> is always associated with a JSScript/BaseScript and different asserts trip. I think people have tried hacks by having a wrapper .mjs file that has the export list and in the body calls some helper method that populates those bindings. I don't recall if that plan worked though..</p>
</blockquote>
<p><span class="nick-13">fitzgen</span> this was Ted from last time we looked at this -^</p>
</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Fri Jul 16 2021 14:27:09 GMT-0700 (Pacific Daylight Time)">21:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mgaudet:mozilla.org">mgaudet</span>&gt;</div></td><td class="msg-cell">confession: Trying to figure out how to coordinate all the algorithms for the streams spec into doing something... this is hard work :) </td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Fri Jul 16 2021 14:27:11 GMT-0700 (Pacific Daylight Time)">21:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@botzilla:mozilla.org">botzilla</span>&gt;</div></td><td class="msg-cell">Seen! Your update will eventually appear on <a href="https://robotzilla.github.io/histoire">https://robotzilla.github.io/histoire</a></td></tr>

</tbody></table></div></div></div>
</body></html>